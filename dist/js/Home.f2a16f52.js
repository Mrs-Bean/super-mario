"use strict";(self["webpackChunksuper_mario"]=self["webpackChunksuper_mario"]||[]).push([[274],{785:function(t,e,i){i.r(e),i.d(e,{default:function(){return Gg}});var s=i(111),r=i(586),n=i(471);function o(t){const e=[];return t.forEach((t=>{e.push(new Promise(((e,i)=>{const s=new Image;s.onload=()=>e(s),s.onerror=t=>i(t),s.src=t})))})),Promise.all(e)}function a(){return o(["imgs/mario/base/static/static.jpg","imgs/mario/base/jump/jump-left.jpg","imgs/mario/base/jump/jump-right.jpg","imgs/mario/base/left/frame-1.jpg","imgs/mario/base/left/frame-2.jpg","imgs/mario/base/left/frame-3.jpg","imgs/mario/base/right/frame-1.jpg","imgs/mario/base/right/frame-2.jpg","imgs/mario/base/right/frame-3.jpg","imgs/mario/base/die/frame-1.jpg"])}function h(){return o(["imgs/mario/big/static/static.jpg","imgs/mario/big/jump/jump-left.jpg","imgs/mario/big/jump/jump-right.jpg","imgs/mario/big/left/frame-1.jpg","imgs/mario/big/left/frame-2.jpg","imgs/mario/big/left/frame-3.jpg","imgs/mario/big/right/frame-1.jpg","imgs/mario/big/right/frame-2.jpg","imgs/mario/big/right/frame-3.jpg"])}function l(){return o(["imgs/mario/bullet/static/static.jpg","imgs/mario/bullet/jump/jump-left.jpg","imgs/mario/bullet/jump/jump-right.jpg","imgs/mario/bullet/left/frame-1.jpg","imgs/mario/bullet/left/frame-2.jpg","imgs/mario/bullet/left/frame-3.jpg","imgs/mario/bullet/right/frame-1.jpg","imgs/mario/bullet/right/frame-2.jpg","imgs/mario/bullet/right/frame-3.jpg","imgs/mario/bullet/attack/left.jpg","imgs/mario/bullet/attack/right.jpg"])}function d(){return o(["imgs/scene/scene.jpg"])}function c(){return o(["imgs/building/land/land.jpg"])}function u(){return o(["imgs/building/rock/rock.jpg"])}function p(){return o(["imgs/building/stone/stone.jpg"])}function _(){return o(["imgs/building/stone/stone-born.jpg"])}function y(){return o(["imgs/building/ask/frame-1.jpg","imgs/building/ask/frame-2.jpg","imgs/building/ask/frame-3.jpg","imgs/building/ask/frame-4.jpg","imgs/building/ask/frame-5.jpg","imgs/building/ask/frame-6.jpg","imgs/building/ask/empty.jpg"])}function g(){return o(["imgs/building/win/flag.jpg","imgs/building/win/round.jpg","imgs/building/win/rod.jpg"])}function f(){return o(["imgs/props/flow/frame-1.jpg","imgs/props/flow/frame-2.jpg","imgs/props/flow/frame-3.jpg","imgs/props/flow/frame-4.jpg"])}function m(){return o(["imgs/props/gold/frame-1.jpg","imgs/props/gold/frame-2.jpg","imgs/props/gold/frame-3.jpg","imgs/props/gold/frame-4.jpg","imgs/props/gold/frame-5.jpg","imgs/props/gold/frame-6.jpg"])}function x(){return o(["imgs/props/grow-mushroom/frame-1.jpg"])}function v(){return o(["imgs/bad/mushroom/frame-1.jpg","imgs/bad/mushroom/frame-2.jpg","imgs/bad/mushroom/die-frame-1.jpg","imgs/bad/mushroom/die-frame-2.jpg","imgs/bad/mushroom/die.jpg"])}function w(){return o(["imgs/bullet/frame-1.jpg","imgs/bullet/frame-2.jpg","imgs/bullet/frame-3.jpg","imgs/bullet/frame-4.jpg"])}let b,k,C,B,R,S,E,T,P,L,O,M,D,A,I;async function W(){[b,k,C,B,R,S,E,T,P,L,O,M,D,A,I]=await Promise.all([d(),a(),h(),l(),w(),c(),u(),p(),_(),y(),f(),m(),x(),v(),g()])}const j={toURL(t,e){let i=encodeURIComponent(t);return"text"===e?i="data:text/plain;charset=utf-8,"+i:"svg"===e&&(i="data:image/svg+xml,"+i),i},image:{hitCanvasSize:100,maxCacheSize:4096e3,maxPatternSize:8847360,crossOrigin:"anonymous",getRealURL(t){const{prefix:e,suffix:i}=j.image;return!i||t.startsWith("data:")||t.startsWith("blob:")||(t+=(t.includes("?")?"&":"?")+i),e&&"/"===t[0]&&(t=e+t),t}}},F={},Y={RUNTIME:"runtime",LEAF:"leaf",TASK:"task",CNAVAS:"canvas",IMAGE:"image",types:{},create(t){const{types:e}=N;return e[t]?e[t]++:(e[t]=1,0)}},N=Y,{round:z,pow:X,PI:H}=Math,V={within(t,e,i){return void 0!==e&&t<e&&(t=e),void 0!==i&&t>i&&(t=i),t},fourNumber(t,e){let i;if(t instanceof Array)switch(t.length){case 4:i=void 0===e?t:[...t];break;case 2:i=[t[0],t[1],t[0],t[1]];break;case 3:i=[t[0],t[1],t[2],t[1]];break;case 1:t=t[0];break;default:t=0}if(i||(i=[t,t,t,t]),e)for(let s=0;s<4;s++)i[s]>e&&(i[s]=e);return i},formatRotation(t,e){return t%=360,e?t<0&&(t+=360):(t>180&&(t-=360),t<-180&&(t+=360)),V.float(t)},getGapRotation(t,e,i=0){let s=t+i;if(e>1){const t=Math.abs(s%e);(t<1||t>e-1)&&(s=Math.round(s/e)*e)}return s-i},float(t,e){const i=e?X(10,e):1e12;return t=z(t*i)/i,-0===t?0:t}},U=H/180,G=2*H,K=H/2;function $(){return{x:0,y:0}}function q(){return{x:0,y:0,width:0,height:0}}function Q(){return{a:1,b:0,c:0,d:1,e:0,f:0}}const{sin:Z,cos:J,acos:tt,sqrt:et}=Math,{float:it}=V,st={};function rt(){return Object.assign(Object.assign(Object.assign({},Q()),q()),{scaleX:1,scaleY:1,rotation:0,skewX:0,skewY:0})}const nt={defaultMatrix:Q(),defaultWorld:rt(),tempMatrix:{},set(t,e=1,i=0,s=0,r=1,n=0,o=0){t.a=e,t.b=i,t.c=s,t.d=r,t.e=n,t.f=o},get:Q,getWorld:rt,copy(t,e){t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t.e=e.e,t.f=e.f},translate(t,e,i){t.e+=e,t.f+=i},translateInner(t,e,i,s){t.e+=t.a*e+t.c*i,t.f+=t.b*e+t.d*i,s&&(t.e-=e,t.f-=i)},scale(t,e,i=e){t.a*=e,t.b*=e,t.c*=i,t.d*=i},scaleOfOuter(t,e,i,s){ot.toInnerPoint(t,e,st),ot.scaleOfInner(t,st,i,s)},scaleOfInner(t,e,i,s=i){ot.translateInner(t,e.x,e.y),ot.scale(t,i,s),ot.translateInner(t,-e.x,-e.y)},rotate(t,e){const{a:i,b:s,c:r,d:n}=t;e*=U;const o=J(e),a=Z(e);t.a=i*o-s*a,t.b=i*a+s*o,t.c=r*o-n*a,t.d=r*a+n*o},rotateOfOuter(t,e,i){ot.toInnerPoint(t,e,st),ot.rotateOfInner(t,st,i)},rotateOfInner(t,e,i){ot.translateInner(t,e.x,e.y),ot.rotate(t,i),ot.translateInner(t,-e.x,-e.y)},skew(t,e,i){const{a:s,b:r,c:n,d:o}=t;i&&(i*=U,t.a=s+n*i,t.b=r+o*i),e&&(e*=U,t.c=n+s*e,t.d=o+r*e)},skewOfOuter(t,e,i,s){ot.toInnerPoint(t,e,st),ot.skewOfInner(t,st,i,s)},skewOfInner(t,e,i,s=0){ot.translateInner(t,e.x,e.y),ot.skew(t,i,s),ot.translateInner(t,-e.x,-e.y)},multiply(t,e){const{a:i,b:s,c:r,d:n,e:o,f:a}=t;t.a=e.a*i+e.b*r,t.b=e.a*s+e.b*n,t.c=e.c*i+e.d*r,t.d=e.c*s+e.d*n,t.e=e.e*i+e.f*r+o,t.f=e.e*s+e.f*n+a},multiplyParent(t,e,i,s,r,n){let{e:o,f:a}=t;if(n&&(o+=n.scrollX,a+=n.scrollY),i||(i=t),void 0===s&&(s=1!==t.a||t.b||t.c||1!==t.d),s){const{a:s,b:n,c:o,d:a}=t;i.a=s*e.a+n*e.c,i.b=s*e.b+n*e.d,i.c=o*e.a+a*e.c,i.d=o*e.b+a*e.d,r&&(i.scaleX=e.scaleX*r.scaleX,i.scaleY=e.scaleY*r.scaleY)}else i.a=e.a,i.b=e.b,i.c=e.c,i.d=e.d,r&&(i.scaleX=e.scaleX,i.scaleY=e.scaleY);i.e=o*e.a+a*e.c+e.e,i.f=o*e.b+a*e.d+e.f},divide(t,e){ot.multiply(t,ot.tempInvert(e))},divideParent(t,e){ot.multiplyParent(t,ot.tempInvert(e))},tempInvert(t){const{tempMatrix:e}=ot;return ot.copy(e,t),ot.invert(e),e},invert(t){const{a:e,b:i,c:s,d:r,e:n,f:o}=t;if(i||s){const a=1/(e*r-i*s);t.a=r*a,t.b=-i*a,t.c=-s*a,t.d=e*a,t.e=-(n*r-o*s)*a,t.f=-(o*e-n*i)*a}else if(1===e&&1===r)t.e=-n,t.f=-o;else{const i=1/(e*r);t.a=r*i,t.d=e*i,t.e=-n*r*i,t.f=-o*e*i}},toOuterPoint(t,e,i,s){const{x:r,y:n}=e;i||(i=e),i.x=r*t.a+n*t.c,i.y=r*t.b+n*t.d,s||(i.x+=t.e,i.y+=t.f)},toInnerPoint(t,e,i,s){const{a:r,b:n,c:o,d:a}=t,h=1/(r*a-n*o),{x:l,y:d}=e;if(i||(i=e),i.x=(l*a-d*o)*h,i.y=(d*r-l*n)*h,!s){const{e:e,f:s}=t;i.x-=(e*a-s*o)*h,i.y-=(s*r-e*n)*h}},setLayout(t,e,i,s){const{x:r,y:n,scaleX:o,scaleY:a}=e;if(void 0===s&&(s=e.rotation||e.skewX||e.skewY),s){const{rotation:i,skewX:s,skewY:r}=e,n=i*U,h=J(n),l=Z(n);if(s||r){const e=s*U,i=r*U;t.a=(h+i*-l)*o,t.b=(l+i*h)*o,t.c=(e*h-l)*a,t.d=(h+e*l)*a}else t.a=h*o,t.b=l*o,t.c=-l*a,t.d=h*a}else t.a=o,t.b=0,t.c=0,t.d=a;t.e=r,t.f=n,i&&ot.translateInner(t,-i.x,-i.y,!0)},getLayout(t,e,i){const{a:s,b:r,c:n,d:o,e:a,f:h}=t;let l,d,c,u,p,_=a,y=h;if(r||n){const t=s*o-r*n;if(n&&!i){l=et(s*s+r*r),d=t/l;const e=s/l;c=r>0?tt(e):-tt(e)}else{d=et(n*n+o*o),l=t/d;const e=n/d;c=K-(o>0?tt(-e):-tt(e))}const e=it(J(c)),a=Z(c);l=it(l),d=it(d),u=e?it((n/d+a)/e/U,9):0,p=e?it((r/l-a)/e/U,9):0,c=it(c/U)}else l=s,d=o,c=u=p=0;return e&&(_+=e.x*s+e.y*n,y+=e.x*r+e.y*o),{x:_,y:y,scaleX:l,scaleY:d,rotation:c,skewX:u,skewY:p}},withScale(t,e,i=e){const s=t;if(!e||!i){const{a:s,b:r,c:n,d:o}=t;r||n?(e=et(s*s+r*r),i=(s*o-r*n)/e):(e=s,i=o)}return s.scaleX=e,s.scaleY=i,s},reset(t){ot.set(t)}},ot=nt,{toInnerPoint:at,toOuterPoint:ht}=nt,{sin:lt,cos:dt,abs:ct,sqrt:ut,atan2:pt,min:_t,PI:yt}=Math,gt={defaultPoint:$(),tempPoint:{},tempRadiusPoint:{},set(t,e=0,i=0){t.x=e,t.y=i},setRadius(t,e,i){t.radiusX=e,t.radiusY=void 0===i?e:i},copy(t,e){t.x=e.x,t.y=e.y},copyFrom(t,e,i){t.x=e,t.y=i},move(t,e,i){t.x+=e,t.y+=i},scale(t,e,i=e){t.x&&(t.x*=e),t.y&&(t.y*=i)},scaleOf(t,e,i,s=i){t.x+=(t.x-e.x)*(i-1),t.y+=(t.y-e.y)*(s-1)},rotate(t,e,i){i||(i=ft.defaultPoint),e*=U;const s=dt(e),r=lt(e),n=t.x-i.x,o=t.y-i.y;t.x=i.x+n*s-o*r,t.y=i.y+n*r+o*s},tempToInnerOf(t,e){const{tempPoint:i}=ft;return xt(i,t),at(e,i,i),i},tempToOuterOf(t,e){const{tempPoint:i}=ft;return xt(i,t),ht(e,i,i),i},tempToInnerRadiusPointOf(t,e){const{tempRadiusPoint:i}=ft;return xt(i,t),ft.toInnerRadiusPointOf(t,e,i),i},toInnerRadiusPointOf(t,e,i){i||(i=t),at(e,t,i),i.radiusX=Math.abs(t.radiusX/e.scaleX),i.radiusY=Math.abs(t.radiusY/e.scaleY)},toInnerOf(t,e,i){at(e,t,i)},toOuterOf(t,e,i){ht(e,t,i)},getCenter(t,e){return{x:t.x+(e.x-t.x)/2,y:t.y+(e.y-t.y)/2}},getCenterX(t,e){return t+(e-t)/2},getCenterY(t,e){return t+(e-t)/2},getDistance(t,e){return mt(t.x,t.y,e.x,e.y)},getDistanceFrom(t,e,i,s){const r=ct(i-t),n=ct(s-e);return ut(r*r+n*n)},getMinDistanceFrom(t,e,i,s,r,n){return _t(mt(t,e,i,s),mt(i,s,r,n))},getAngle(t,e){return vt(t,e)/U},getRotation(t,e,i,s){return s||(s=e),ft.getRadianFrom(t.x,t.y,e.x,e.y,i.x,i.y,s.x,s.y)/U},getRadianFrom(t,e,i,s,r,n,o,a){void 0===o&&(o=i,a=s);let h=pt(e-s,t-i),l=pt(n-a,r-o);const d=l-h;return d<-yt?d+G:d},getAtan2(t,e){return pt(e.y-t.y,e.x-t.x)},getDistancePoint(t,e,i,s){const r=vt(t,e);return e=s?e:{},e.x=t.x+dt(r)*i,e.y=t.y+lt(r)*i,e},reset(t){ft.reset(t)}},ft=gt,{getDistanceFrom:mt,copy:xt,getAtan2:vt}=ft;class wt{constructor(t,e){this.set(t,e)}set(t,e){return"object"===typeof t?gt.copy(this,t):gt.set(this,t,e),this}get(){const{x:t,y:e}=this;return{x:t,y:e}}clone(){return new wt(this)}move(t,e){return gt.move(this,t,e),this}scale(t,e){return gt.scale(this,t,e),this}scaleOf(t,e,i){return gt.scaleOf(this,t,e,i),this}rotate(t,e){return gt.rotate(this,t,e),this}rotateOf(t,e){return gt.rotate(this,e,t),this}getRotation(t,e,i){return gt.getRotation(this,t,e,i)}toInnerOf(t,e){return gt.toInnerOf(this,t,e),this}toOuterOf(t,e){return gt.toOuterOf(this,t,e),this}getCenter(t){return new wt(gt.getCenter(this,t))}getDistance(t){return gt.getDistance(this,t)}getDistancePoint(t,e,i){return new wt(gt.getDistancePoint(this,t,e,i))}getAngle(t){return gt.getAngle(this,t)}getAtan2(t){return gt.getAtan2(this,t)}reset(){return gt.reset(this),this}}new wt;class bt{constructor(t,e,i,s,r,n){this.set(t,e,i,s,r,n)}set(t,e,i,s,r,n){return"object"===typeof t?nt.copy(this,t):nt.set(this,t,e,i,s,r,n),this}setWith(t){return nt.copy(this,t),this.scaleX=t.scaleX,this.scaleY=t.scaleY,this}get(){const{a:t,b:e,c:i,d:s,e:r,f:n}=this;return{a:t,b:e,c:i,d:s,e:r,f:n}}clone(){return new bt(this)}translate(t,e){return nt.translate(this,t,e),this}translateInner(t,e){return nt.translateInner(this,t,e),this}scale(t,e){return nt.scale(this,t,e),this}scaleWith(t,e){return nt.scale(this,t,e),this.scaleX*=t,this.scaleY*=e||t,this}scaleOfOuter(t,e,i){return nt.scaleOfOuter(this,t,e,i),this}scaleOfInner(t,e,i){return nt.scaleOfInner(this,t,e,i),this}rotate(t){return nt.rotate(this,t),this}rotateOfOuter(t,e){return nt.rotateOfOuter(this,t,e),this}rotateOfInner(t,e){return nt.rotateOfInner(this,t,e),this}skew(t,e){return nt.skew(this,t,e),this}skewOfOuter(t,e,i){return nt.skewOfOuter(this,t,e,i),this}skewOfInner(t,e,i){return nt.skewOfInner(this,t,e,i),this}multiply(t){return nt.multiply(this,t),this}multiplyParent(t){return nt.multiplyParent(this,t),this}divide(t){return nt.divide(this,t),this}divideParent(t){return nt.divideParent(this,t),this}invert(){return nt.invert(this),this}invertWith(){return nt.invert(this),this.scaleX=1/this.scaleX,this.scaleY=1/this.scaleY,this}toOuterPoint(t,e,i){nt.toOuterPoint(this,t,e,i)}toInnerPoint(t,e,i){nt.toInnerPoint(this,t,e,i)}setLayout(t,e){return nt.setLayout(this,t,e),this}getLayout(t,e){return nt.getLayout(this,t,e)}withScale(t,e){return nt.withScale(this,t,e)}reset(){nt.reset(this)}}new bt;const kt={tempPointBounds:{},setPoint(t,e,i){t.minX=t.maxX=e,t.minY=t.maxY=i},addPoint(t,e,i){t.minX=e<t.minX?e:t.minX,t.minY=i<t.minY?i:t.minY,t.maxX=e>t.maxX?e:t.maxX,t.maxY=i>t.maxY?i:t.maxY},addBounds(t,e,i,s,r){Ct(t,e,i),Ct(t,e+s,i+r)},copy(t,e){t.minX=e.minX,t.minY=e.minY,t.maxX=e.maxX,t.maxY=e.maxY},addPointBounds(t,e){t.minX=e.minX<t.minX?e.minX:t.minX,t.minY=e.minY<t.minY?e.minY:t.minY,t.maxX=e.maxX>t.maxX?e.maxX:t.maxX,t.maxY=e.maxY>t.maxY?e.maxY:t.maxY},toBounds(t,e){e.x=t.minX,e.y=t.minY,e.width=t.maxX-t.minX,e.height=t.maxY-t.minY}},{addPoint:Ct}=kt,{tempPointBounds:Bt,setPoint:Rt,addPoint:St,toBounds:Et}=kt,{toOuterPoint:Tt}=nt,{float:Pt,fourNumber:Lt}=V,{floor:Ot,ceil:Mt}=Math;let Dt,At,It,Wt;const jt={},Ft={},Yt={tempBounds:{},set(t,e=0,i=0,s=0,r=0){t.x=e,t.y=i,t.width=s,t.height=r},copy(t,e){t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height},copyAndSpread(t,e,i,s){if(i instanceof Array){const r=Lt(i);s?Nt.set(t,e.x+r[3],e.y+r[0],e.width-r[1]-r[3],e.height-r[2]-r[0]):Nt.set(t,e.x-r[3],e.y-r[0],e.width+r[1]+r[3],e.height+r[2]+r[0])}else s&&(i=-i),Nt.set(t,e.x-i,e.y-i,e.width+2*i,e.height+2*i)},minX(t){return t.width>0?t.x:t.x+t.width},minY(t){return t.height>0?t.y:t.y+t.height},maxX(t){return t.width>0?t.x+t.width:t.x},maxY(t){return t.height>0?t.y+t.height:t.y},move(t,e,i){t.x+=e,t.y+=i},getByMove(t,e,i){return t=Object.assign({},t),Nt.move(t,e,i),t},toOffsetOutBounds(t,e,i){e?Xt(e,t):e=t,i?(e.offsetX=-(Nt.maxX(i)-t.x),e.offsetY=-(Nt.maxY(i)-t.y)):(e.offsetX=t.x+t.width,e.offsetY=t.y+t.height),Nt.move(e,-e.offsetX,-e.offsetY)},scale(t,e,i=e){gt.scale(t,e,i),t.width*=e,t.height*=i},scaleOf(t,e,i,s=i){gt.scaleOf(t,e,i,s),t.width*=i,t.height*=s},tempToOuterOf(t,e){return Nt.copy(Nt.tempBounds,t),Nt.toOuterOf(Nt.tempBounds,e),Nt.tempBounds},getOuterOf(t,e){return t=Object.assign({},t),Nt.toOuterOf(t,e),t},toOuterOf(t,e,i){if(i||(i=t),0===e.b&&0===e.c){const{a:s,d:r}=e;s>0?(i.width=t.width*s,i.x=e.e+t.x*s):(i.width=t.width*-s,i.x=e.e+t.x*s-i.width),r>0?(i.height=t.height*r,i.y=e.f+t.y*r):(i.height=t.height*-r,i.y=e.f+t.y*r-i.height)}else jt.x=t.x,jt.y=t.y,Tt(e,jt,Ft),Rt(Bt,Ft.x,Ft.y),jt.x=t.x+t.width,Tt(e,jt,Ft),St(Bt,Ft.x,Ft.y),jt.y=t.y+t.height,Tt(e,jt,Ft),St(Bt,Ft.x,Ft.y),jt.x=t.x,Tt(e,jt,Ft),St(Bt,Ft.x,Ft.y),Et(Bt,i)},toInnerOf(t,e,i){i||(i=t),Nt.move(i,-e.e,-e.f),Nt.scale(i,1/e.a,1/e.d)},getFitMatrix(t,e,i=1){const s=Math.min(i,Math.min(t.width/e.width,t.height/e.height));return new bt(s,0,0,s,-e.x*s,-e.y*s)},getSpread(t,e){const i={};return Nt.copyAndSpread(i,t,e),i},spread(t,e){Nt.copyAndSpread(t,t,e)},shrink(t,e){Nt.copyAndSpread(t,t,e,!0)},ceil(t){const{x:e,y:i}=t;t.x=Ot(t.x),t.y=Ot(t.y),t.width=e>t.x?Mt(t.width+e-t.x):Mt(t.width),t.height=i>t.y?Mt(t.height+i-t.y):Mt(t.height)},unsign(t){t.width<0&&(t.x+=t.width,t.width=-t.width),t.height<0&&(t.y+=t.height,t.height=-t.height)},float(t,e){t.x=Pt(t.x,e),t.y=Pt(t.y,e),t.width=Pt(t.width,e),t.height=Pt(t.height,e)},add(t,e,i){Dt=t.x+t.width,At=t.y+t.height,It=e.x,Wt=e.y,i||(It+=e.width,Wt+=e.height),Dt=Dt>It?Dt:It,At=At>Wt?At:Wt,t.x=t.x<e.x?t.x:e.x,t.y=t.y<e.y?t.y:e.y,t.width=Dt-t.x,t.height=At-t.y},addList(t,e){Nt.setListWithFn(t,e,void 0,!0)},setList(t,e,i=!1){Nt.setListWithFn(t,e,void 0,i)},addListWithFn(t,e,i){Nt.setListWithFn(t,e,i,!0)},setListWithFn(t,e,i,s=!1){let r,n=!0;for(let o=0,a=e.length;o<a;o++)r=i?i(e[o]):e[o],r&&(r.width||r.height)&&(n?(n=!1,s||Xt(t,r)):zt(t,r));n&&Nt.reset(t)},setPoints(t,e){e.forEach(((t,e)=>0===e?Rt(Bt,t.x,t.y):St(Bt,t.x,t.y))),Et(Bt,t)},setPoint(t,e){Nt.set(t,e.x,e.y)},addPoint(t,e){zt(t,e,!0)},getPoints(t){const{x:e,y:i,width:s,height:r}=t;return[{x:e,y:i},{x:e+s,y:i},{x:e+s,y:i+r},{x:e,y:i+r}]},hitRadiusPoint(t,e,i){return i&&(e=gt.tempToInnerRadiusPointOf(e,i)),e.x>=t.x-e.radiusX&&e.x<=t.x+t.width+e.radiusX&&e.y>=t.y-e.radiusY&&e.y<=t.y+t.height+e.radiusY},hitPoint(t,e,i){return i&&(e=gt.tempToInnerOf(e,i)),e.x>=t.x&&e.x<=t.x+t.width&&e.y>=t.y&&e.y<=t.y+t.height},hit(t,e,i){return i&&(e=Nt.tempToOuterOf(e,i)),!(t.y+t.height<e.y||e.y+e.height<t.y||t.x+t.width<e.x||e.x+e.width<t.x)},includes(t,e,i){return i&&(e=Nt.tempToOuterOf(e,i)),t.x<=e.x&&t.y<=e.y&&t.x+t.width>=e.x+e.width&&t.y+t.height>=e.y+e.height},getIntersectData(t,e,i){if(i&&(e=Nt.tempToOuterOf(e,i)),!Nt.hit(t,e))return q();let{x:s,y:r,width:n,height:o}=e;return Dt=s+n,At=r+o,It=t.x+t.width,Wt=t.y+t.height,s=s>t.x?s:t.x,r=r>t.y?r:t.y,Dt=Dt<It?Dt:It,At=At<Wt?At:Wt,n=Dt-s,o=At-r,{x:s,y:r,width:n,height:o}},intersect(t,e,i){Nt.copy(t,Nt.getIntersectData(t,e,i))},isSame(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height},isEmpty(t){return 0===t.x&&0===t.y&&0===t.width&&0===t.height},reset(t){Nt.set(t)}},Nt=Yt,{add:zt,copy:Xt}=Nt;class Ht{get minX(){return Yt.minX(this)}get minY(){return Yt.minY(this)}get maxX(){return Yt.maxX(this)}get maxY(){return Yt.maxY(this)}constructor(t,e,i,s){this.set(t,e,i,s)}set(t,e,i,s){return"object"===typeof t?Yt.copy(this,t):Yt.set(this,t,e,i,s),this}get(){const{x:t,y:e,width:i,height:s}=this;return{x:t,y:e,width:i,height:s}}clone(){return new Ht(this)}move(t,e){return Yt.move(this,t,e),this}scale(t,e){return Yt.scale(this,t,e),this}scaleOf(t,e,i){return Yt.scaleOf(this,t,e,i),this}toOuterOf(t,e){return Yt.toOuterOf(this,t,e),this}toInnerOf(t,e){return Yt.toInnerOf(this,t,e),this}getFitMatrix(t,e){return Yt.getFitMatrix(this,t,e)}spread(t){return Yt.spread(this,t),this}shrink(t){return Yt.shrink(this,t),this}ceil(){return Yt.ceil(this),this}unsign(){return Yt.unsign(this),this}float(t){return Yt.float(this,t),this}add(t){return Yt.add(this,t),this}addList(t){return Yt.setList(this,t,!0),this}setList(t){return Yt.setList(this,t),this}addListWithFn(t,e){return Yt.setListWithFn(this,t,e,!0),this}setListWithFn(t,e){return Yt.setListWithFn(this,t,e),this}setPoint(t){return Yt.setPoint(this,t),this}setPoints(t){return Yt.setPoints(this,t),this}addPoint(t){return Yt.addPoint(this,t),this}getPoints(){return Yt.getPoints(this)}hitPoint(t,e){return Yt.hitPoint(this,t,e)}hitRadiusPoint(t,e){return Yt.hitRadiusPoint(this,t,e)}hit(t,e){return Yt.hit(this,t,e)}includes(t,e){return Yt.includes(this,t,e)}intersect(t,e){return Yt.intersect(this,t,e),this}getIntersect(t,e){return new Ht(Yt.getIntersectData(this,t,e))}isSame(t){return Yt.isSame(this,t)}isEmpty(){return Yt.isEmpty(this)}reset(){Yt.reset(this)}}const Vt=new Ht;class Ut{constructor(t,e,i,s,r,n){"object"===typeof t?this.copy(t):this.set(t,e,i,s,r,n)}set(t=0,e=0,i=0,s=0,r=0,n=0){this.top=t,this.right=e,this.bottom=i,this.left=s,this.width=r,this.height=n}copy(t){const{top:e,right:i,bottom:s,left:r,width:n,height:o}=t;this.set(e,i,s,r,n,o)}getBoundsFrom(t){const{top:e,right:i,bottom:s,left:r,width:n,height:o}=this;return new Ht(r,e,n||t.width-r-i,o||t.height-e-s)}}var Gt,Kt;(function(t){t[t["top"]=0]="top",t[t["right"]=1]="right",t[t["bottom"]=2]="bottom",t[t["left"]=3]="left"})(Gt||(Gt={})),function(t){t[t["topLeft"]=0]="topLeft",t[t["top"]=1]="top",t[t["topRight"]=2]="topRight",t[t["right"]=3]="right",t[t["bottomRight"]=4]="bottomRight",t[t["bottom"]=5]="bottom",t[t["bottomLeft"]=6]="bottomLeft",t[t["left"]=7]="left",t[t["center"]=8]="center",t[t["top-left"]=0]="top-left",t[t["top-right"]=2]="top-right",t[t["bottom-right"]=4]="bottom-right",t[t["bottom-left"]=6]="bottom-left"}(Kt||(Kt={}));const $t=[{x:0,y:0},{x:.5,y:0},{x:1,y:0},{x:1,y:.5},{x:1,y:1},{x:.5,y:1},{x:0,y:1},{x:0,y:.5},{x:.5,y:.5}];$t.forEach((t=>t.type="percent"));const qt={directionData:$t,tempPoint:{},get:Qt,toPoint(t,e,i,s,r){i||(i={});const n=Qt(t);i.x=n.x,i.y=n.y,"percent"===n.type&&(i.x*=e.width,i.y*=e.height,r&&(i.x-=r.x,i.y-=r.y,n.x&&(i.x-=1===n.x?r.width:.5===n.x?n.x*r.width:0),n.y&&(i.y-=1===n.y?r.height:.5===n.y?n.y*r.height:0))),s||(i.x+=e.x,i.y+=e.y)}};function Qt(t){return"string"===typeof t?$t[Kt[t]]:t}const{toPoint:Zt}=qt,Jt={toPoint(t,e,i,s,r){Zt(t,i,s,r,e)}},te={0:1,1:1,2:1,3:1,4:1,5:1,6:1,7:1,8:1,9:1,".":1,e:1,E:1};class ee{constructor(t){this.repeatMap={},this.name=t}static get(t){return new ee(t)}static set filter(t){this.filterList=ie(t)}static set exclude(t){this.excludeList=ie(t)}log(...t){if(se.enable){if(se.filterList.length&&se.filterList.every((t=>t!==this.name)))return;if(se.excludeList.length&&se.excludeList.some((t=>t===this.name)))return;console.log("%c"+this.name,"color:#21ae62",...t)}}tip(...t){se.enable&&this.warn(...t)}warn(...t){se.showWarn&&console.warn(this.name,...t)}repeat(t,...e){this.repeatMap[t]||(this.warn("repeat:"+t,...e),this.repeatMap[t]=!0)}error(...t){try{throw new Error}catch(e){console.error(this.name,...t,e)}}}function ie(t){return t?"string"===typeof t&&(t=[t]):t=[],t}ee.filterList=[],ee.excludeList=[],ee.showWarn=!0;const se=ee,re=ee.get("RunTime"),ne={currentId:0,currentName:"",idMap:{},nameMap:{},nameToIdMap:{},start(t,e){const i=Y.create(Y.RUNTIME);return oe.currentId=oe.idMap[i]=e?performance.now():Date.now(),oe.currentName=oe.nameMap[i]=t,oe.nameToIdMap[t]=i,i},end(t,e){const i=oe.idMap[t],s=oe.nameMap[t],r=e?(performance.now()-i)/1e3:Date.now()-i;oe.idMap[t]=oe.nameMap[t]=oe.nameToIdMap[s]=void 0,re.log(s,r,"ms")},endOfName(t,e){const i=oe.nameToIdMap[t];void 0!==i&&oe.end(i,e)}},oe=ne,ae=ee.get("UICreator"),he={list:{},register(t){const{__tag:e}=t.prototype;le[e]?ae.repeat(e):le[e]=t},get(t,e,i,s,r,n){const o=new le[t](e);return void 0!==i&&(o.x=i,s&&(o.y=s),r&&(o.width=r),n&&(o.height=n)),o}},{list:le}=he,de=ee.get("EventCreator"),ce={nameList:{},register(t){let e;Object.keys(t).forEach((i=>{e=t[i],"string"===typeof e&&(ue[e]?de.repeat(e):ue[e]=t)}))},changeName(t,e){const i=ue[t];if(i){const s=Object.keys(i).find((e=>i[e]===t));s&&(i[s]=e,ue[e]=i)}},has(t){return!!this.nameList[t]},get(t,...e){return new ue[t](...e)}},{nameList:ue}=ce;class pe{constructor(){this.list=[]}add(t){t.manager=this,this.list.push(t)}get(t){let e;const{list:i}=this;for(let r=0,n=i.length;r<n;r++)if(e=i[r],e.recycled&&e.isSameSize(t))return e.recycled=!1,e.manager||(e.manager=this),e;const s=F.canvas(t);return this.add(s),s}recycle(t){t.recycled=!0}clearRecycled(){let t;const e=[];for(let i=0,s=this.list.length;i<s;i++)t=this.list[i],t.recycled?t.destroy():e.push(t);this.list=e}clear(){this.list.forEach((t=>{t.destroy()})),this.list.length=0}destroy(){this.clear()}}const _e={default(t,e){return ye(e,t),ye(t,e),t},assign(t,e){let i;Object.keys(e).forEach((s=>{var r;i=e[s],(null===i||void 0===i?void 0:i.constructor)===Object&&(null===(r=t[s])||void 0===r?void 0:r.constructor)===Object?ye(t[s],e[s]):t[s]=e[s]}))},copyAttrs(t,e,i){return i.forEach((i=>{void 0!==e[i]&&(t[i]=e[i])})),t},clone(t){return JSON.parse(JSON.stringify(t))},toMap(t){const e={};for(let i=0,s=t.length;i<s;i++)e[t[i]]=!0;return e}},{assign:ye}=_e;class ge{get __useNaturalRatio(){return!0}get __isLinePath(){return this.path&&6===this.path.length}get __blendMode(){if(this.eraser&&"path"!==this.eraser)return"destination-out";const{blendMode:t}=this;return"pass-through"===t?null:t}constructor(t){this.__leaf=t}__get(t){if(this.__input){const e=this.__input[t];if(void 0!==e)return e}return this[t]}__getData(){const t={tag:this.__leaf.tag},{__input:e}=this;let i;for(let s in this)"_"!==s[0]&&(i=e?e[s]:void 0,t[s]=void 0===i?this[s]:i);return t}__setInput(t,e){this.__input||(this.__input={}),this.__input[t]=e}__getInput(t){if(this.__input){const e=this.__input[t];if(void 0!==e)return e}if("path"!==t||this.__pathInputed)return this["_"+t]}__removeInput(t){this.__input&&void 0!==this.__input[t]&&(this.__input[t]=void 0)}__getInputData(t,e){const i={};if(t)if(t instanceof Array)for(let s of t)i[s]=this.__getInput(s);else for(let s in t)i[s]=this.__getInput(s);else{let t,e,{__input:s}=this;i.tag=this.__leaf.tag;for(let r in this)if("_"!==r[0]&&(t=this["_"+r],void 0!==t)){if("path"===r&&!this.__pathInputed)continue;e=s?s[r]:void 0,i[r]=void 0===e?t:e}}if(e&&e.matrix){const{a:t,b:e,c:s,d:r,e:n,f:o}=this.__leaf.__localMatrix;i.matrix={a:t,b:e,c:s,d:r,e:n,f:o}}return i}__setMiddle(t,e){this.__middle||(this.__middle={}),this.__middle[t]=e}__getMiddle(t){return this.__middle&&this.__middle[t]}__checkSingle(){const t=this;if("pass-through"===t.blendMode){const e=this.__leaf;t.opacity<1&&e.isBranch||e.__hasEraser||t.eraser?t.__single=!0:t.__single&&(t.__single=!1)}else t.__single=!0}__removeNaturalSize(){this.__naturalWidth=this.__naturalHeight=void 0}destroy(){this.__input=this.__middle=null}}var fe;(function(t){t[t["No"]=0]="No",t[t["Yes"]=1]="Yes",t[t["NoAndSkip"]=2]="NoAndSkip",t[t["YesAndSkip"]=3]="YesAndSkip"})(fe||(fe={}));function me(t,e,i,s){var r,n=arguments.length,o=n<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(t,e,i,s);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(n<3?r(o):n>3?r(e,i,o):r(e,i))||o);return n>3&&o&&Object.defineProperty(e,i,o),o}function xe(t,e,i,s){function r(t){return t instanceof i?t:new i((function(e){e(t)}))}return new(i||(i=Promise))((function(i,n){function o(t){try{h(s.next(t))}catch(e){n(e)}}function a(t){try{h(s["throw"](t))}catch(e){n(e)}}function h(t){t.done?i(t.value):r(t.value).then(o,a)}h((s=s.apply(t,e||[])).next())}))}function ve(t){return(e,i)=>{t||(t=i),Object.defineProperty(e,i,{get(){return this.context[t]},set(e){this.context[t]=e}})}}"function"===typeof SuppressedError&&SuppressedError;const we=[];function be(){return(t,e)=>{we.push(e)}}const ke=[];class Ce{set blendMode(t){"normal"===t&&(t="source-over"),this.context.globalCompositeOperation=t}get blendMode(){return this.context.globalCompositeOperation}set dashPattern(t){this.context.setLineDash(t||ke)}get dashPattern(){return this.context.getLineDash()}__bindContext(){let t;we.forEach((e=>{t=this.context[e],t&&(this[e]=t.bind(this.context))})),this.textBaseline="alphabetic"}setTransform(t,e,i,s,r,n){}resetTransform(){}getTransform(){}save(){}restore(){}transform(t,e,i,s,r,n){"object"===typeof t?this.context.transform(t.a,t.b,t.c,t.d,t.e,t.f):this.context.transform(t,e,i,s,r,n)}translate(t,e){}scale(t,e){}rotate(t){}fill(t,e){}stroke(t){}clip(t,e){}fillRect(t,e,i,s){}strokeRect(t,e,i,s){}clearRect(t,e,i,s){}drawImage(t,e,i,s,r,n,o,a,h){switch(arguments.length){case 9:if(e<0){const t=-e/s*a;s+=e,e=0,n+=t,a-=t}if(i<0){const t=-i/r*h;r+=i,i=0,o+=t,h-=t}this.context.drawImage(t,e,i,s,r,n,o,a,h);break;case 5:this.context.drawImage(t,e,i,s,r);break;case 3:this.context.drawImage(t,e,i)}}beginPath(){}moveTo(t,e){}lineTo(t,e){}bezierCurveTo(t,e,i,s,r,n){}quadraticCurveTo(t,e,i,s){}closePath(){}arc(t,e,i,s,r,n){}arcTo(t,e,i,s,r){}ellipse(t,e,i,s,r,n,o,a){}rect(t,e,i,s){}roundRect(t,e,i,s,r){}createConicGradient(t,e,i){}createLinearGradient(t,e,i,s){}createPattern(t,e){}createRadialGradient(t,e,i,s,r,n){}fillText(t,e,i,s){}measureText(t){}strokeText(t,e,i,s){}destroy(){this.context=null}}me([ve("imageSmoothingEnabled")],Ce.prototype,"smooth",void 0),me([ve("imageSmoothingQuality")],Ce.prototype,"smoothLevel",void 0),me([ve("globalAlpha")],Ce.prototype,"opacity",void 0),me([ve()],Ce.prototype,"fillStyle",void 0),me([ve()],Ce.prototype,"strokeStyle",void 0),me([ve("lineWidth")],Ce.prototype,"strokeWidth",void 0),me([ve("lineCap")],Ce.prototype,"strokeCap",void 0),me([ve("lineJoin")],Ce.prototype,"strokeJoin",void 0),me([ve("lineDashOffset")],Ce.prototype,"dashOffset",void 0),me([ve()],Ce.prototype,"miterLimit",void 0),me([ve()],Ce.prototype,"shadowBlur",void 0),me([ve()],Ce.prototype,"shadowColor",void 0),me([ve()],Ce.prototype,"shadowOffsetX",void 0),me([ve()],Ce.prototype,"shadowOffsetY",void 0),me([ve()],Ce.prototype,"filter",void 0),me([ve()],Ce.prototype,"font",void 0),me([ve()],Ce.prototype,"fontKerning",void 0),me([ve()],Ce.prototype,"fontStretch",void 0),me([ve()],Ce.prototype,"fontVariantCaps",void 0),me([ve()],Ce.prototype,"textAlign",void 0),me([ve()],Ce.prototype,"textBaseline",void 0),me([ve()],Ce.prototype,"textRendering",void 0),me([ve()],Ce.prototype,"wordSpacing",void 0),me([ve()],Ce.prototype,"letterSpacing",void 0),me([ve()],Ce.prototype,"direction",void 0),me([be()],Ce.prototype,"setTransform",null),me([be()],Ce.prototype,"resetTransform",null),me([be()],Ce.prototype,"getTransform",null),me([be()],Ce.prototype,"save",null),me([be()],Ce.prototype,"restore",null),me([be()],Ce.prototype,"translate",null),me([be()],Ce.prototype,"scale",null),me([be()],Ce.prototype,"rotate",null),me([be()],Ce.prototype,"fill",null),me([be()],Ce.prototype,"stroke",null),me([be()],Ce.prototype,"clip",null),me([be()],Ce.prototype,"fillRect",null),me([be()],Ce.prototype,"strokeRect",null),me([be()],Ce.prototype,"clearRect",null),me([be()],Ce.prototype,"beginPath",null),me([be()],Ce.prototype,"moveTo",null),me([be()],Ce.prototype,"lineTo",null),me([be()],Ce.prototype,"bezierCurveTo",null),me([be()],Ce.prototype,"quadraticCurveTo",null),me([be()],Ce.prototype,"closePath",null),me([be()],Ce.prototype,"arc",null),me([be()],Ce.prototype,"arcTo",null),me([be()],Ce.prototype,"ellipse",null),me([be()],Ce.prototype,"rect",null),me([be()],Ce.prototype,"roundRect",null),me([be()],Ce.prototype,"createConicGradient",null),me([be()],Ce.prototype,"createLinearGradient",null),me([be()],Ce.prototype,"createPattern",null),me([be()],Ce.prototype,"createRadialGradient",null),me([be()],Ce.prototype,"fillText",null),me([be()],Ce.prototype,"measureText",null),me([be()],Ce.prototype,"strokeText",null);const{copy:Be}=nt,Re={width:1,height:1,pixelRatio:1},Se=["width","height","pixelRatio"];class Ee extends Ce{get width(){return this.size.width}get height(){return this.size.height}get pixelRatio(){return this.size.pixelRatio}get pixelWidth(){return this.width*this.pixelRatio}get pixelHeight(){return this.height*this.pixelRatio}get allowBackgroundColor(){return this.view&&this.parentView}constructor(t,e){super(),this.size={},this.worldTransform={},t||(t=Re),t.pixelRatio||(t.pixelRatio=j.devicePixelRatio),this.manager=e,this.innerId=Y.create(Y.CNAVAS);const{width:i,height:s,pixelRatio:r}=t;this.autoLayout=!i||!s,this.size.pixelRatio=r,this.config=t,this.init()}init(){}__createContext(){const{view:t}=this,{contextSettings:e}=this.config;this.context=e?t.getContext("2d",e):t.getContext("2d"),this.__bindContext()}export(t,e){}toBlob(t,e){}toDataURL(t,e){}saveAs(t,e){}resize(t){if(this.isSameSize(t))return;let e;this.context&&!this.unreal&&this.width&&(e=this.getSameCanvas(),e.copyWorld(this)),_e.copyAttrs(this.size,t,Se),this.size.pixelRatio||(this.size.pixelRatio=1),this.bounds=new Ht(0,0,this.width,this.height),this.unreal||(this.updateViewSize(),this.smooth=this.config.smooth),this.updateClientBounds(),this.context&&!this.unreal&&e&&(this.clearWorld(e.bounds),this.copyWorld(e),e.recycle())}updateViewSize(){}updateClientBounds(){}getClientBounds(t){return t&&this.updateClientBounds(),this.clientBounds||this.bounds}startAutoLayout(t,e){}stopAutoLayout(){}setCursor(t){}setWorld(t,e){const{pixelRatio:i}=this,s=this.worldTransform;if(e){const{a:r,b:n,c:o,d:a,e:h,f:l}=e;this.setTransform(s.a=(t.a*r+t.b*o)*i,s.b=(t.a*n+t.b*a)*i,s.c=(t.c*r+t.d*o)*i,s.d=(t.c*n+t.d*a)*i,s.e=(t.e*r+t.f*o+h)*i,s.f=(t.e*n+t.f*a+l)*i)}else this.setTransform(s.a=t.a*i,s.b=t.b*i,s.c=t.c*i,s.d=t.d*i,s.e=t.e*i,s.f=t.f*i)}useWorldTransform(t){t&&(this.worldTransform=t);const e=this.worldTransform;e&&this.setTransform(e.a,e.b,e.c,e.d,e.e,e.f)}setStroke(t,e,i){e&&(this.strokeWidth=e),t&&(this.strokeStyle=t),i&&this.setStrokeOptions(i)}setStrokeOptions(t){this.strokeCap="none"===t.strokeCap?"butt":t.strokeCap,this.strokeJoin=t.strokeJoin,this.dashPattern=t.dashPattern,this.dashOffset=t.dashOffset,this.miterLimit=t.miterLimit}saveBlendMode(t){this.savedBlendMode=this.blendMode,this.blendMode=t}restoreBlendMode(){this.blendMode=this.savedBlendMode}hitFill(t,e){return!0}hitStroke(t,e){return!0}hitPixel(t,e,i=1){return!0}setWorldShadow(t,e,i,s){const{pixelRatio:r}=this;this.shadowOffsetX=t*r,this.shadowOffsetY=e*r,this.shadowBlur=i*r,this.shadowColor=s||"black"}setWorldBlur(t){const{pixelRatio:e}=this;this.filter=`blur(${t*e}px)`}copyWorld(t,e,i,s){if(s&&(this.blendMode=s),e){const{pixelRatio:s}=this;i||(i=e),this.drawImage(t.view,e.x*s,e.y*s,e.width*s,e.height*s,i.x*s,i.y*s,i.width*s,i.height*s)}else this.drawImage(t.view,0,0);s&&(this.blendMode="source-over")}copyWorldToInner(t,e,i,s){if(s&&(this.blendMode=s),e.b||e.c)this.save(),this.resetTransform(),this.copyWorld(t,e,Yt.tempToOuterOf(i,e)),this.restore();else{const{pixelRatio:s}=this;this.drawImage(t.view,e.x*s,e.y*s,e.width*s,e.height*s,i.x,i.y,i.width,i.height)}s&&(this.blendMode="source-over")}copyWorldByReset(t,e,i,s,r){this.resetTransform(),this.copyWorld(t,e,i,s),r||this.useWorldTransform()}useMask(t,e,i){this.copyWorld(t,e,i,"destination-in")}useEraser(t,e,i){this.copyWorld(t,e,i,"destination-out")}fillWorld(t,e,i){i&&(this.blendMode=i),this.fillStyle=e,Vt.set(t).scale(this.pixelRatio),this.fillRect(Vt.x,Vt.y,Vt.width,Vt.height),i&&(this.blendMode="source-over")}strokeWorld(t,e,i){i&&(this.blendMode=i),this.strokeStyle=e,Vt.set(t).scale(this.pixelRatio),this.strokeRect(Vt.x,Vt.y,Vt.width,Vt.height),i&&(this.blendMode="source-over")}clearWorld(t,e){Vt.set(t).scale(this.pixelRatio),e&&Vt.ceil(),this.clearRect(Vt.x,Vt.y,Vt.width,Vt.height)}clipWorld(t,e){this.beginPath(),Vt.set(t).scale(this.pixelRatio),e&&Vt.ceil(),this.rect(Vt.x,Vt.y,Vt.width,Vt.height),this.clip()}clear(){const{pixelRatio:t}=this;this.clearRect(0,0,this.width*t+2,this.height*t+2)}isSameSize(t){return this.width===t.width&&this.height===t.height&&this.pixelRatio===t.pixelRatio}getSameCanvas(t,e){const i=this.manager?this.manager.get(this.size):F.canvas(Object.assign({},this.size));return i.save(),t&&(Be(i.worldTransform,this.worldTransform),i.useWorldTransform()),e&&(i.smooth=this.smooth),i}recycle(t){this.recycled||(this.restore(),t?this.clearWorld(t,!0):this.clear(),this.manager?this.manager.recycle(this):this.destroy())}updateRender(){}unrealCanvas(){}destroy(){this.manager=this.view=this.parentView=null}}const Te={creator:{},parse(t,e){},convertToCanvasData(t,e){}},Pe={N:21,D:22,X:23,G:24,F:25,O:26,P:27,U:28},Le=Object.assign({M:1,m:10,L:2,l:20,H:3,h:30,V:4,v:40,C:5,c:50,S:6,s:60,Q:7,q:70,T:8,t:80,A:9,a:90,Z:11,z:11,R:12},Pe),Oe={M:3,m:3,L:3,l:3,H:2,h:2,V:2,v:2,C:7,c:7,S:5,s:5,Q:5,q:5,T:3,t:3,A:8,a:8,Z:1,z:1,N:5,D:9,X:6,G:9,F:5,O:7,P:4,U:6},Me={m:10,l:20,H:3,h:30,V:4,v:40,c:50,S:6,s:60,q:70,T:8,t:80,A:9,a:90},De=Object.assign(Object.assign({},Me),Pe),Ae=Le,Ie={};for(let Kg in Ae)Ie[Ae[Kg]]=Kg;const We={};for(let Kg in Ae)We[Ae[Kg]]=Oe[Kg];const je={drawRoundRect(t,e,i,s,r,n){const o=V.fourNumber(n,Math.min(s/2,r/2)),a=e+s,h=i+r;o[0]?t.moveTo(e+o[0],i):t.moveTo(e,i),o[1]?t.arcTo(a,i,a,h,o[1]):t.lineTo(a,i),o[2]?t.arcTo(a,h,e,h,o[2]):t.lineTo(a,h),o[3]?t.arcTo(e,h,e,i,o[3]):t.lineTo(e,h),o[0]?t.arcTo(e,i,a,i,o[0]):t.lineTo(e,i)}},{sin:Fe,cos:Ye,atan2:Ne,ceil:ze,abs:Xe,PI:He,sqrt:Ve,pow:Ue}=Math,{setPoint:Ge,addPoint:Ke}=kt,{set:$e}=gt,{M:qe,L:Qe,C:Ze,Q:Je,Z:ti}=Le,ei={},ii={points(t,e,i,s){if(t.push(qe,e[0],e[1]),i&&e.length>5){let r,n,o,a,h,l,d,c,u,p,_,y,g,f=e.length;const m=!0===i?.5:i;s&&(e=[e[f-2],e[f-1],...e,e[0],e[1],e[2],e[3]],f=e.length);for(let i=2;i<f-2;i+=2)r=e[i-2],n=e[i-1],o=e[i],a=e[i+1],h=e[i+2],l=e[i+3],_=Ve(Ue(o-r,2)+Ue(a-n,2)),y=Ve(Ue(h-o,2)+Ue(l-a,2)),g=_+y,_=m*_/g,y=m*y/g,h-=r,l-=n,d=o-_*h,c=a-_*l,2===i?s||t.push(Je,d,c,o,a):t.push(Ze,u,p,d,c,o,a),u=o+y*h,p=a+y*l;s||t.push(Je,u,p,e[f-2],e[f-1])}else for(let r=2,n=e.length;r<n;r+=2)t.push(Qe,e[r],e[r+1]);s&&t.push(ti)},rect(t,e,i,s,r){Te.creator.path=t,Te.creator.moveTo(e,i).lineTo(e+s,i).lineTo(e+s,i+r).lineTo(e,i+r).lineTo(e,i)},roundRect(t,e,i,s,r,n){Te.creator.path=[],je.drawRoundRect(Te.creator,e,i,s,r,n),t.push(...Te.convertToCanvasData(Te.creator.path,!0))},arcTo(t,e,i,s,r,n,o,a,h,l,d){const c=s-e,u=r-i,p=n-s,_=o-r;let y=Ne(u,c),g=Ne(_,p),f=g-y;if(f<0&&(f+=G),f===He||Xe(c+u)<1e-12||Xe(p+_)<1e-12)return t&&t.push(Qe,s,r),h&&(Ge(h,e,i),Ke(h,s,r)),d&&$e(d,e,i),void(l&&$e(l,s,r));const m=c*_-p*u<0,x=m?-1:1,v=a/Ye(f/2),w=s+v*Ye(y+f/2+K*x),b=r+v*Fe(y+f/2+K*x);return y-=K*x,g-=K*x,ni(t,w,b,a,a,0,y/U,g/U,m,h,l,d)},arc(t,e,i,s,r,n,o,a,h,l){return ni(t,e,i,s,s,0,r,n,o,a,h,l)},ellipse(t,e,i,s,r,n,o,a,h,l,d,c){const u=n*U,p=Fe(u),_=Ye(u);let y=o*U,g=a*U;y>He&&(y-=G),g<0&&(g+=G);let f=g-y;f<0?f+=G:f>G&&(f-=G),h&&(f-=G);const m=ze(Xe(f/K)),x=f/m,v=Fe(x/4),w=8/3*v*v/Fe(x/2);g=y+x;let b,k,C,B,R,S,E,T,P=Ye(y),L=Fe(y),O=C=_*s*P-p*r*L,M=B=p*s*P+_*r*L,D=e+C,A=i+B;t&&t.push(Qe,D,A),l&&Ge(l,D,A),c&&$e(c,D,A);for(let I=0;I<m;I++)b=Ye(g),k=Fe(g),C=_*s*b-p*r*k,B=p*s*b+_*r*k,R=e+O-w*(_*s*L+p*r*P),S=i+M-w*(p*s*L-_*r*P),E=e+C+w*(_*s*k+p*r*b),T=i+B+w*(p*s*k-_*r*b),t&&t.push(Ze,R,S,E,T,e+C,i+B),l&&ri(e+O,i+M,R,S,E,T,e+C,i+B,l,!0),O=C,M=B,P=b,L=k,y=g,g+=x;d&&$e(d,e+C,i+B)},quadraticCurveTo(t,e,i,s,r,n,o){t.push(Ze,(e+2*s)/3,(i+2*r)/3,(n+2*s)/3,(o+2*r)/3,n,o)},toTwoPointBoundsByQuadraticCurve(t,e,i,s,r,n,o,a){ri(t,e,(t+2*i)/3,(e+2*s)/3,(r+2*i)/3,(n+2*s)/3,r,n,o,a)},toTwoPointBounds(t,e,i,s,r,n,o,a,h,l){const d=[];let c,u,p,_,y,g,f,m,x=t,v=i,w=r,b=o;for(let k=0;k<2;++k)if(1==k&&(x=e,v=s,w=n,b=a),c=-3*x+9*v-9*w+3*b,u=6*x-12*v+6*w,p=3*v-3*x,Math.abs(c)<1e-12){if(Math.abs(u)<1e-12)continue;_=-p/u,0<_&&_<1&&d.push(_)}else f=u*u-4*p*c,m=Math.sqrt(f),f<0||(y=(-u+m)/(2*c),0<y&&y<1&&d.push(y),g=(-u-m)/(2*c),0<g&&g<1&&d.push(g));l?Ke(h,t,e):Ge(h,t,e),Ke(h,o,a);for(let k=0,C=d.length;k<C;k++)si(d[k],t,e,i,s,r,n,o,a,ei),Ke(h,ei.x,ei.y)},getPointAndSet(t,e,i,s,r,n,o,a,h,l){const d=1-t,c=d*d*d,u=3*d*d*t,p=3*d*t*t,_=t*t*t;l.x=c*e+u*s+p*n+_*a,l.y=c*i+u*r+p*o+_*h},getPoint(t,e,i,s,r,n,o,a,h){const l={};return si(t,e,i,s,r,n,o,a,h,l),l}},{getPointAndSet:si,toTwoPointBounds:ri,ellipse:ni}=ii,{sin:oi,cos:ai,sqrt:hi,atan2:li}=Math,{ellipse:di}=ii,ci={ellipticalArc(t,e,i,s,r,n,o,a,h,l,d){const c=(h-e)/2,u=(l-i)/2,p=n*U,_=oi(p),y=ai(p),g=-y*c-_*u,f=-y*u+_*c,m=s*s,x=r*r,v=f*f,w=g*g,b=m*x-m*v-x*w;let k=0;if(b<0){const t=hi(1-b/(m*x));s*=t,r*=t}else k=(o===a?-1:1)*hi(b/(m*v+x*w));const C=k*s*f/r,B=-k*r*g/s,R=li((f-B)/r,(g-C)/s),S=li((-f-B)/r,(-g-C)/s);let E=S-R;0===a&&E>0?E-=G:1===a&&E<0&&(E+=G);const T=e+c+y*C-_*B,P=i+u+_*C+y*B,L=E<0?1:0;d||j.ellipseToCurve?di(t,T,P,s,r,n,R/U,S/U,L):s!==r||n?t.push(Le.G,T,P,s,r,n,R/U,S/U,L):t.push(Le.O,T,P,s,R/U,S/U,L)}},{M:ui,m:pi,L:_i,l:yi,H:gi,h:fi,V:mi,v:xi,C:vi,c:wi,S:bi,s:ki,Q:Ci,q:Bi,T:Ri,t:Si,A:Ei,a:Ti,Z:Pi,z:Li,N:Oi,D:Mi,X:Di,G:Ai,F:Ii,O:Wi,P:ji,U:Fi}=Le,{rect:Yi,roundRect:Ni,arcTo:zi,arc:Xi,ellipse:Hi,quadraticCurveTo:Vi}=ii,{ellipticalArc:Ui}=ci,Gi=ee.get("PathConvert"),Ki={},$i={current:{dot:0},stringify(t,e){let i,s,r,n=0,o=t.length,a="";while(n<o){s=t[n],i=We[s],a+=s===r?" ":Ie[s];for(let s=1;s<i;s++)a+=V.float(t[n+s],e),s===i-1||(a+=" ");r=s,n+=i}return a},parse(t,e){let i,s,r,n="";const o=[],a=e?De:Me;for(let h=0,l=t.length;h<l;h++)s=t[h],te[s]?("."===s&&(qi.dot&&(Qi(o,n),n=""),qi.dot++),"0"===n&&"."!==s&&(Qi(o,n),n=""),n+=s):Le[s]?(n&&(Qi(o,n),n=""),qi.name=Le[s],qi.length=Oe[s],qi.index=0,Qi(o,qi.name),!i&&a[s]&&(i=!0)):"-"===s||"+"===s?"e"===r||"E"===r?n+=s:(n&&Qi(o,n),n=s):n&&(Qi(o,n),n=""),r=s;return n&&Qi(o,n),i?$i.toCanvasData(o,e):o},toCanvasData(t,e){let i,s,r,n,o,a=0,h=0,l=0,d=0,c=0,u=t.length;const p=[];while(c<u){switch(r=t[c],r){case pi:t[c+1]+=a,t[c+2]+=h;case ui:a=t[c+1],h=t[c+2],p.push(ui,a,h),c+=3;break;case fi:t[c+1]+=a;case gi:a=t[c+1],p.push(_i,a,h),c+=2;break;case xi:t[c+1]+=h;case mi:h=t[c+1],p.push(_i,a,h),c+=2;break;case yi:t[c+1]+=a,t[c+2]+=h;case _i:a=t[c+1],h=t[c+2],p.push(_i,a,h),c+=3;break;case ki:t[c+1]+=a,t[c+2]+=h,t[c+3]+=a,t[c+4]+=h,r=bi;case bi:o=n===vi||n===bi,l=o?2*a-i:t[c+1],d=o?2*h-s:t[c+2],i=t[c+1],s=t[c+2],a=t[c+3],h=t[c+4],p.push(vi,l,d,i,s,a,h),c+=5;break;case wi:t[c+1]+=a,t[c+2]+=h,t[c+3]+=a,t[c+4]+=h,t[c+5]+=a,t[c+6]+=h,r=vi;case vi:i=t[c+3],s=t[c+4],a=t[c+5],h=t[c+6],p.push(vi,t[c+1],t[c+2],i,s,a,h),c+=7;break;case Si:t[c+1]+=a,t[c+2]+=h,r=Ri;case Ri:o=n===Ci||n===Ri,i=o?2*a-i:t[c+1],s=o?2*h-s:t[c+2],e?Vi(p,a,h,i,s,t[c+1],t[c+2]):p.push(Ci,i,s,t[c+1],t[c+2]),a=t[c+1],h=t[c+2],c+=3;break;case Bi:t[c+1]+=a,t[c+2]+=h,t[c+3]+=a,t[c+4]+=h,r=Ci;case Ci:i=t[c+1],s=t[c+2],e?Vi(p,a,h,i,s,t[c+3],t[c+4]):p.push(Ci,i,s,t[c+3],t[c+4]),a=t[c+3],h=t[c+4],c+=5;break;case Ti:t[c+6]+=a,t[c+7]+=h;case Ei:Ui(p,a,h,t[c+1],t[c+2],t[c+3],t[c+4],t[c+5],t[c+6],t[c+7],e),a=t[c+6],h=t[c+7],c+=8;break;case Li:case Pi:p.push(Pi),c++;break;case Oi:a=t[c+1],h=t[c+2],e?Yi(p,a,h,t[c+3],t[c+4]):Zi(p,t,c,5),c+=5;break;case Mi:a=t[c+1],h=t[c+2],e?Ni(p,a,h,t[c+3],t[c+4],[t[c+5],t[c+6],t[c+7],t[c+8]]):Zi(p,t,c,9),c+=9;break;case Di:a=t[c+1],h=t[c+2],e?Ni(p,a,h,t[c+3],t[c+4],t[c+5]):Zi(p,t,c,6),c+=6;break;case Ai:Hi(e?p:Zi(p,t,c,9),t[c+1],t[c+2],t[c+3],t[c+4],t[c+5],t[c+6],t[c+7],t[c+8],null,Ki),a=Ki.x,h=Ki.y,c+=9;break;case Ii:e?Hi(p,t[c+1],t[c+2],t[c+3],t[c+4],0,0,360,!1):Zi(p,t,c,5),a=t[c+1]+t[c+3],h=t[c+2],c+=5;break;case Wi:Xi(e?p:Zi(p,t,c,7),t[c+1],t[c+2],t[c+3],t[c+4],t[c+5],t[c+6],null,Ki),a=Ki.x,h=Ki.y,c+=7;break;case ji:e?Xi(p,t[c+1],t[c+2],t[c+3],0,360,!1):Zi(p,t,c,4),a=t[c+1]+t[c+3],h=t[c+2],c+=4;break;case Fi:zi(e?p:Zi(p,t,c,6),a,h,t[c+1],t[c+2],t[c+3],t[c+4],t[c+5],null,Ki),a=Ki.x,h=Ki.y,c+=6;break;default:return Gi.error(`command: ${r} [index:${c}]`,t),p}n=r}return p},copyData(t,e,i,s){for(let r=i,n=i+s;r<n;r++)t.push(e[r])},pushData(t,e){qi.index===qi.length&&(qi.index=1,t.push(qi.name)),t.push(Number(e)),qi.index++,qi.dot=0}},{current:qi,pushData:Qi,copyData:Zi}=$i,{M:Ji,L:ts,C:es,Q:is,Z:ss,N:rs,D:ns,X:os,G:as,F:hs,O:ls,P:ds,U:cs}=Le,{getMinDistanceFrom:us,getRadianFrom:ps}=gt,{tan:_s,min:ys,abs:gs}=Math,fs={},ms={beginPath(t){t.length=0},moveTo(t,e,i){t.push(Ji,e,i)},lineTo(t,e,i){t.push(ts,e,i)},bezierCurveTo(t,e,i,s,r,n,o){t.push(es,e,i,s,r,n,o)},quadraticCurveTo(t,e,i,s,r){t.push(is,e,i,s,r)},closePath(t){t.push(ss)},rect(t,e,i,s,r){t.push(rs,e,i,s,r)},roundRect(t,e,i,s,r,n){if("number"===typeof n)t.push(os,e,i,s,r,n);else{const o=V.fourNumber(n);o?t.push(ns,e,i,s,r,...o):t.push(rs,e,i,s,r)}},ellipse(t,e,i,s,r,n,o,a,h){void 0===n?t.push(hs,e,i,s,r):(void 0===o&&(o=0),void 0===a&&(a=360),t.push(as,e,i,s,r,n,o,a,h?1:0))},arc(t,e,i,s,r,n,o){void 0===r?t.push(ds,e,i,s):(void 0===n&&(n=360),t.push(ls,e,i,s,r,n,o?1:0))},arcTo(t,e,i,s,r,n,o,a){if(void 0!==o){const h=_s(ps(o,a,e,i,s,r)/2)*(us(o,a,e,i,s,r)/2);t.push(cs,e,i,s,r,ys(n,gs(h)))}else t.push(cs,e,i,s,r,n)},drawEllipse(t,e,i,s,r,n,o,a,h){ii.ellipse(null,e,i,s,r,void 0===n?0:n,void 0===o?0:o,void 0===a?360:a,h,null,null,fs),t.push(Ji,fs.x,fs.y),xs(t,e,i,s,r,n,o,a,h)},drawArc(t,e,i,s,r,n,o){ii.arc(null,e,i,s,void 0===r?0:r,void 0===n?360:n,o,null,null,fs),t.push(Ji,fs.x,fs.y),vs(t,e,i,s,r,n,o)},drawPoints(t,e,i,s){ii.points(t,e,i,s)}},{ellipse:xs,arc:vs}=ms,{moveTo:ws,lineTo:bs,quadraticCurveTo:ks,bezierCurveTo:Cs,closePath:Bs,beginPath:Rs,rect:Ss,roundRect:Es,ellipse:Ts,arc:Ps,arcTo:Ls,drawEllipse:Os,drawArc:Ms,drawPoints:Ds}=ms;class As{set path(t){this.__path=t}get path(){return this.__path}constructor(t){this.clearPath=this.beginPath,this.set(t)}set(t){return this.__path=t?"string"===typeof t?Te.parse(t):t:[],this}beginPath(){return Rs(this.__path),this}moveTo(t,e){return ws(this.__path,t,e),this}lineTo(t,e){return bs(this.__path,t,e),this}bezierCurveTo(t,e,i,s,r,n){return Cs(this.__path,t,e,i,s,r,n),this}quadraticCurveTo(t,e,i,s){return ks(this.__path,t,e,i,s),this}closePath(){return Bs(this.__path),this}rect(t,e,i,s){return Ss(this.__path,t,e,i,s),this}roundRect(t,e,i,s,r){return Es(this.__path,t,e,i,s,r),this}ellipse(t,e,i,s,r,n,o,a){return Ts(this.__path,t,e,i,s,r,n,o,a),this}arc(t,e,i,s,r,n){return Ps(this.__path,t,e,i,s,r,n),this}arcTo(t,e,i,s,r){return Ls(this.__path,t,e,i,s,r),this}drawEllipse(t,e,i,s,r,n,o,a){return Os(this.__path,t,e,i,s,r,n,o,a),this}drawArc(t,e,i,s,r,n){return Ms(this.__path,t,e,i,s,r,n),this}drawPoints(t,e,i){return Ds(this.__path,t,e,i),this}}const{M:Is,L:Ws,C:js,Q:Fs,Z:Ys,N:Ns,D:zs,X:Xs,G:Hs,F:Vs,O:Us,P:Gs,U:Ks}=Le,$s=ee.get("PathDrawer"),qs={drawPathByData(t,e){if(!e)return;let i,s=0,r=e.length;while(s<r)switch(i=e[s],i){case Is:t.moveTo(e[s+1],e[s+2]),s+=3;break;case Ws:t.lineTo(e[s+1],e[s+2]),s+=3;break;case js:t.bezierCurveTo(e[s+1],e[s+2],e[s+3],e[s+4],e[s+5],e[s+6]),s+=7;break;case Fs:t.quadraticCurveTo(e[s+1],e[s+2],e[s+3],e[s+4]),s+=5;break;case Ys:t.closePath(),s+=1;break;case Ns:t.rect(e[s+1],e[s+2],e[s+3],e[s+4]),s+=5;break;case zs:t.roundRect(e[s+1],e[s+2],e[s+3],e[s+4],[e[s+5],e[s+6],e[s+7],e[s+8]]),s+=9;break;case Xs:t.roundRect(e[s+1],e[s+2],e[s+3],e[s+4],e[s+5]),s+=6;break;case Hs:t.ellipse(e[s+1],e[s+2],e[s+3],e[s+4],e[s+5]*U,e[s+6]*U,e[s+7]*U,e[s+8]),s+=9;break;case Vs:t.ellipse(e[s+1],e[s+2],e[s+3],e[s+4],0,0,G,!1),s+=5;break;case Us:t.arc(e[s+1],e[s+2],e[s+3],e[s+4]*U,e[s+5]*U,e[s+6]),s+=7;break;case Gs:t.arc(e[s+1],e[s+2],e[s+3],0,G,!1),s+=4;break;case Ks:t.arcTo(e[s+1],e[s+2],e[s+3],e[s+4],e[s+5]),s+=6;break;default:return void $s.error(`command: ${i} [index:${s}]`,e)}}},{M:Qs,L:Zs,C:Js,Q:tr,Z:er,N:ir,D:sr,X:rr,G:nr,F:or,O:ar,P:hr,U:lr}=Le,{toTwoPointBounds:dr,toTwoPointBoundsByQuadraticCurve:cr,arcTo:ur,arc:pr,ellipse:_r}=ii,{addPointBounds:yr,copy:gr,addPoint:fr,setPoint:mr,addBounds:xr,toBounds:vr}=kt,wr=ee.get("PathBounds");let br,kr,Cr;const Br={},Rr={},Sr={},Er={toBounds(t,e){Er.toTwoPointBounds(t,Rr),vr(Rr,e)},toTwoPointBounds(t,e){if(!t||!t.length)return mr(e,0,0);let i,s,r,n,o,a=0,h=0,l=0;const d=t.length;while(a<d)switch(i=t[a],0===a&&(i===er||i===Js||i===tr?mr(e,h,l):mr(e,t[a+1],t[a+2])),i){case Qs:case Zs:h=t[a+1],l=t[a+2],fr(e,h,l),a+=3;break;case Js:n=t[a+5],o=t[a+6],dr(h,l,t[a+1],t[a+2],t[a+3],t[a+4],n,o,Br),yr(e,Br),h=n,l=o,a+=7;break;case tr:s=t[a+1],r=t[a+2],n=t[a+3],o=t[a+4],cr(h,l,s,r,n,o,Br),yr(e,Br),h=n,l=o,a+=5;break;case er:a+=1;break;case ir:h=t[a+1],l=t[a+2],xr(e,h,l,t[a+3],t[a+4]),a+=5;break;case sr:case rr:h=t[a+1],l=t[a+2],xr(e,h,l,t[a+3],t[a+4]),a+=i===sr?9:6;break;case nr:_r(null,t[a+1],t[a+2],t[a+3],t[a+4],t[a+5],t[a+6],t[a+7],t[a+8],Br,Sr),0===a?gr(e,Br):yr(e,Br),h=Sr.x,l=Sr.y,a+=9;break;case or:h=t[a+1],l=t[a+2],kr=t[a+3],Cr=t[a+4],xr(e,h-kr,l-Cr,2*kr,2*Cr),h+=kr,a+=5;break;case ar:pr(null,t[a+1],t[a+2],t[a+3],t[a+4],t[a+5],t[a+6],Br,Sr),0===a?gr(e,Br):yr(e,Br),h=Sr.x,l=Sr.y,a+=7;break;case hr:h=t[a+1],l=t[a+2],br=t[a+3],xr(e,h-br,l-br,2*br,2*br),h+=br,a+=4;break;case lr:ur(null,h,l,t[a+1],t[a+2],t[a+3],t[a+4],t[a+5],Br,Sr),0===a?gr(e,Br):yr(e,Br),h=Sr.x,l=Sr.y,a+=6;break;default:return void wr.error(`command: ${i} [index:${a}]`,t)}}},{M:Tr,L:Pr,C:Lr,Z:Or}=Le,{getCenterX:Mr,getCenterY:Dr}=gt,{arcTo:Ar}=ms,Ir={smooth(t,e,i){let s,r=0,n=0,o=0,a=0,h=0,l=0,d=0,c=0,u=0;const p=t.length,_=[];while(r<p)switch(s=t[r],s){case Tr:a=c=t[r+1],h=u=t[r+2],r+=3,t[r]===Pr?(l=t[r+1],d=t[r+2],_.push(Tr,Mr(a,l),Dr(h,d))):_.push(Tr,a,h);break;case Pr:switch(n=t[r+1],o=t[r+2],r+=3,t[r]){case Pr:Ar(_,n,o,t[r+1],t[r+2],e,c,u);break;case Or:Ar(_,n,o,a,h,e,c,u);break;default:_.push(Pr,n,o)}c=n,u=o;break;case Lr:_.push(Lr,t[r+1],t[r+2],t[r+3],t[r+4],t[r+5],t[r+6]),r+=7;break;case Or:Ar(_,a,h,l,d,e,c,u),_.push(Or),r+=1;break}return s!==Or&&(_[1]=a,_[2]=h),_}};Te.creator=new As,Te.parse=$i.parse,Te.convertToCanvasData=$i.toCanvasData;const Wr=new As,{drawRoundRect:jr}=je;function Fr(t){t&&!t.roundRect&&(t.roundRect=function(t,e,i,s,r){jr(this,t,e,i,s,r)})}function Yr(t){Fr(t)}const Nr={opacityTypes:["png","webp","svg"],upperCaseTypeMap:{},mineType(t){return!t||t.startsWith("image")?t:("jpg"===t&&(t="jpeg"),"image/"+t)},fileType(t){const e=t.split(".");return e[e.length-1]},isOpaqueImage(t){const e=zr.fileType(t);return["jpg","jpeg"].some((t=>t===e))},getExportOptions(t){switch(typeof t){case"object":return t;case"number":return{quality:t};case"boolean":return{blob:t};default:return{}}}},zr=Nr;zr.opacityTypes.forEach((t=>zr.upperCaseTypeMap[t]=t.toUpperCase()));const Xr=ee.get("TaskProcessor");class Hr{constructor(t){this.parallel=!0,this.time=1,this.id=Y.create(Y.TASK),this.task=t}run(){return xe(this,void 0,void 0,(function*(){try{this.task&&!this.isComplete&&this.parent.running&&(yield this.task())}catch(t){Xr.error(t)}}))}complete(){this.isComplete=!0,this.parent=null,this.task=null}cancel(){this.isCancel=!0,this.complete()}}class Vr{get total(){return this.list.length+this.delayNumber}get finishedIndex(){return this.isComplete?0:this.index+this.parallelSuccessNumber}get remain(){return this.isComplete?this.total:this.total-this.finishedIndex}get percent(){const{total:t}=this;let e=0,i=0;for(let s=0;s<t;s++)s<=this.finishedIndex?(i+=this.list[s].time,s===this.finishedIndex&&(e=i)):e+=this.list[s].time;return this.isComplete?1:i/e}constructor(t){this.config={parallel:6},this.list=[],this.running=!1,this.isComplete=!0,this.index=0,this.delayNumber=0,t&&_e.assign(this.config,t),this.empty()}add(t,e){let i,s,r,n;const o=new Hr(t);return o.parent=this,"number"===typeof e?n=e:e&&(s=e.parallel,i=e.start,r=e.time,n=e.delay),r&&(o.time=r),!1===s&&(o.parallel=!1),void 0===n?this.push(o,i):(this.delayNumber++,setTimeout((()=>{this.delayNumber&&(this.delayNumber--,this.push(o,i))}),n)),this.isComplete=!1,o}push(t,e){this.list.push(t),!1===e||this.timer||(this.timer=setTimeout((()=>this.start())))}empty(){this.index=0,this.parallelSuccessNumber=0,this.list=[],this.parallelList=[],this.delayNumber=0}start(){this.running||(this.running=!0,this.isComplete=!1,this.run())}pause(){clearTimeout(this.timer),this.timer=null,this.running=!1}resume(){this.start()}skip(){this.index++,this.resume()}stop(){this.isComplete=!0,this.list.forEach((t=>{t.isComplete||t.cancel()})),this.pause(),this.empty()}run(){this.running&&(this.setParallelList(),this.parallelList.length>1?this.runParallelTasks():this.remain?this.runTask():this.onComplete())}runTask(){const t=this.list[this.index];t?t.run().then((()=>{this.onTask(t),this.index++,this.nextTask()})).catch((t=>{this.onError(t)})):this.nextTask()}runParallelTasks(){this.parallelList.forEach((t=>this.runParallelTask(t)))}runParallelTask(t){t.run().then((()=>{this.onTask(t),this.fillParallelTask()})).catch((t=>{this.onParallelError(t)}))}nextTask(){this.total===this.finishedIndex?this.onComplete():this.timer=setTimeout((()=>this.run()))}setParallelList(){let t;this.parallelList=[],this.parallelSuccessNumber=0;let e=this.index+this.config.parallel;e>this.list.length&&(e=this.list.length);for(let i=this.index;i<e;i++){if(t=this.list[i],!t.parallel)break;this.parallelList.push(t)}}fillParallelTask(){let t;const e=this.parallelList;this.parallelSuccessNumber++,e.pop();const i=e.length,s=this.finishedIndex+i;if(e.length){if(!this.running)return;s<this.total&&(t=this.list[s],t&&t.parallel&&(e.push(t),this.runParallelTask(t)))}else this.index+=this.parallelSuccessNumber,this.parallelSuccessNumber=0,this.nextTask()}onComplete(){this.stop(),this.config.onComplete&&this.config.onComplete()}onTask(t){t.complete(),this.config.onTask&&this.config.onTask()}onParallelError(t){this.parallelList.forEach((t=>{t.parallel=!1})),this.parallelList.length=0,this.parallelSuccessNumber=0,this.onError(t)}onError(t){this.pause(),this.config.onError&&this.config.onError(t)}destroy(){this.stop()}}const Ur={map:{},recycledList:[],tasker:new Vr,patternTasker:new Vr,get isComplete(){return Gr.tasker.isComplete},get(t){let e=Gr.map[t.url];return e||(e=F.image(t),Gr.map[t.url]=e),e.use++,e},recycle(t){t.use--,setTimeout((()=>{t.use||Gr.recycledList.push(t)}))},clearRecycled(){const t=Gr.recycledList;t.length>100&&(t.forEach((t=>{!t.use&&t.url&&(delete Gr.map[t.url],t.destroy())})),t.length=0)},hasOpacityPixel(t){return Nr.opacityTypes.some((e=>Gr.isFormat(e,t)))},isFormat(t,e){if(e.format===t)return!0;const{url:i}=e;if(i.startsWith("data:")){if(i.startsWith("data:"+Nr.mineType(t)))return!0}else if(i.includes("."+t)||i.includes("."+Nr.upperCaseTypeMap[t]))return!0;return!1},destroy(){Gr.map={},Gr.recycledList=[]}},Gr=Ur,{IMAGE:Kr,create:$r}=Y;class qr{get url(){return this.config.url}get completed(){return this.ready||!!this.error}constructor(t){this.use=0,this.waitComplete=[],this.innerId=$r(Kr),this.config=t||{url:""},this.isSVG=Ur.isFormat("svg",t),this.hasOpacityPixel=Ur.hasOpacityPixel(t)}load(t,e){return this.loading||(this.loading=!0,Ur.tasker.add((()=>xe(this,void 0,void 0,(function*(){return yield j.origin.loadImage(this.url).then((t=>{this.ready=!0,this.width=t.naturalWidth||t.width,this.height=t.naturalHeight||t.height,this.view=t,this.onComplete(!0)})).catch((t=>{this.error=t,this.onComplete(!1)}))}))))),this.waitComplete.push(t,e),this.waitComplete.length-2}unload(t,e){const i=this.waitComplete;if(e){const e=i[t+1];e&&e({type:"stop"})}i[t]=i[t+1]=void 0}onComplete(t){let e;this.waitComplete.forEach(((i,s)=>{e=s%2,i&&(t?e||i(this):e&&i(this.error))})),this.waitComplete.length=0,this.loading=!1}getCanvas(t,e,i,s){if(t||(t=this.width),e||(e=this.height),this.cache){let{params:t,data:e}=this.cache;for(let i in t)if(t[i]!==arguments[i]){e=null;break}if(e)return e}const r=j.origin.createCanvas(t,e),n=r.getContext("2d");return i&&(n.globalAlpha=i),n.drawImage(this.view,0,0,t,e),this.cache=this.use>1?{data:r,params:arguments}:null,r}getPattern(t,e,i,s){const r=j.canvas.createPattern(t,e);try{i&&r.setTransform&&(r.setTransform(i),i=null)}catch(n){}return s&&(s.transform=i),r}destroy(){this.config={url:""},this.cache=null,this.waitComplete.length=0}}function Qr(t,e,i,s){s||(i.configurable=i.enumerable=!0),Object.defineProperty(t,e,i)}function Zr(t,e){return Object.getOwnPropertyDescriptor(t,e)}function Jr(t){return Object.getOwnPropertyNames(t)}function tn(t,e){return(i,s)=>sn(i,s,t,e&&e(s))}function en(t){return t}function sn(t,e,i,s){const r={get(){return this.__getAttr(e)},set(t){this.__setAttr(e,t)}};Qr(t,e,Object.assign(r,s||{})),En(t,e,i)}function rn(t){return tn(t)}function nn(t,e){return tn(t,(t=>en({set(i){this.__setAttr(t,i,e)&&(this.__layout.matrixChanged||this.__layout.matrixChange())}})))}function on(t){return tn(t,(t=>en({set(e){this.__setAttr(t,e)&&(this.__layout.matrixChanged||this.__layout.matrixChange(),this.__hasAutoLayout=!!e,this.__local||this.__layout.createLocal())}})))}function an(t,e){return tn(t,(t=>en({set(i){this.__setAttr(t,i,e)&&(this.__layout.scaleChanged||this.__layout.scaleChange())}})))}function hn(t,e){return tn(t,(t=>en({set(i){this.__setAttr(t,i,e)&&(this.__layout.rotationChanged||this.__layout.rotationChange())}})))}function ln(t,e){return tn(t,(t=>en({set(i){this.__setAttr(t,i,e)&&cn(this)}})))}function dn(t){return tn(t,(t=>en({set(e){this.__setAttr(t,e)&&(cn(this),this.__.__removeNaturalSize())}})))}function cn(t){t.__layout.boxChanged||t.__layout.boxChange(),t.__hasAutoLayout&&(t.__layout.matrixChanged||t.__layout.matrixChange())}function un(t){return tn(t,(t=>en({set(e){const i=this.__;2!==i.__pathInputed&&(i.__pathInputed=e?1:0),e||(i.__pathForRender=void 0),this.__setAttr(t,e),cn(this)}})))}const pn=ln;function _n(t){return tn(t,(t=>en({set(e){this.__setAttr(t,e)&&yn(this)}})))}function yn(t){t.__layout.strokeChanged||t.__layout.strokeChange(),t.__.__useArrow&&cn(t)}const gn=_n;function fn(t){return tn(t,(t=>en({set(e){this.__setAttr(t,e),this.__layout.renderChanged||this.__layout.renderChange()}})))}function mn(t){return tn(t,(t=>en({set(e){this.__setAttr(t,e)&&(this.__layout.surfaceChanged||this.__layout.surfaceChange())}})))}function xn(t){return tn(t,(t=>en({set(e){this.__setAttr(t,e)&&(this.__layout.opacityChanged||this.__layout.opacityChange())}})))}function vn(t){return tn(t,(t=>en({set(e){const i=this.visible;this.__setAttr(t,e)&&(this.__layout.opacityChanged||this.__layout.opacityChange(),0!==i&&0!==e||cn(this))}})))}function wn(t){return tn(t,(t=>en({set(e){this.__setAttr(t,e)&&(this.__layout.surfaceChanged||this.__layout.surfaceChange(),this.waitParent((()=>{this.parent.__layout.childrenSortChange()})))}})))}function bn(t){return tn(t,(t=>en({set(e){this.__setAttr(t,e)&&(this.__layout.boxChanged||this.__layout.boxChange(),this.waitParent((()=>{this.parent.__updateMask(e)})))}})))}function kn(t){return tn(t,(t=>en({set(e){this.__setAttr(t,e)&&this.waitParent((()=>{this.parent.__updateEraser(e)}))}})))}function Cn(t){return tn(t,(t=>en({set(e){this.__setAttr(t,e)&&(this.__layout.hitCanvasChanged=!0,ee.showHitView&&(this.__layout.surfaceChanged||this.__layout.surfaceChange()),this.leafer&&this.leafer.updateCursor())}})))}function Bn(t){return tn(t,(t=>en({set(e){this.__setAttr(t,e),this.leafer&&this.leafer.updateCursor()}})))}function Rn(t){return(e,i)=>{Qr(e,"__DataProcessor",{get(){return t}})}}function Sn(t){return"set"+t.charAt(0).toUpperCase()+t.slice(1)}function En(t,e,i){const s=t.__DataProcessor.prototype,r="_"+e,n=Sn(e),o={get(){const t=this[r];return void 0===t?i:t},set(t){this[r]=t}};void 0===i?o.get=function(){return this[r]}:"width"===e?o.get=function(){const t=this[r];if(void 0===t){const t=this;return t._height&&t.__naturalWidth&&t.__useNaturalRatio?t._height*t.__naturalWidth/t.__naturalHeight:t.__naturalWidth||i}return t}:"height"===e&&(o.get=function(){const t=this[r];if(void 0===t){const t=this;return t._width&&t.__naturalHeight&&t.__useNaturalRatio?t._width*t.__naturalHeight/t.__naturalWidth:t.__naturalHeight||i}return t});let a,h=s;while(!a&&h)a=Zr(h,e),h=h.__proto__;a&&a.set&&(o.set=a.set),s[n]&&(o.set=s[n],delete s[n]),Qr(s,e,o)}const Tn=new ee("rewrite"),Pn=[],Ln=["destroy","constructor"];function On(t){return(e,i)=>{Pn.push({name:e.constructor.name+"."+i,run:()=>{e[i]=t}})}}function Mn(){return t=>{Dn()}}function Dn(t){Pn.length&&(Pn.forEach((e=>{t&&Tn.error(e.name,"需在Class上装饰@rewriteAble()"),e.run()})),Pn.length=0)}function An(t,e){return i=>{const s=t.prototype?Jr(t.prototype):Object.keys(t);s.forEach((s=>{if(!Ln.includes(s)&&(!e||!e.includes(s)))if(t.prototype){const e=Zr(t.prototype,s);e.writable&&(i.prototype[s]=t.prototype[s])}else i.prototype[s]=t[s]}))}}function In(){return t=>{he.register(t)}}function Wn(){return t=>{ce.register(t)}}setTimeout((()=>Dn(!0)));const{copy:jn,toInnerPoint:Fn,scaleOfOuter:Yn,rotateOfOuter:Nn,skewOfOuter:zn,multiplyParent:Xn,divideParent:Hn,getLayout:Vn}=nt,Un={},Gn={updateAllMatrix(t,e,i){if(e&&t.__hasAutoLayout&&t.__layout.matrixChanged&&(i=!0),qn(t,e,i),t.isBranch){const{children:s}=t;for(let t=0,r=s.length;t<r;t++)$n(s[t],e,i)}},updateMatrix(t,e,i){const s=t.__layout;e?i&&(s.waitAutoLayout=!0,t.__hasAutoLayout&&(s.matrixChanged=!1)):s.waitAutoLayout&&(s.waitAutoLayout=!1),s.matrixChanged&&t.__updateLocalMatrix(),s.waitAutoLayout||t.__updateWorldMatrix()},updateBounds(t){const e=t.__layout;e.boundsChanged&&t.__updateLocalBounds(),e.waitAutoLayout||t.__updateWorldBounds()},updateAllWorldOpacity(t){if(t.__updateWorldOpacity(),t.isBranch){const{children:e}=t;for(let t=0,i=e.length;t<i;t++)Qn(e[t])}},updateAllChange(t){if(Qn(t),t.__updateChange(),t.isBranch){const{children:e}=t;for(let t=0,i=e.length;t<i;t++)Zn(e[t])}},worldHittable(t){while(t){if(!t.__.hittable)return!1;t=t.parent}return!0},moveWorld(t,e,i=0){const s="object"===typeof e?Object.assign({},e):{x:e,y:i};t.parent&&Fn(t.parent.worldTransform,s,s,!0),Kn.moveLocal(t,s.x,s.y)},moveLocal(t,e,i=0){"object"===typeof e?(t.x+=e.x,t.y+=e.y):(t.x+=e,t.y+=i)},zoomOfWorld(t,e,i,s,r){Kn.zoomOfLocal(t,to(t,e),i,s,r)},zoomOfLocal(t,e,i,s=i,r){jn(Un,t.__localMatrix),Yn(Un,e,i,s),Jn(t,Un),t.scaleResize(i,s,!0!==r)},rotateOfWorld(t,e,i){Kn.rotateOfLocal(t,to(t,e),i)},rotateOfLocal(t,e,i){jn(Un,t.__localMatrix),Nn(Un,e,i),Jn(t,Un),t.rotation=V.formatRotation(t.rotation+i)},skewOfWorld(t,e,i,s,r){Kn.skewOfLocal(t,to(t,e),i,s,r)},skewOfLocal(t,e,i,s=0,r){jn(Un,t.__localMatrix),zn(Un,e,i,s),Kn.setTransform(t,Un,r)},transformWorld(t,e,i){jn(Un,t.worldTransform),Xn(Un,e),t.parent&&Hn(Un,t.parent.worldTransform),Kn.setTransform(t,Un,i)},transform(t,e,i){jn(Un,t.localTransform),Xn(Un,e),Kn.setTransform(t,Un,i)},setTransform(t,e,i){const s=Vn(e);if(i){const e=s.scaleX/t.scaleX,r=s.scaleY/t.scaleY;delete s.scaleX,delete s.scaleY,t.set(s),t.scaleResize(e,r,!0!==i)}else t.set(s)},getLocalOrigin(t,e){return gt.tempToOuterOf(Kn.getInnerOrigin(t,e),t.localTransform)},getInnerOrigin(t,e){return"string"===typeof e&&qt.toPoint(e,t.boxBounds,e={}),e},getRelativeWorld(t,e,i){return jn(Un,t.worldTransform),Hn(Un,e.worldTransform),i?Un:Object.assign({},Un)},drop(t,e,i,s){t.setTransform(Kn.getRelativeWorld(t,e,!0),s),e.add(t,i)},hasParent(t,e){if(!e)return!1;while(t){if(e===t)return!0;t=t.parent}}},Kn=Gn,{updateAllMatrix:$n,updateMatrix:qn,updateAllWorldOpacity:Qn,updateAllChange:Zn}=Kn;function Jn(t,e){const{e:i,f:s}=t.__localMatrix;t.x+=e.e-i,t.y+=e.f-s}function to(t,e){return t.__layout.update(),t.parent?gt.tempToInnerOf(e,t.parent.__world):e}const eo={worldBounds(t){return t.__world},localBoxBounds(t){return t.__.eraser||0===t.__.visible?null:t.__local||t.__layout},localStrokeBounds(t){return t.__.eraser||0===t.__.visible?null:t.__layout.localStrokeBounds},localRenderBounds(t){return t.__.eraser||0===t.__.visible?null:t.__layout.localRenderBounds},maskLocalBoxBounds(t){return t.__.mask?t.__localBoxBounds:null},maskLocalStrokeBounds(t){return t.__.mask?t.__layout.localStrokeBounds:null},maskLocalRenderBounds(t){return t.__.mask?t.__layout.localRenderBounds:null},excludeRenderBounds(t,e){return!(!e.bounds||e.bounds.hit(t.__world,e.matrix))||!(!e.hideBounds||!e.hideBounds.includes(t.__world,e.matrix))}},{updateBounds:io}=Gn,so={sort(t,e){return t.__.zIndex===e.__.zIndex?t.__tempNumber-e.__tempNumber:t.__.zIndex-e.__.zIndex},pushAllChildBranch(t,e){if(t.__tempNumber=1,t.__.__childBranchNumber){const{children:i}=t;for(let s=0,r=i.length;s<r;s++)t=i[s],t.isBranch&&(t.__tempNumber=1,e.add(t),ro(t,e))}},pushAllParent(t,e){const{keys:i}=e;if(i)while(t.parent){if(void 0!==i[t.parent.innerId])break;e.add(t.parent),t=t.parent}else while(t.parent)e.add(t.parent),t=t.parent},pushAllBranchStack(t,e){let i=e.length;const{children:s}=t;for(let r=0,n=s.length;r<n;r++)s[r].isBranch&&e.push(s[r]);for(let r=i,n=e.length;r<n;r++)no(e[r],e)},updateBounds(t,e){const i=[t];no(t,i),oo(i,e)},updateBoundsByBranchStack(t,e){let i,s;for(let r=t.length-1;r>-1;r--){i=t[r],s=i.children;for(let t=0,e=s.length;t<e;t++)io(s[t]);e&&e===i||io(i)}}},{pushAllChildBranch:ro,pushAllBranchStack:no,updateBoundsByBranchStack:oo}=so,ao={run(t){if(t&&t.length){const e=t.length;for(let i=0;i<e;i++)t[i]();t.length===e?t.length=0:t.splice(0,e)}}},{getRelativeWorld:ho}=Gn,{toOuterOf:lo,getPoints:co,copy:uo}=Yt,po="_localContentBounds",_o="_worldContentBounds",yo="_worldBoxBounds",go="_worldStrokeBounds";class fo{get contentBounds(){return this._contentBounds||this.boxBounds}set contentBounds(t){this._contentBounds=t}get strokeBounds(){return this._strokeBounds||this.boxBounds}get renderBounds(){return this._renderBounds||this.boxBounds}get localContentBounds(){return lo(this.contentBounds,this.leaf.__localMatrix,this[po]||(this[po]={})),this[po]}get localStrokeBounds(){return this._localStrokeBounds||this}get localRenderBounds(){return this._localRenderBounds||this}get worldContentBounds(){return lo(this.contentBounds,this.leaf.__world,this[_o]||(this[_o]={})),this[_o]}get worldBoxBounds(){return lo(this.boxBounds,this.leaf.__world,this[yo]||(this[yo]={})),this[yo]}get worldStrokeBounds(){return lo(this.strokeBounds,this.leaf.__world,this[go]||(this[go]={})),this[go]}get a(){return 1}get b(){return 0}get c(){return 0}get d(){return 1}get e(){return this.leaf.__.x}get f(){return this.leaf.__.y}get x(){return this.e+this.boxBounds.x}get y(){return this.f+this.boxBounds.y}get width(){return this.boxBounds.width}get height(){return this.boxBounds.height}constructor(t){this.leaf=t,this.boxBounds={x:0,y:0,width:0,height:0},this.leaf.__local&&(this._localRenderBounds=this._localStrokeBounds=this.leaf.__local),this.boxChange(),this.matrixChange()}createLocal(){const t=this.leaf.__local={a:1,b:0,c:0,d:1,e:0,f:0,x:0,y:0,width:0,height:0};this._localStrokeBounds||(this._localStrokeBounds=t),this._localRenderBounds||(this._localRenderBounds=t)}update(){const{leafer:t}=this.leaf;if(t)t.ready?t.watcher.changed&&t.layouter.layout():t.start();else{let t=this.leaf;while(t.parent&&!t.parent.leafer)t=t.parent;j.layout(t)}}getTransform(t="world"){this.update();const{leaf:e}=this;switch(t){case"world":return e.__world;case"local":return e.__localMatrix;case"inner":return nt.defaultMatrix;case"page":t=e.zoomLayer;default:return ho(e,t)}}getBounds(t,e="world"){switch(this.update(),e){case"world":return this.getWorldBounds(t);case"local":return this.getLocalBounds(t);case"inner":return this.getInnerBounds(t);case"page":e=this.leaf.zoomLayer;default:return new Ht(this.getInnerBounds(t)).toOuterOf(this.getTransform(e))}}getInnerBounds(t="box"){switch(t){case"render":return this.renderBounds;case"content":if(this.contentBounds)return this.contentBounds;case"box":return this.boxBounds;case"stroke":return this.strokeBounds}}getLocalBounds(t="box"){switch(t){case"render":return this.localRenderBounds;case"stroke":return this.localStrokeBounds;case"content":if(this.contentBounds)return this.localContentBounds;case"box":return this.leaf.__localBoxBounds}}getWorldBounds(t="box"){switch(t){case"render":return this.leaf.__world;case"stroke":return this.worldStrokeBounds;case"content":if(this.contentBounds)return this.worldContentBounds;case"box":return this.worldBoxBounds}}getLayoutBounds(t,e="world",i){const{leaf:s}=this;let r,n,o=this.getInnerBounds(t);switch(e){case"world":r=s.getWorldPoint(o),n=s.__world;break;case"local":r=s.getLocalPointByInner(o),n=s.__localMatrix;break;case"inner":r=o,n=nt.defaultMatrix;break;case"page":e=s.zoomLayer;default:r=s.getWorldPoint(o,e),n=ho(s,e,!0)}const a=nt.getLayout(n);if(uo(a,o),gt.copy(a,r),i){const{scaleX:t,scaleY:e}=a,i=Math.abs(t),s=Math.abs(e);1===i&&1===s||(a.scaleX/=i,a.scaleY/=s,a.width*=i,a.height*=s)}return a}getLayoutPoints(t,e="world"){const{leaf:i}=this,s=co(this.getInnerBounds(t));let r;switch(e){case"world":r=null;break;case"local":r=i.parent;break;case"inner":break;case"page":e=i.zoomLayer;default:r=e}return void 0!==r&&s.forEach((t=>i.innerToWorld(t,null,!1,r))),s}shrinkContent(){const{x:t,y:e,width:i,height:s}=this.boxBounds;this._contentBounds={x:t,y:e,width:i,height:s}}spreadStroke(){const{x:t,y:e,width:i,height:s}=this.strokeBounds;this._strokeBounds={x:t,y:e,width:i,height:s},this._localStrokeBounds={x:t,y:e,width:i,height:s},this.renderSpread||this.spreadRenderCancel()}spreadRender(){const{x:t,y:e,width:i,height:s}=this.renderBounds;this._renderBounds={x:t,y:e,width:i,height:s},this._localRenderBounds={x:t,y:e,width:i,height:s}}shrinkContentCancel(){this._contentBounds=void 0}spreadStrokeCancel(){const t=this.renderBounds===this.strokeBounds;this._strokeBounds=this.boxBounds,this._localStrokeBounds=this.leaf.__localBoxBounds,t&&this.spreadRenderCancel()}spreadRenderCancel(){this._renderBounds=this._strokeBounds,this._localRenderBounds=this._localStrokeBounds}boxChange(){this.boxChanged=!0,this.localBoxChanged||this.localBoxChange(),this.hitCanvasChanged=!0}localBoxChange(){this.localBoxChanged=!0,this.boundsChanged=!0}strokeChange(){this.strokeChanged=!0,this.strokeSpread||(this.strokeSpread=1),this.boundsChanged=!0,this.hitCanvasChanged=!0}renderChange(){this.renderChanged=!0,this.renderSpread||(this.renderSpread=1),this.boundsChanged=!0}scaleChange(){this.scaleChanged=!0,this._scaleOrRotationChange()}rotationChange(){this.rotationChanged=!0,this.affectRotation=!0,this._scaleOrRotationChange()}_scaleOrRotationChange(){this.affectScaleOrRotation=!0,this.matrixChange(),this.leaf.__local||this.createLocal()}matrixChange(){this.matrixChanged=!0,this.localBoxChanged||this.localBoxChange()}surfaceChange(){this.surfaceChanged=!0}opacityChange(){this.opacityChanged=!0,this.surfaceChanged||this.surfaceChange()}childrenSortChange(){this.childrenSortChanged||(this.childrenSortChanged=!0,this.leaf.forceUpdate("surface"))}destroy(){}}const mo={},xo={on(t,e,i){let s,r,n;i&&("boolean"===typeof i?s=i:(s=i.capture,r=i.once));const o=vo(this,s,!0),a="string"===typeof t?t.split(" "):t,h=r?{listener:e,once:r}:{listener:e};a.forEach((t=>{t&&(n=o[t],n?-1===n.findIndex((t=>t.listener===e))&&n.push(h):o[t]=[h])}))},off(t,e,i){if(t){const s="string"===typeof t?t.split(" "):t;if(e){let t,r,n;i&&(t="boolean"===typeof i?i:i.capture);const o=vo(this,t);s.forEach((t=>{t&&(r=o[t],r&&(n=r.findIndex((t=>t.listener===e)),n>-1&&r.splice(n,1),r.length||delete o[t]))}))}else{const{__bubbleMap:t,__captureMap:e}=this;s.forEach((i=>{t&&delete t[i],e&&delete e[i]}))}}else this.__bubbleMap=this.__captureMap=void 0},on_(t,e,i,s){return i&&(e=e.bind(i)),this.on(t,e,s),{type:t,current:this,listener:e,options:s}},off_(t){if(!t)return;const e=t instanceof Array?t:[t];e.forEach((t=>t.current.off(t.type,t.listener,t.options))),e.length=0},once(t,e,i){this.on(t,e,{once:!0,capture:i})},emit(t,e,i){!e&&ce.has(t)&&(e=ce.get(t,{type:t,target:this,current:this}));const s=vo(this,i),r=s[t];if(r){let s;for(let n=0,o=r.length;n<o;n++)if(s=r[n],s.listener(e),s.once&&(this.off(t,s.listener,i),n--,o--),e&&e.isStopNow)break}this.syncEventer&&this.syncEventer.emitEvent(e,i)},emitEvent(t,e){t.current=this,this.emit(t.type,t,e)},hasEvent(t,e){if(this.syncEventer&&this.syncEventer.hasEvent(t,e))return!0;const{__bubbleMap:i,__captureMap:s}=this,r=i&&i[t],n=s&&s[t];return!!(void 0===e?r||n:e?n:r)}};function vo(t,e,i){if(e){const{__captureMap:e}=t;return e||(i?t.__captureMap={}:mo)}{const{__bubbleMap:e}=t;return e||(i?t.__bubbleMap={}:mo)}}class wo{constructor(t,e){this.bubbles=!1,this.type=t,e&&(this.target=e)}stopDefault(){this.isStopDefault=!0,this.origin&&j.event.stopDefault(this.origin)}stopNow(){this.isStopNow=!0,this.isStop=!0,this.origin&&j.event.stopNow(this.origin)}stop(){this.isStop=!0,this.origin&&j.event.stop(this.origin)}}class bo extends wo{constructor(t,e,i){super(t,e),this.parent=i,this.child=e}}bo.ADD="child.add",bo.REMOVE="child.remove",bo.DESTROY="child.destroy";class ko extends wo{constructor(t,e,i,s,r){super(t,e),this.attrName=i,this.oldValue=s,this.newValue=r}}ko.CHANGE="property.change",ko.LEAFER_CHANGE="property.leafer_change";class Co extends wo{constructor(t,e){super(t),Object.assign(this,e)}}Co.LOAD="image.load",Co.LOADED="image.loaded",Co.ERROR="image.error";class Bo extends wo{get bigger(){if(!this.old)return!0;const{width:t,height:e}=this.old;return this.width>=t&&this.height>=e}get smaller(){return!this.bigger}get samePixelRatio(){return!this.old||this.pixelRatio===this.old.pixelRatio}constructor(t,e){"object"===typeof t?(super(Bo.RESIZE),Object.assign(this,t)):super(t),this.old=e}}Bo.RESIZE="resize";class Ro extends wo{constructor(t,e){super(t),this.data=e}}Ro.REQUEST="watch.request",Ro.DATA="watch.data";class So extends wo{constructor(t,e,i){super(t),e&&(this.data=e,this.times=i)}}So.CHECK_UPDATE="layout.check_update",So.REQUEST="layout.request",So.START="layout.start",So.BEFORE="layout.before",So.LAYOUT="layout",So.AFTER="layout.after",So.AGAIN="layout.again",So.END="layout.end";class Eo extends wo{}Eo.FRAME="animate.frame";class To extends wo{constructor(t,e,i,s){super(t),e&&(this.times=e),i&&(this.renderBounds=i,this.renderOptions=s)}}To.REQUEST="render.request",To.START="render.start",To.BEFORE="render.before",To.RENDER="render",To.AFTER="render.after",To.AGAIN="render.again",To.END="render.end",To.NEXT="render.next";class Po extends wo{}Po.START="leafer.start",Po.BEFORE_READY="leafer.before_ready",Po.READY="leafer.ready",Po.AFTER_READY="leafer.after_ready",Po.VIEW_READY="leafer.view_ready",Po.VIEW_COMPLETED="leafer.view_completed",Po.STOP="leafer.stop",Po.RESTART="leafer.restart",Po.END="leafer.end";const{isFinite:Lo}=Number,Oo=ee.get("setAttr"),Mo={__setAttr(t,e,i){if(this.leafer&&this.leafer.created){const s=this.__.__getInput(t);if(i&&!Lo(e)&&void 0!==e&&(Oo.warn(this.innerName,t,e),e=void 0),"object"===typeof e||s!==e){this.__[t]=e,this.__proxyData&&this.setProxyAttr(t,e);const{CHANGE:i}=ko,r=new ko(i,this,t,s,e);return this.isLeafer?this.emitEvent(new ko(ko.LEAFER_CHANGE,this,t,s,e)):this.hasEvent(i)&&this.emitEvent(r),this.leafer.emitEvent(r),!0}return!1}return this.__[t]=e,this.__proxyData&&this.setProxyAttr(t,e),!0},__getAttr(t){return this.__proxyData?this.getProxyAttr(t):this.__.__get(t)}},{setLayout:Do,multiplyParent:Ao,translateInner:Io,defaultWorld:Wo}=nt,{toPoint:jo,tempPoint:Fo}=qt,Yo={__updateWorldMatrix(){Ao(this.__local||this.__layout,this.parent?this.parent.__world:Wo,this.__world,!!this.__layout.affectScaleOrRotation,this.__,this.parent&&this.parent.__)},__updateLocalMatrix(){if(this.__local){const t=this.__layout,e=this.__local,i=this.__;t.affectScaleOrRotation&&(t.scaleChanged||t.rotationChanged)&&(Do(e,i,null,t.affectRotation),t.scaleChanged=t.rotationChanged=!1),e.e=i.x+i.offsetX,e.f=i.y+i.offsetY,(i.around||i.origin)&&(jo(i.around||i.origin,t.boxBounds,Fo),Io(e,-Fo.x,-Fo.y,i.origin))}this.__layout.matrixChanged=!1}},{updateMatrix:No,updateAllMatrix:zo}=Gn,{updateBounds:Xo}=so,{toOuterOf:Ho,copyAndSpread:Vo,copy:Uo}=Yt,{toBounds:Go}=Er,Ko={__updateWorldBounds(){Ho(this.__layout.renderBounds,this.__world,this.__world),this.__layout.resized&&(this.__onUpdateSize(),this.__layout.resized=!1)},__updateLocalBounds(){const t=this.__layout;t.boxChanged&&(this.__.__pathInputed||this.__updatePath(),this.__updateRenderPath(),this.__updateBoxBounds(),t.resized=!0),t.localBoxChanged&&(this.__local&&this.__updateLocalBoxBounds(),t.localBoxChanged=!1,t.strokeSpread&&(t.strokeChanged=!0),t.renderSpread&&(t.renderChanged=!0),this.parent&&this.parent.__layout.boxChange()),t.boxChanged=!1,t.strokeChanged&&(t.strokeSpread=this.__updateStrokeSpread(),t.strokeSpread?(t.strokeBounds===t.boxBounds&&t.spreadStroke(),this.__updateStrokeBounds(),this.__updateLocalStrokeBounds()):t.spreadStrokeCancel(),t.strokeChanged=!1,(t.renderSpread||t.strokeSpread!==t.strokeBoxSpread)&&(t.renderChanged=!0),this.parent&&this.parent.__layout.strokeChange(),t.resized=!0),t.renderChanged&&(t.renderSpread=this.__updateRenderSpread(),t.renderSpread?(t.renderBounds!==t.boxBounds&&t.renderBounds!==t.strokeBounds||t.spreadRender(),this.__updateRenderBounds(),this.__updateLocalRenderBounds()):t.spreadRenderCancel(),t.renderChanged=!1,this.parent&&this.parent.__layout.renderChange()),t.boundsChanged=!1},__updateLocalBoxBounds(){this.__hasAutoLayout&&this.__updateAutoLayout(),Ho(this.__layout.boxBounds,this.__local,this.__local)},__updateLocalStrokeBounds(){Ho(this.__layout.strokeBounds,this.__localMatrix,this.__layout.localStrokeBounds)},__updateLocalRenderBounds(){Ho(this.__layout.renderBounds,this.__localMatrix,this.__layout.localRenderBounds)},__updateBoxBounds(){const t=this.__layout.boxBounds,e=this.__;e.__pathInputed?Go(e.__pathForRender,t):(t.x=0,t.y=0,t.width=e.width,t.height=e.height)},__updateAutoLayout(){this.__layout.matrixChanged=!0,this.isBranch?(this.leafer&&this.leafer.ready&&this.leafer.layouter.addExtra(this),this.__.flow?(this.__layout.boxChanged&&this.__updateFlowLayout(),zo(this),Xo(this,this),this.__.__autoSide&&this.__updateBoxBounds()):(zo(this),Xo(this,this))):No(this)},__updateNaturalSize(){const{__:t,__layout:e}=this;t.__naturalWidth=e.boxBounds.width,t.__naturalHeight=e.boxBounds.height},__updateStrokeBounds(){const t=this.__layout;Vo(t.strokeBounds,t.boxBounds,t.strokeBoxSpread)},__updateRenderBounds(){const t=this.__layout;t.renderSpread>0?Vo(t.renderBounds,t.boxBounds,t.renderSpread):Uo(t.renderBounds,t.strokeBounds)}},$o={__render(t,e){if(this.__worldOpacity)if(t.setWorld(this.__nowWorld=this.__getNowWorld(e)),t.opacity=this.__.opacity,this.__.__single){if("path"===this.__.eraser)return this.__renderEraser(t,e);const i=t.getSameCanvas(!0,!0);this.__draw(i,e),this.__worldFlipped?t.copyWorldByReset(i,this.__nowWorld,null,this.__.__blendMode,!0):t.copyWorldToInner(i,this.__nowWorld,this.__layout.renderBounds,this.__.__blendMode),i.recycle(this.__nowWorld)}else this.__draw(t,e)},__clip(t,e){this.__worldOpacity&&(t.setWorld(this.__nowWorld=this.__getNowWorld(e)),this.__drawRenderPath(t),this.__.windingRule?t.clip(this.__.windingRule):t.clip())},__updateWorldOpacity(){this.__worldOpacity=this.__.visible?this.parent?this.parent.__worldOpacity*this.__.opacity:this.__.opacity:0,this.__layout.opacityChanged&&(this.__layout.opacityChanged=!1)}},{excludeRenderBounds:qo}=eo,Qo={__updateChange(){const{__layout:t}=this;t.childrenSortChanged&&(this.__updateSortChildren(),t.childrenSortChanged=!1),this.__.__checkSingle()},__render(t,e){if(this.__worldOpacity)if(this.__.__single){if("path"===this.__.eraser)return this.__renderEraser(t,e);const i=t.getSameCanvas(!1,!0);this.__renderBranch(i,e);const s=this.__getNowWorld(e);t.opacity=this.__.opacity,t.copyWorldByReset(i,s,s,this.__.__blendMode,!0),i.recycle(s)}else this.__renderBranch(t,e)},__renderBranch(t,e){if(this.__hasMask)this.__renderMask(t,e);else{const{children:i}=this;for(let s=0,r=i.length;s<r;s++)qo(i[s],e)||i[s].__render(t,e)}},__clip(t,e){if(this.__worldOpacity){const{children:i}=this;for(let s=0,r=i.length;s<r;s++)qo(i[s],e)||i[s].__clip(t,e)}}},{LEAF:Zo,create:Jo}=Y,{toInnerPoint:ta,toOuterPoint:ea,multiplyParent:ia}=nt,{toOuterOf:sa}=Yt,{copy:ra}=gt,{moveLocal:na,zoomOfLocal:oa,rotateOfLocal:aa,skewOfLocal:ha,moveWorld:la,zoomOfWorld:da,rotateOfWorld:ca,skewOfWorld:ua,transform:pa,transformWorld:_a,setTransform:ya,getLocalOrigin:ga,getRelativeWorld:fa,drop:ma}=Gn;let xa=class{get tag(){return this.__tag}set tag(t){}get __tag(){return"Leaf"}get innerName(){return this.__.name||this.tag+this.innerId}get __DataProcessor(){return ge}get __LayoutProcessor(){return fo}get isLeafer(){return!1}get isBranch(){return!1}get isBranchLeaf(){return!1}get __localMatrix(){return this.__local||this.__layout}get __localBoxBounds(){return this.__local||this.__layout}get worldTransform(){return this.__layout.getTransform("world")}get localTransform(){return this.__layout.getTransform("local")}get boxBounds(){return this.getBounds("box","inner")}get renderBounds(){return this.getBounds("render","inner")}get worldBoxBounds(){return this.getBounds("box")}get worldStrokeBounds(){return this.getBounds("stroke")}get worldRenderBounds(){return this.getBounds("render")}get worldOpacity(){return this.__layout.update(),this.__worldOpacity}get __worldFlipped(){return this.__world.scaleX<0||this.__world.scaleY<0}get __onlyHitMask(){return this.__hasMask&&!this.__.hitChildren}get __ignoreHitWorld(){return(this.__hasMask||this.__hasEraser)&&this.__.hitChildren}get __inLazyBounds(){const{leafer:t}=this;return t&&t.created&&t.lazyBounds.hit(this.__world)}get pathInputed(){return this.__.__pathInputed}constructor(t){this.innerId=Jo(Zo),this.reset(t)}reset(t){this.__world={a:1,b:0,c:0,d:1,e:0,f:0,x:0,y:0,width:0,height:0,scaleX:1,scaleY:1},null!==t&&(this.__local={a:1,b:0,c:0,d:1,e:0,f:0,x:0,y:0,width:0,height:0}),this.__worldOpacity=1,this.__=new this.__DataProcessor(this),this.__layout=new this.__LayoutProcessor(this),this.__level&&this.resetCustom(),t&&(t.__&&(t=t.toJSON()),t.children?this.set(t):Object.assign(this,t))}resetCustom(){this.__hasMask=this.__hasEraser=null,this.forceUpdate()}waitParent(t,e){e&&(t=t.bind(e)),this.parent?t():this.__parentWait?this.__parentWait.push(t):this.__parentWait=[t]}waitLeafer(t,e){e&&(t=t.bind(e)),this.leafer?t():this.__leaferWait?this.__leaferWait.push(t):this.__leaferWait=[t]}nextRender(t,e,i){this.leafer?this.leafer.nextRender(t,e,i):this.waitLeafer((()=>this.leafer.nextRender(t,e,i)))}removeNextRender(t){this.nextRender(t,null,"off")}__bindLeafer(t){if(this.isLeafer&&null!==t&&(t=this),this.leafer&&!t&&this.leafer.leafs--,this.leafer=t,t&&(t.leafs++,this.__level=this.parent?this.parent.__level+1:1,this.__leaferWait&&ao.run(this.__leaferWait)),this.isBranch){const{children:e}=this;for(let i=0,s=e.length;i<s;i++)e[i].__bindLeafer(t)}}set(t){}get(t){}setAttr(t,e){this[t]=e}getAttr(t){return this[t]}getComputedAttr(t){return this.__[t]}toJSON(t){return t&&this.__layout.update(),this.__.__getInputData(null,t)}toString(t){return JSON.stringify(this.toJSON(t))}toSVG(){}__SVG(t){}toHTML(){}__setAttr(t,e){return!0}__getAttr(t){}setProxyAttr(t,e){}getProxyAttr(t){}find(t,e){}findTag(t){}findOne(t,e){}findId(t){}focus(t){}updateLayout(){this.__layout.update()}forceUpdate(t){void 0===t?t="width":"surface"===t&&(t="blendMode");const e=this.__.__getInput(t);this.__[t]=void 0===e?null:void 0,this[t]=e}forceRender(t){this.forceUpdate("surface")}__updateWorldMatrix(){}__updateLocalMatrix(){}__updateWorldBounds(){}__updateLocalBounds(){}__updateLocalBoxBounds(){}__updateLocalStrokeBounds(){}__updateLocalRenderBounds(){}__updateBoxBounds(){}__updateContentBounds(){}__updateStrokeBounds(){}__updateRenderBounds(){}__updateAutoLayout(){}__updateFlowLayout(){}__updateNaturalSize(){}__updateStrokeSpread(){return 0}__updateRenderSpread(){return 0}__onUpdateSize(){}__updateEraser(t){this.__hasEraser=!!t||this.children.some((t=>t.__.eraser))}__renderEraser(t,e){t.save(),this.__clip(t,e);const{renderBounds:i}=this.__layout;t.clearRect(i.x,i.y,i.width,i.height),t.restore()}__updateMask(t){this.__hasMask=!!t||this.children.some((t=>t.__.mask))}__renderMask(t,e){}__getNowWorld(t){if(t.matrix){this.__cameraWorld||(this.__cameraWorld={});const e=this.__cameraWorld;return ia(this.__world,t.matrix,e,void 0,this.__world),sa(this.__layout.renderBounds,e,e),e}return this.__world}getTransform(t){return this.__layout.getTransform(t||"local")}getBounds(t,e){return this.__layout.getBounds(t,e)}getLayoutBounds(t,e,i){return this.__layout.getLayoutBounds(t,e,i)}getLayoutPoints(t,e){return this.__layout.getLayoutPoints(t,e)}getWorldBounds(t,e,i){const s=e?fa(this,e):this.worldTransform,r=i?t:{};return sa(t,s,r),r}worldToLocal(t,e,i,s){this.parent?this.parent.worldToInner(t,e,i,s):e&&ra(e,t)}localToWorld(t,e,i,s){this.parent?this.parent.innerToWorld(t,e,i,s):e&&ra(e,t)}worldToInner(t,e,i,s){s&&(s.innerToWorld(t,e,i),t=e||t),ta(this.worldTransform,t,e,i)}innerToWorld(t,e,i,s){ea(this.worldTransform,t,e,i),s&&s.worldToInner(e||t,null,i)}getInnerPoint(t,e,i,s){const r=s?t:{};return this.worldToInner(t,r,i,e),r}getInnerPointByLocal(t,e,i,s){return this.getInnerPoint(t,this.parent,i,s)}getLocalPoint(t,e,i,s){const r=s?t:{};return this.worldToLocal(t,r,i,e),r}getLocalPointByInner(t,e,i,s){return this.getWorldPoint(t,this.parent,i,s)}getWorldPoint(t,e,i,s){const r=s?t:{};return this.innerToWorld(t,r,i,e),r}getWorldPointByLocal(t,e,i,s){const r=s?t:{};return this.localToWorld(t,r,i,e),r}getPagePoint(t,e,i,s){const r=this.leafer?this.leafer.zoomLayer:this;return r.getInnerPoint(t,e,i,s)}getWorldPointByPage(t,e,i,s){const r=this.leafer?this.leafer.zoomLayer:this;return r.getWorldPoint(t,e,i,s)}setTransform(t,e){ya(this,t,e)}transform(t,e){pa(this,t,e)}move(t,e){na(this,t,e)}scaleOf(t,e,i,s){oa(this,ga(this,t),e,i,s)}rotateOf(t,e){aa(this,ga(this,t),e)}skewOf(t,e,i,s){ha(this,ga(this,t),e,i,s)}transformWorld(t,e){_a(this,t,e)}moveWorld(t,e){la(this,t,e)}scaleOfWorld(t,e,i,s){da(this,t,e,i,s)}rotateOfWorld(t,e){ca(this,t,e)}skewOfWorld(t,e,i,s){ua(this,t,e,i,s)}scaleResize(t,e=t,i){this.scaleX*=t,this.scaleY*=e}__scaleResize(t,e){}resizeWidth(t){}resizeHeight(t){}__hitWorld(t){return!0}__hit(t){return!0}__hitFill(t){return!0}__hitStroke(t,e){return!0}__hitPixel(t){return!0}__drawHitPath(t){}__updateHitCanvas(){}__render(t,e){}__drawFast(t,e){}__draw(t,e){}__clip(t,e){}__renderShape(t,e,i,s){}__updateWorldOpacity(){}__updateChange(){}__drawPath(t){}__drawRenderPath(t){}__updatePath(){}__updateRenderPath(){}__updateSortChildren(){}add(t,e){}remove(t,e){this.parent&&this.parent.remove(this,e)}dropTo(t,e,i){ma(this,t,e,i)}on(t,e,i){}off(t,e,i){}on_(t,e,i,s){}off_(t){}once(t,e,i){}emit(t,e,i){}emitEvent(t,e){}hasEvent(t,e){return!1}static changeAttr(t,e,i){i?this.addAttr(t,e,i):En(this.prototype,t,e)}static addAttr(t,e,i){i||(i=ln),i(e)(this.prototype,t)}destroy(){if(!this.destroyed){const{parent:t}=this;t&&this.remove(),this.children&&this.removeAll(!0),this.hasEvent(bo.DESTROY)&&this.emitEvent(new bo(bo.DESTROY,this,t)),this.__.destroy(),this.__layout.destroy(),this.__captureMap=this.__bubbleMap=this.__parentWait=this.__leaferWait=null,this.destroyed=!0}}};xa=me([An(Mo),An(Yo),An(Ko),An(xo),An($o)],xa);const{setListWithFn:va}=Yt,{sort:wa}=so,{localBoxBounds:ba,localStrokeBounds:ka,localRenderBounds:Ca,maskLocalBoxBounds:Ba,maskLocalStrokeBounds:Ra,maskLocalRenderBounds:Sa}=eo;let Ea=class extends xa{__updateStrokeSpread(){const{children:t}=this;for(let e=0,i=t.length;e<i;e++)if(t[e].__layout.strokeSpread)return 1;return 0}__updateRenderSpread(){const{children:t}=this;for(let e=0,i=t.length;e<i;e++)if(t[e].__layout.renderSpread)return 1;return 0}__updateBoxBounds(){va(this.__layout.boxBounds,this.children,this.__hasMask?Ba:ba)}__updateStrokeBounds(){va(this.__layout.strokeBounds,this.children,this.__hasMask?Ra:ka)}__updateRenderBounds(){va(this.__layout.renderBounds,this.children,this.__hasMask?Sa:Ca)}__updateSortChildren(){let t;const{children:e}=this;if(e.length>1){for(let i=0,s=e.length;i<s;i++)e[i].__tempNumber=i,e[i].__.zIndex&&(t=!0);e.sort(wa),this.__layout.affectChildrenSort=t}}add(t,e){t!==this&&(t.parent&&t.parent.remove(t),t.parent=this,void 0===e?this.children.push(t):this.children.splice(e,0,t),t.isBranch&&(this.__.__childBranchNumber=(this.__.__childBranchNumber||0)+1),t.__layout.boxChanged||t.__layout.boxChange(),t.__layout.matrixChanged||t.__layout.matrixChange(),t.__parentWait&&ao.run(t.__parentWait),this.leafer&&(t.__bindLeafer(this.leafer),this.leafer.created&&this.__emitChildEvent(bo.ADD,t)),this.__layout.affectChildrenSort&&this.__layout.childrenSortChange())}addMany(...t){t.forEach((t=>this.add(t)))}remove(t,e){if(t){const i=this.children.indexOf(t);i>-1&&(this.children.splice(i,1),t.isBranch&&(this.__.__childBranchNumber=(this.__.__childBranchNumber||1)-1),this.__preRemove(),this.__realRemoveChild(t),e&&t.destroy())}else void 0===t&&super.remove(null,e)}removeAll(t){const{children:e}=this;e.length&&(this.children=[],this.__preRemove(),this.__.__childBranchNumber=0,e.forEach((e=>{this.__realRemoveChild(e),t&&e.destroy()})))}clear(){this.removeAll(!0)}__preRemove(){this.__hasMask&&this.__updateMask(),this.__hasEraser&&this.__updateEraser(),this.__layout.boxChange(),this.__layout.affectChildrenSort&&this.__layout.childrenSortChange()}__realRemoveChild(t){t.parent=null,this.leafer&&(t.__bindLeafer(null),this.leafer.created&&(this.__emitChildEvent(bo.REMOVE,t),this.leafer.hitCanvasManager&&this.leafer.hitCanvasManager.clear()))}__emitChildEvent(t,e){const i=new bo(t,e,this);e.hasEvent(t)&&e.emitEvent(i),this.hasEvent(t)&&!this.isLeafer&&this.emitEvent(i),this.leafer.emitEvent(i)}};Ea=me([An(Qo)],Ea);class Ta{get length(){return this.list.length}constructor(t){this.reset(),t&&(t instanceof Array?this.addList(t):this.add(t))}has(t){return t&&void 0!==this.keys[t.innerId]}indexAt(t){return this.list[t]}indexOf(t){const e=this.keys[t.innerId];return void 0===e?-1:e}add(t){const{list:e,keys:i}=this;void 0===i[t.innerId]&&(e.push(t),i[t.innerId]=e.length-1)}addAt(t,e=0){const{keys:i}=this;if(void 0===i[t.innerId]){const{list:s}=this;for(let t=e,r=s.length;t<r;t++)i[s[t].innerId]++;0===e?s.unshift(t):(e>s.length&&(e=s.length),s.splice(e,0,t)),i[t.innerId]=e}}addList(t){for(let e=0;e<t.length;e++)this.add(t[e])}remove(t){const{list:e}=this;let i;for(let s=0,r=e.length;s<r;s++)void 0!==i?this.keys[e[s].innerId]=s-1:e[s].innerId===t.innerId&&(i=s,delete this.keys[t.innerId]);void 0!==i&&e.splice(i,1)}sort(t){const{list:e}=this;t?e.sort(((t,e)=>e.__level-t.__level)):e.sort(((t,e)=>t.__level-e.__level))}forEach(t){this.list.forEach(t)}clone(){const t=new Ta;return t.list=[...this.list],t.keys=Object.assign({},this.keys),t}update(){this.keys={};const{list:t,keys:e}=this;for(let i=0,s=t.length;i<s;i++)e[t[i].innerId]=i}reset(){this.list=[],this.keys={}}destroy(){this.reset()}}class Pa{get length(){return this._length}constructor(t){this._length=0,this.reset(),t&&(t instanceof Array?this.addList(t):this.add(t))}has(t){return void 0!==this.keys[t.innerId]}without(t){return void 0===this.keys[t.innerId]}sort(t){const{levels:e}=this;t?e.sort(((t,e)=>e-t)):e.sort(((t,e)=>t-e))}addList(t){t.forEach((t=>{this.add(t)}))}add(t){const{keys:e,levelMap:i}=this;e[t.innerId]||(e[t.innerId]=1,i[t.__level]?i[t.__level].push(t):(i[t.__level]=[t],this.levels.push(t.__level)),this._length++)}forEach(t){let e;this.levels.forEach((i=>{e=this.levelMap[i];for(let s=0,r=e.length;s<r;s++)t(e[s])}))}reset(){this.levelMap={},this.keys={},this.levels=[],this._length=0}destroy(){this.levelMap=null}}function La(t,e,i,s){var r,n=arguments.length,o=n<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(t,e,i,s);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(n<3?r(o):n>3?r(e,i,o):r(e,i))||o);return n>3&&o&&Object.defineProperty(e,i,o),o}"function"===typeof SuppressedError&&SuppressedError;const Oa={},Ma={},Da={},Aa={},Ia={},Wa={},ja={},Fa={},Ya={};function Na(t){return tn(t,(t=>en({set(e){this.__setAttr(t,e),this.waitLeafer((()=>{Ya.setStyle&&Ya.setStyle(this,t+"Style",e)}))}})))}function za(t){return tn(t,(t=>en({set(e){if(this.__setAttr(t,e)){const t=this.__;t.__useArrow="none"!==t.startArrow||"none"!==t.endArrow,yn(this)}}})))}function Xa(t){return tn(t,(t=>en({set(e){this.__setAttr(t,e),e&&(this.__.__useEffect=!0),this.__layout.renderChanged||this.__layout.renderChange()}})))}function Ha(t){return tn(t,(t=>en({set(e){this.__setAttr(t,e),this.__layout.boxChanged||this.__layout.boxChange(),this.__updateSize()}})))}function Va(){return(t,e)=>{const i="_"+e;Qr(t,e,{set(t){this.isLeafer&&(this[i]=t)},get(){return this.isApp?this.tree.zoomLayer:this.isLeafer?this[i]||this:this.leafer&&this.leafer.zoomLayer}})}}const{parse:Ua}=$i,Ga={},Ka=ee.get("UIData");class $a extends ge{get __strokeWidth(){const{strokeWidth:t,strokeWidthFixed:e}=this;if(e){const e=this.__leaf;let{scaleX:i}=e.__nowWorld||e.__world;return i<0&&(i=-i),i>1?t/i:t}return t}get __autoWidth(){return!this._width}get __autoHeight(){return!this._height}get __autoSide(){return!this._width||!this._height}get __autoSize(){return!this._width&&!this._height}setVisible(t){this.__leaf.leafer&&(this.__leaf.leafer.watcher.hasVisible=!0),this._visible=t}setWidth(t){t<0?(this._width=-t,this.__leaf.scaleX*=-1,Ka.warn("width < 0, instead -scaleX ",this)):this._width=t}setHeight(t){t<0?(this._height=-t,this.__leaf.scaleY*=-1,Ka.warn("height < 0, instead -scaleY",this)):this._height=t}setFill(t){this.__naturalWidth&&this.__removeNaturalSize(),"string"!==typeof t&&t?"object"===typeof t&&(this.__setInput("fill",t),this.__leaf.__layout.boxChanged||this.__leaf.__layout.boxChange(),this.__isFills=!0,this._fill||(this._fill=Ga)):(this.__isFills&&(this.__removeInput("fill"),Ia.recycleImage("fill",this),this.__isFills=!1,this.__pixelFill&&(this.__pixelFill=!1)),this._fill=t)}setStroke(t){"string"!==typeof t&&t?"object"===typeof t&&(this.__setInput("stroke",t),this.__leaf.__layout.boxChanged||this.__leaf.__layout.boxChange(),this.__isStrokes=!0,this._stroke||(this._stroke=Ga)):(this.__isStrokes&&(this.__removeInput("stroke"),Ia.recycleImage("stroke",this),this.__isStrokes=!1,this.__pixelStroke&&(this.__pixelStroke=!1)),this._stroke=t)}setPath(t){"string"===typeof t?(this.__setInput("path",t),this._path=Ua(t)):(this.__input&&this.__removeInput("path"),this._path=t)}setShadow(t){this.__setInput("shadow",t),t instanceof Array?(t.some((t=>!1===t.visible))&&(t=t.filter((t=>!1!==t.visible))),this._shadow=t.length?t:null):this._shadow=t?!1===t.visible?null:[t]:null}setInnerShadow(t){this.__setInput("innerShadow",t),t instanceof Array?(t.some((t=>!1===t.visible))&&(t=t.filter((t=>!1!==t.visible))),this._innerShadow=t.length?t:null):this._innerShadow=t?!1===t.visible?null:[t]:null}__computePaint(){const{fill:t,stroke:e}=this.__input;t&&Aa.compute("fill",this.__leaf),e&&Aa.compute("stroke",this.__leaf),this.__needComputePaint=!1}}const qa={number(t,e){return"object"===typeof t?"percent"===t.type?t.value*e:t.value:t}};class Qa extends $a{}class Za extends Qa{get __boxStroke(){return!this.__pathInputed}}class Ja extends Qa{}class th extends Za{}class eh extends $a{}class ih extends $a{get __boxStroke(){return!this.__pathInputed}}class sh extends $a{get __boxStroke(){return!this.__pathInputed}}class rh extends $a{}class nh extends $a{}class oh extends $a{}class ah extends Qa{}const hh={thin:100,"extra-light":200,light:300,normal:400,medium:500,"semi-bold":600,bold:700,"extra-bold":800,black:900};class lh extends $a{get __useNaturalRatio(){return!1}setFontWeight(t){"string"===typeof t?(this.__setInput("fontWeight",t),this._fontWeight=hh[t]||400):(this.__input&&this.__removeInput("fontWeight"),this._fontWeight=t)}}class dh extends ih{setUrl(t){this.__setImageFill(t),this._url=t}__setImageFill(t){this.__leaf.image&&(this.__leaf.image=null),this.fill=t?{type:"image",mode:"strench",url:t}:void 0}__getData(){const t=super.__getData();return delete t.fill,t}__getInputData(){const t=super.__getInputData();return delete t.fill,t}}class ch extends ih{}const uh={__updateStrokeSpread(){let t=0,e=0;const i=this.__,{strokeAlign:s,strokeWidth:r}=i;if((i.stroke||"all"===i.hitStroke)&&r&&"inside"!==s&&(e=t="center"===s?r/2:r,!i.__boxStroke)){const e=i.__isLinePath?0:10*t,s="none"===i.strokeCap?0:r;t+=Math.max(e,s)}return i.__useArrow&&(t+=5*r),this.__layout.strokeBoxSpread=e,t},__updateRenderSpread(){let t=0;const{shadow:e,innerShadow:i,blur:s,backgroundBlur:r}=this.__;e&&e.forEach((e=>{t=Math.max(t,Math.max(Math.abs(e.y),Math.abs(e.x))+(e.spread>0?e.spread:0)+1.5*e.blur)})),s&&(t=Math.max(t,s));let n=t=Math.ceil(t);return i&&i.forEach((t=>{n=Math.max(n,Math.max(Math.abs(t.y),Math.abs(t.x))+(t.spread<0?-t.spread:0)+1.5*t.blur)})),r&&(n=Math.max(n,r)),this.__layout.renderShapeSpread=n,t+(this.__layout.strokeSpread||0)}},ph={__updateChange(){const t=this.__;if(t.__useEffect){const{shadow:e,innerShadow:i,blur:s,backgroundBlur:r}=this.__;t.__useEffect=!!(e||i||s||r)}t.__checkSingle();const e=t.__isFills||t.__isStrokes||t.cornerRadius||t.__useEffect;e?t.__complex=!0:t.__complex&&(t.__complex=!1)},__drawFast(t,e){_h(this,t,e)},__draw(t,e){const i=this.__;if(i.__complex){i.__needComputePaint&&i.__computePaint();const{fill:s,stroke:r,__drawAfterFill:n}=i;if(this.__drawRenderPath(t),i.__useEffect){const o=Aa.shape(this,t,e);this.__nowWorld=this.__getNowWorld(e);const{shadow:a,innerShadow:h}=i;a&&ja.shadow(this,t,o),s&&(i.__isFills?Aa.fills(s,this,t):Aa.fill(s,this,t)),n&&this.__drawAfterFill(t,e),h&&ja.innerShadow(this,t,o),r&&(i.__isStrokes?Aa.strokes(r,this,t):Aa.stroke(r,this,t)),o.worldCanvas&&o.worldCanvas.recycle(),o.canvas.recycle()}else s&&(i.__isFills?Aa.fills(s,this,t):Aa.fill(s,this,t)),n&&this.__drawAfterFill(t,e),r&&(i.__isStrokes?Aa.strokes(r,this,t):Aa.stroke(r,this,t))}else i.__pathInputed?_h(this,t,e):this.__drawFast(t,e)},__renderShape(t,e,i,s){if(this.__worldOpacity){t.setWorld(this.__nowWorld=this.__getNowWorld(e));const{fill:r,stroke:n}=this.__;this.__drawRenderPath(t),r&&!i&&(this.__.__pixelFill?Aa.fills(r,this,t):Aa.fill("#000000",this,t)),this.__.__isCanvas&&this.__drawAfterFill(t,e),n&&!s&&(this.__.__pixelStroke?Aa.strokes(n,this,t):Aa.stroke("#000000",this,t))}}};function _h(t,e,i){const{fill:s,stroke:r,__drawAfterFill:n}=t.__;t.__drawRenderPath(e),s&&Aa.fill(s,t,e),n&&t.__drawAfterFill(e,i),r&&Aa.stroke(r,t,e)}const yh={__drawFast(t,e){let{width:i,height:s,fill:r,stroke:n,__drawAfterFill:o}=this.__;if(r&&(t.fillStyle=r,t.fillRect(0,0,i,s)),o&&this.__drawAfterFill(t,e),n){const{strokeAlign:r,__strokeWidth:o}=this.__;if(!o)return;t.setStroke(n,o,this.__);const a=o/2;switch(r){case"center":t.strokeRect(0,0,i,s);break;case"inside":i-=o,s-=o,i<0||s<0?(t.save(),this.__clip(t,e),t.strokeRect(a,a,i,s),t.restore()):t.strokeRect(a,a,i,s);break;case"outside":t.strokeRect(-a,-a,i+o,s+o);break}}}};var gh;let fh=gh=class extends xa{get app(){return this.leafer&&this.leafer.app}get isFrame(){return!1}set scale(t){"number"===typeof t?this.scaleX=this.scaleY=t:(this.scaleX=t.x,this.scaleY=t.y)}get scale(){const{scaleX:t,scaleY:e}=this;return t!==e?{x:t,y:e}:t}get pen(){const{path:t}=this.__;return Wr.set(this.path=t||[]),t||this.__drawPathByBox(Wr),Wr}get editConfig(){}get editOuter(){return this.__.__isLinePath?"LineEditTool":"EditTool"}get editInner(){return"PathEditor"}constructor(t){super(t)}reset(t){}set(t){Object.assign(this,t)}get(t){return"string"===typeof t?this.__.__getInput(t):this.__.__getInputData(t)}createProxyData(){}find(t,e){}findTag(t){return this.find({tag:t})}findOne(t,e){}findId(t){return this.findOne({id:t})}getPath(t,e){this.__layout.update();let i=e?this.__.__pathForRender:this.__.path;return i||(Wr.set(i=[]),this.__drawPathByBox(Wr)),t?$i.toCanvasData(i,!0):i}getPathString(t,e){return $i.stringify(this.getPath(t,e))}load(){this.__.__computePaint()}__onUpdateSize(){if(this.__.__input){const t=this.__;!t.lazy||this.__inLazyBounds||Fa.running?t.__computePaint():t.__needComputePaint=!0}}__updateRenderPath(){if(this.__.path){const t=this.__;t.__pathForRender=t.cornerRadius?Ir.smooth(t.path,t.cornerRadius,t.cornerSmoothing):t.path,t.__useArrow&&Da.addArrows(this,!t.cornerRadius)}}__drawRenderPath(t){t.beginPath(),this.__drawPathByData(t,this.__.__pathForRender)}__drawPath(t){t.beginPath(),this.__drawPathByData(t,this.__.path)}__drawPathByData(t,e){e?qs.drawPathByData(t,e):this.__drawPathByBox(t)}__drawPathByBox(t){const{x:e,y:i,width:s,height:r}=this.__layout.boxBounds;if(this.__.cornerRadius){const{cornerRadius:n}=this.__;t.roundRect(e,i,s,r,"number"===typeof n?[n]:n)}else t.rect(e,i,s,r)}export(t,e){return Fa.export(this,t,e)}clone(){return gh.one(this.toJSON())}static one(t,e,i,s,r){return he.get(t.tag||this.prototype.__tag,t,e,i,s,r)}static registerUI(){In()(this)}static registerData(t){Rn(t)(this.prototype)}static setEditConfig(t){}static setEditOuter(t){}static setEditInner(t){}destroy(){this.fill=this.stroke=null,super.destroy()}};La([Rn($a)],fh.prototype,"__",void 0),La([Va()],fh.prototype,"zoomLayer",void 0),La([rn("")],fh.prototype,"id",void 0),La([rn("")],fh.prototype,"name",void 0),La([rn("")],fh.prototype,"className",void 0),La([mn("pass-through")],fh.prototype,"blendMode",void 0),La([xn(1)],fh.prototype,"opacity",void 0),La([vn(!0)],fh.prototype,"visible",void 0),La([Na(!1)],fh.prototype,"selected",void 0),La([Na(!1)],fh.prototype,"disabled",void 0),La([mn(!1)],fh.prototype,"locked",void 0),La([wn(0)],fh.prototype,"zIndex",void 0),La([bn(!1)],fh.prototype,"mask",void 0),La([kn(!1)],fh.prototype,"eraser",void 0),La([nn(0,!0)],fh.prototype,"x",void 0),La([nn(0,!0)],fh.prototype,"y",void 0),La([ln(100,!0)],fh.prototype,"width",void 0),La([ln(100,!0)],fh.prototype,"height",void 0),La([an(1,!0)],fh.prototype,"scaleX",void 0),La([an(1,!0)],fh.prototype,"scaleY",void 0),La([hn(0,!0)],fh.prototype,"rotation",void 0),La([hn(0,!0)],fh.prototype,"skewX",void 0),La([hn(0,!0)],fh.prototype,"skewY",void 0),La([nn(0,!0)],fh.prototype,"offsetX",void 0),La([nn(0,!0)],fh.prototype,"offsetY",void 0),La([nn(0,!0)],fh.prototype,"scrollX",void 0),La([nn(0,!0)],fh.prototype,"scrollY",void 0),La([on()],fh.prototype,"origin",void 0),La([on()],fh.prototype,"around",void 0),La([rn(!1)],fh.prototype,"lazy",void 0),La([dn(1)],fh.prototype,"pixelRatio",void 0),La([un()],fh.prototype,"path",void 0),La([pn()],fh.prototype,"windingRule",void 0),La([pn(!0)],fh.prototype,"closed",void 0),La([on(!1)],fh.prototype,"flow",void 0),La([ln(0)],fh.prototype,"padding",void 0),La([ln(0)],fh.prototype,"gap",void 0),La([ln("top-left")],fh.prototype,"flowAlign",void 0),La([ln(!1)],fh.prototype,"flowWrap",void 0),La([ln("box")],fh.prototype,"itemBox",void 0),La([ln(!0)],fh.prototype,"inFlow",void 0),La([ln()],fh.prototype,"autoWidth",void 0),La([ln()],fh.prototype,"autoHeight",void 0),La([ln()],fh.prototype,"lockRatio",void 0),La([ln()],fh.prototype,"autoBox",void 0),La([ln()],fh.prototype,"widthRange",void 0),La([ln()],fh.prototype,"heightRange",void 0),La([rn(!1)],fh.prototype,"draggable",void 0),La([rn()],fh.prototype,"dragBounds",void 0),La([rn(!1)],fh.prototype,"editable",void 0),La([Cn(!0)],fh.prototype,"hittable",void 0),La([Cn("path")],fh.prototype,"hitFill",void 0),La([gn("path")],fh.prototype,"hitStroke",void 0),La([Cn(!1)],fh.prototype,"hitBox",void 0),La([Cn(!0)],fh.prototype,"hitChildren",void 0),La([Cn(!0)],fh.prototype,"hitSelf",void 0),La([Cn()],fh.prototype,"hitRadius",void 0),La([Bn("")],fh.prototype,"cursor",void 0),La([mn()],fh.prototype,"fill",void 0),La([gn()],fh.prototype,"stroke",void 0),La([gn("inside")],fh.prototype,"strokeAlign",void 0),La([gn(1)],fh.prototype,"strokeWidth",void 0),La([gn(!1)],fh.prototype,"strokeWidthFixed",void 0),La([gn("none")],fh.prototype,"strokeCap",void 0),La([gn("miter")],fh.prototype,"strokeJoin",void 0),La([gn()],fh.prototype,"dashPattern",void 0),La([gn()],fh.prototype,"dashOffset",void 0),La([gn(10)],fh.prototype,"miterLimit",void 0),La([za("none")],fh.prototype,"startArrow",void 0),La([za("none")],fh.prototype,"endArrow",void 0),La([pn(0)],fh.prototype,"cornerRadius",void 0),La([pn()],fh.prototype,"cornerSmoothing",void 0),La([Xa()],fh.prototype,"shadow",void 0),La([Xa()],fh.prototype,"innerShadow",void 0),La([Xa()],fh.prototype,"blur",void 0),La([Xa()],fh.prototype,"backgroundBlur",void 0),La([Xa()],fh.prototype,"grayscale",void 0),La([rn()],fh.prototype,"normalStyle",void 0),La([rn()],fh.prototype,"hoverStyle",void 0),La([rn()],fh.prototype,"pressStyle",void 0),La([rn()],fh.prototype,"focusStyle",void 0),La([rn()],fh.prototype,"selectedStyle",void 0),La([rn()],fh.prototype,"disabledStyle",void 0),La([rn({})],fh.prototype,"data",void 0),La([On(xa.prototype.reset)],fh.prototype,"reset",null),fh=gh=La([An(uh),An(ph),Mn()],fh);let mh=class extends fh{get __tag(){return"Group"}get isBranch(){return!0}constructor(t){super(t)}reset(t){this.__setBranch(),super.reset(t)}__setBranch(){this.children||(this.children=[])}set(t){if(t.children){const{children:e}=t;let i;delete t.children,this.children?this.clear():this.__setBranch(),super.set(t),e.forEach((t=>{i=t.__?t:he.get(t.tag,t),this.add(i)})),t.children=e}else super.set(t)}toJSON(t){const e=super.toJSON(t);return e.children=this.children.map((e=>e.toJSON(t))),e}pick(t,e){}addAt(t,e){this.add(t,e)}addAfter(t,e){this.add(t,this.children.indexOf(e)+1)}addBefore(t,e){this.add(t,this.children.indexOf(e))}add(t,e){}addMany(...t){}remove(t,e){}removeAll(t){}clear(){}};var xh;La([Rn(Qa)],mh.prototype,"__",void 0),mh=La([An(Ea),In()],mh);const vh=ee.get("Leafer");let wh=xh=class extends mh{get __tag(){return"Leafer"}get isApp(){return!1}get app(){return this.parent||this}get isLeafer(){return!0}get imageReady(){return this.viewReady&&Ur.isComplete}get layoutLocked(){return!this.layouter.running}get FPS(){return this.renderer?this.renderer.FPS:60}get cursorPoint(){return this.interaction&&this.interaction.hoverData||{x:this.width/2,y:this.height/2}}get clientBounds(){return this.canvas&&this.canvas.getClientBounds()}constructor(t,e){super(e),this.config={type:"design",start:!0,hittable:!0,smooth:!0,lazySpeard:100,zoom:{min:.01,max:256},move:{holdSpaceKey:!0,holdMiddleKey:!0,autoDistance:2}},this.leafs=0,this.__eventIds=[],this.__controllers=[],this.__readyWait=[],this.__viewReadyWait=[],this.__viewCompletedWait=[],this.__nextRenderWait=[],this.userConfig=t,t&&(t.view||t.width)&&this.init(t),xh.list.add(this)}init(t,e){if(this.canvas)return;let i;this.__setLeafer(this),t&&_e.assign(this.config,t);const{config:s}=this;this.initType(s.type);const r=this.canvas=F.canvas(s);this.__controllers.push(this.renderer=F.renderer(this,r,s),this.watcher=F.watcher(this,s),this.layouter=F.layouter(this,s)),this.isApp&&this.__setApp(),this.__checkAutoLayout(s),this.view=r.view,e?(this.__bindApp(e),i=e.running):(this.selector=F.selector(this),this.interaction=F.interaction(this,r,this.selector,s),this.interaction&&(this.__controllers.unshift(this.interaction),this.hitCanvasManager=F.hitCanvasManager()),this.canvasManager=new pe,i=s.start),this.hittable=s.hittable,this.fill=s.fill,this.canvasManager.add(r),this.__listenEvents(),i&&(this.__startTimer=setTimeout(this.start.bind(this))),ao.run(this.__initWait),this.onInit()}onInit(){}initType(t){}set(t){this.waitInit((()=>{super.set(t)}))}start(){clearTimeout(this.__startTimer),!this.running&&this.canvas&&(this.ready?this.emitLeafer(Po.RESTART):this.emitLeafer(Po.START),this.__controllers.forEach((t=>t.start())),this.isApp||this.renderer.render(),this.running=!0)}stop(){clearTimeout(this.__startTimer),this.running&&this.canvas&&(this.__controllers.forEach((t=>t.stop())),this.running=!1,this.emitLeafer(Po.STOP))}unlockLayout(){this.layouter.start(),this.updateLayout()}lockLayout(){this.updateLayout(),this.layouter.stop()}resize(t){const e=_e.copyAttrs({},t,Se);Object.keys(e).forEach((t=>this[t]=e[t]))}forceRender(t){this.renderer.addBlock(t?new Ht(t):this.canvas.bounds),this.viewReady&&this.renderer.update()}updateCursor(t){const e=this.interaction;e&&(t?e.setCursor(t):e.updateCursor())}updateLazyBounds(){this.lazyBounds=this.canvas.bounds.clone().spread(this.config.lazySpeard)}__doResize(t){const{canvas:e}=this;if(!e||e.isSameSize(t))return;const i=_e.copyAttrs({},this.canvas,Se);e.resize(t),this.updateLazyBounds(),this.__onResize(new Bo(t,i))}__onResize(t){this.emitEvent(t),_e.copyAttrs(this.__,t,Se),t.width&&t.height||vh.warn("w = 0 or h = 0"),setTimeout((()=>{this.canvasManager&&this.canvasManager.clearRecycled()}),0)}__setApp(){}__bindApp(t){this.selector=t.selector,this.interaction=t.interaction,this.canvasManager=t.canvasManager,this.hitCanvasManager=t.hitCanvasManager}__setLeafer(t){this.leafer=t,this.__level=1}__checkAutoLayout(t){t.width&&t.height||(this.autoLayout=new Ut(t),this.canvas.startAutoLayout(this.autoLayout,this.__onResize.bind(this)))}__setAttr(t,e){return this.canvas&&(Se.includes(t)?(e||vh.warn(t+" is 0"),this.__changeCanvasSize(t,e)):"fill"===t?this.__changeFill(e):"hittable"===t?this.parent||(this.canvas.hittable=e):"zIndex"===t&&(this.canvas.zIndex=e,setTimeout((()=>this.parent&&this.parent.__updateSortChildren())))),super.__setAttr(t,e)}__getAttr(t){return this.canvas&&Se.includes(t)?this.canvas[t]:super.__getAttr(t)}__changeCanvasSize(t,e){const i=_e.copyAttrs({},this.canvas,Se);i[t]=this.config[t]=e,e&&this.canvas.stopAutoLayout(),this.__doResize(i)}__changeFill(t){this.config.fill=t,this.canvas.allowBackgroundColor?this.canvas.backgroundColor=t:this.forceRender()}__onCreated(){this.created=!0}__onReady(){this.ready||(this.ready=!0,this.emitLeafer(Po.BEFORE_READY),this.emitLeafer(Po.READY),this.emitLeafer(Po.AFTER_READY),ao.run(this.__readyWait))}__onViewReady(){this.viewReady||(this.viewReady=!0,this.emitLeafer(Po.VIEW_READY),ao.run(this.__viewReadyWait))}__onNextRender(){if(this.viewReady){ao.run(this.__nextRenderWait);const{imageReady:t}=this;t&&!this.viewCompleted&&this.__checkViewCompleted(),t||(this.viewCompleted=!1)}}__checkViewCompleted(t=!0){this.nextRender((()=>{this.imageReady&&(t&&this.emitLeafer(Po.VIEW_COMPLETED),ao.run(this.__viewCompletedWait),this.viewCompleted=!0)}))}__onWatchData(){this.watcher.childrenChanged&&this.interaction&&this.nextRender((()=>this.interaction.updateCursor()))}waitInit(t,e){e&&(t=t.bind(e)),this.__initWait||(this.__initWait=[]),this.canvas?t():this.__initWait.push(t)}waitReady(t,e){e&&(t=t.bind(e)),this.ready?t():this.__readyWait.push(t)}waitViewReady(t,e){e&&(t=t.bind(e)),this.viewReady?t():this.__viewReadyWait.push(t)}waitViewCompleted(t,e){e&&(t=t.bind(e)),this.__viewCompletedWait.push(t),this.viewCompleted?this.__checkViewCompleted(!1):this.running||this.start()}nextRender(t,e,i){e&&(t=t.bind(e));const s=this.__nextRenderWait;if(i){for(let r=0;r<s.length;r++)if(s[r]===t){s.splice(r,1);break}}else s.push(t)}zoom(t,e,i){}getValidMove(t,e){return{x:t,y:e}}getValidScale(t){return t}getWorldPointByClient(t,e){return this.interaction&&this.interaction.getLocal(t,e)}__checkUpdateLayout(){this.__layout.update()}emitLeafer(t){this.emitEvent(new Po(t,this))}__listenEvents(){const t=ne.start("FirstCreate "+this.innerName);this.once(Po.START,(()=>ne.end(t))),this.once(So.START,(()=>this.updateLazyBounds())),this.once(So.END,(()=>this.__onReady())),this.once(To.START,(()=>this.__onCreated())),this.once(To.END,(()=>this.__onViewReady())),this.__eventIds.push(this.on_(Ro.DATA,this.__onWatchData,this),this.on_(To.NEXT,this.__onNextRender,this),this.on_(So.CHECK_UPDATE,this.__checkUpdateLayout,this))}__removeListenEvents(){this.off_(this.__eventIds),this.__eventIds.length=0}destroy(t){const e=()=>{if(!this.destroyed){xh.list.remove(this);try{this.stop(),this.emitEvent(new Po(Po.END,this)),this.__removeListenEvents(),this.__controllers.forEach((t=>{this.parent&&t===this.interaction||t.destroy()})),this.__controllers.length=0,this.parent||(this.selector&&this.selector.destroy(),this.hitCanvasManager&&this.hitCanvasManager.destroy(),this.canvasManager.destroy()),this.canvas.destroy(),this.config.view=this.view=null,this.userConfig&&(this.userConfig.view=null),super.destroy(),setTimeout((()=>{Ur.clearRecycled()}),100)}catch(t){vh.error(t)}}};t?e():setTimeout(e)}};wh.list=new Ta,La([Rn(Ja)],wh.prototype,"__",void 0),La([ln()],wh.prototype,"pixelRatio",void 0),wh=xh=La([In()],wh);let bh=class extends fh{get __tag(){return"Rect"}constructor(t){super(t)}};La([Rn(ih)],bh.prototype,"__",void 0),bh=La([An(yh),Mn(),In()],bh);const kh=bh.prototype,Ch=mh.prototype,Bh={},{copy:Rh,add:Sh,includes:Eh}=Yt;let Th=class extends mh{get __tag(){return"Box"}get isBranchLeaf(){return!0}constructor(t){super(t),this.__layout.renderChanged||this.__layout.renderChange()}__updateStrokeSpread(){return 0}__updateRectRenderSpread(){return 0}__updateRenderSpread(){return this.__updateRectRenderSpread()||-1}__updateRectBoxBounds(){}__updateBoxBounds(){const t=this.__;if(this.children.length){if(t.__autoSide){if(this.leafer&&this.leafer.ready&&this.leafer.layouter.addExtra(this),super.__updateBoxBounds(),!t.__autoSize){const e=this.__layout.boxBounds;t.__autoWidth||(e.height+=e.y,e.width=t.width,e.x=e.y=0),t.__autoHeight||(e.width+=e.x,e.height=t.height,e.y=e.x=0)}}else this.__updateRectBoxBounds();t.flow&&this.__updateContentBounds()}else this.__updateRectBoxBounds()}__updateStrokeBounds(){}__updateRenderBounds(){let t;const{renderBounds:e}=this.__layout;this.children.length?(super.__updateRenderBounds(),Rh(Bh,e),this.__updateRectRenderBounds(),t=!Eh(e,Bh)||void 0):this.__updateRectRenderBounds(),this.isOverflow!==t&&(this.isOverflow=t),t&&!(this.__.__drawAfterFill="hide"===this.__.overflow)&&Sh(e,Bh)}__updateRectRenderBounds(){}__updateRectChange(){}__updateChange(){super.__updateChange(),this.__updateRectChange()}__renderRect(t,e){}__renderGroup(t,e){}__render(t,e){this.__.__drawAfterFill?this.__renderRect(t,e):(this.__renderRect(t,e),this.children.length&&this.__renderGroup(t,e))}__drawAfterFill(t,e){const{length:i}=this.children;this.isOverflow?(t.save(),t.clip(),i&&this.__renderGroup(t,e),t.restore()):i&&this.__renderGroup(t,e),this.__.stroke&&i&&(t.setWorld(this.__nowWorld),this.__drawRenderPath(t))}};La([Rn(Za)],Th.prototype,"__",void 0),La([rn(!1)],Th.prototype,"resizeChildren",void 0),La([fn("show")],Th.prototype,"overflow",void 0),La([On(kh.__updateStrokeSpread)],Th.prototype,"__updateStrokeSpread",null),La([On(kh.__updateRenderSpread)],Th.prototype,"__updateRectRenderSpread",null),La([On(kh.__updateBoxBounds)],Th.prototype,"__updateRectBoxBounds",null),La([On(kh.__updateStrokeBounds)],Th.prototype,"__updateStrokeBounds",null),La([On(kh.__updateRenderBounds)],Th.prototype,"__updateRectRenderBounds",null),La([On(kh.__updateChange)],Th.prototype,"__updateRectChange",null),La([On(kh.__render)],Th.prototype,"__renderRect",null),La([On(Ch.__render)],Th.prototype,"__renderGroup",null),Th=La([Mn(),In()],Th);let Ph=class extends Th{get __tag(){return"Frame"}get isFrame(){return!0}constructor(t){super(t)}};La([Rn(th)],Ph.prototype,"__",void 0),La([mn("#FFFFFF")],Ph.prototype,"fill",void 0),La([fn("hide")],Ph.prototype,"overflow",void 0),Ph=La([In()],Ph);const{moveTo:Lh,closePath:Oh,ellipse:Mh}=ms;let Dh=class extends fh{get __tag(){return"Ellipse"}constructor(t){super(t)}__updatePath(){const{width:t,height:e,innerRadius:i,startAngle:s,endAngle:r}=this.__,n=t/2,o=e/2,a=this.__.path=[];i?(s||r?(i<1&&Mh(a,n,o,n*i,o*i,0,s,r,!1),Mh(a,n,o,n,o,0,r,s,!0),i<1&&Oh(a)):(i<1&&(Mh(a,n,o,n*i,o*i),Lh(a,t,o)),Mh(a,n,o,n,o,0,360,0,!0)),j.ellipseToCurve&&(this.__.path=this.getPath(!0))):s||r?(Lh(a,n,o),Mh(a,n,o,n,o,0,s,r,!1),Oh(a)):Mh(a,n,o,n,o)}};La([Rn(sh)],Dh.prototype,"__",void 0),La([pn(0)],Dh.prototype,"innerRadius",void 0),La([pn(0)],Dh.prototype,"startAngle",void 0),La([pn(0)],Dh.prototype,"endAngle",void 0),Dh=La([In()],Dh);const{moveTo:Ah,lineTo:Ih,drawPoints:Wh}=ms,{rotate:jh,getAngle:Fh,getDistance:Yh,defaultPoint:Nh}=gt,{toBounds:zh}=Er;let Xh=class extends fh{get __tag(){return"Line"}get toPoint(){const{width:t,rotation:e}=this.__,i=$();return t&&(i.x=t),e&&jh(i,e),i}set toPoint(t){this.width=Yh(Nh,t),this.rotation=Fh(Nh,t),this.height&&(this.height=0)}constructor(t){super(t)}__updatePath(){const t=this.__,e=t.path=[];t.points?Wh(e,t.points,!1,t.closed):(Ah(e,0,0),Ih(e,this.width,0))}__updateRenderPath(){const t=this.__;!this.pathInputed&&t.points&&t.curve?(Wh(t.__pathForRender=[],t.points,t.curve,t.closed),t.__useArrow&&Da.addArrows(this,!1)):super.__updateRenderPath()}__updateBoxBounds(){this.points?zh(this.__.__pathForRender,this.__layout.boxBounds):super.__updateBoxBounds()}};La([Rn(eh)],Xh.prototype,"__",void 0),La([_n("center")],Xh.prototype,"strokeAlign",void 0),La([ln(0)],Xh.prototype,"height",void 0),La([pn()],Xh.prototype,"points",void 0),La([pn(0)],Xh.prototype,"curve",void 0),La([pn(!1)],Xh.prototype,"closed",void 0),Xh=La([In()],Xh);const{sin:Hh,cos:Vh,PI:Uh}=Math,{moveTo:Gh,lineTo:Kh,closePath:$h,drawPoints:qh}=ms,Qh=Xh.prototype;let Zh=class extends fh{get __tag(){return"Polygon"}constructor(t){super(t)}__updatePath(){const t=this.__.path=[];if(this.__.points)qh(t,this.__.points,!1,!0);else{const{width:e,height:i,sides:s}=this.__,r=e/2,n=i/2;Gh(t,r,0);for(let o=1;o<s;o++)Kh(t,r+r*Hh(2*o*Uh/s),n-n*Vh(2*o*Uh/s))}$h(t)}__updateRenderPath(){}__updateBoxBounds(){}};La([Rn(rh)],Zh.prototype,"__",void 0),La([pn(3)],Zh.prototype,"sides",void 0),La([pn()],Zh.prototype,"points",void 0),La([pn(0)],Zh.prototype,"curve",void 0),La([On(Qh.__updateRenderPath)],Zh.prototype,"__updateRenderPath",null),La([On(Qh.__updateBoxBounds)],Zh.prototype,"__updateBoxBounds",null),Zh=La([Mn(),In()],Zh);const{sin:Jh,cos:tl,PI:el}=Math,{moveTo:il,lineTo:sl,closePath:rl}=ms;let nl=class extends fh{get __tag(){return"Star"}constructor(t){super(t)}__updatePath(){const{width:t,height:e,corners:i,innerRadius:s}=this.__,r=t/2,n=e/2,o=this.__.path=[];il(o,r,0);for(let a=1;a<2*i;a++)sl(o,r+(a%2===0?r:r*s)*Jh(a*el/i),n-(a%2===0?n:n*s)*tl(a*el/i));rl(o)}};La([Rn(nh)],nl.prototype,"__",void 0),La([pn(5)],nl.prototype,"corners",void 0),La([pn(.382)],nl.prototype,"innerRadius",void 0),nl=La([In()],nl);let ol=class extends bh{get __tag(){return"Image"}get ready(){return!!this.image&&this.image.ready}constructor(t){super(t),this.on(Co.LOADED,(t=>{"fill"===t.attrName&&t.attrValue.url===this.url&&(this.image=t.image)}))}destroy(){this.image=null,super.destroy()}};La([Rn(dh)],ol.prototype,"__",void 0),La([ln("")],ol.prototype,"url",void 0),ol=La([In()],ol);let al=class extends bh{get __tag(){return"Canvas"}constructor(t){super(t),this.canvas=F.canvas(this.__),this.context=this.canvas.context,this.__.__isCanvas=this.__.__drawAfterFill=!0}draw(t,e,i,s){t.__layout.update();const r=new bt(t.__world).invert(),n=new bt;e&&n.translate(e.x,e.y),i&&("number"===typeof i?n.scale(i):n.scale(i.x,i.y)),s&&n.rotate(s),r.multiplyParent(n),t.__render(this.canvas,{matrix:r.withScale()}),this.paint()}paint(){this.forceUpdate("fill")}__drawAfterFill(t,e){const i=this.canvas.view,{width:s,height:r}=this;this.__.cornerRadius||this.pathInputed?(t.save(),t.clip(),t.drawImage(this.canvas.view,0,0,i.width,i.height,0,0,s,r),t.restore()):t.drawImage(this.canvas.view,0,0,i.width,i.height,0,0,s,r)}__updateSize(){const{canvas:t}=this;if(t){const{smooth:e}=this.__;t.smooth!==e&&(t.smooth=e),t.resize(this.__)}}destroy(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.context=null),super.destroy()}};La([Rn(ch)],al.prototype,"__",void 0),La([Ha(100)],al.prototype,"width",void 0),La([Ha(100)],al.prototype,"height",void 0),La([Ha(j.devicePixelRatio)],al.prototype,"pixelRatio",void 0),La([Ha(!0)],al.prototype,"smooth",void 0),La([Ha()],al.prototype,"contextSettings",void 0),al=La([In()],al);const{copyAndSpread:hl,includes:ll,isSame:dl,spread:cl,setList:ul}=Yt;let pl=class extends fh{get __tag(){return"Text"}get editInner(){return"TextEditor"}get textDrawData(){return this.__layout.update(),this.__.__textDrawData}constructor(t){super(t)}__drawHitPath(t){const{__lineHeight:e,__baseLine:i,__textDrawData:s}=this.__;t.beginPath(),this.__.__letterSpacing<0?this.__drawPathByData(t):s.rows.forEach((s=>t.rect(s.x,s.y-i,s.width,e)))}__drawPathByData(t,e){const{x:i,y:s,width:r,height:n}=this.__layout.boxBounds;t.rect(i,s,r,n)}__drawRenderPath(t){t.font=this.__.__font}__updateTextDrawData(){const t=this.__;t.__textDrawData=Oa.getDrawData(t.text,this.__)}__updateBoxBounds(){const t=this.__,e=this.__layout,{lineHeight:i,letterSpacing:s,fontFamily:r,fontSize:n,fontWeight:o,italic:a,textCase:h,textOverflow:l,padding:d}=t,c=t.__autoWidth,u=t.__autoHeight;t.__lineHeight=qa.number(i,n),t.__letterSpacing=qa.number(s,n),t.__padding=d?V.fourNumber(d):void 0,t.__baseLine=t.__lineHeight-(t.__lineHeight-.7*n)/2,t.__font=`${a?"italic ":""}${"small-caps"===h?"small-caps ":""}${"normal"!==o?o+" ":""}${n}px ${r}`,t.__clipText="show"!==l&&!t.__autoSize,this.__updateTextDrawData();const{bounds:p}=t.__textDrawData,_=e.boxBounds;if(t.__lineHeight<n&&cl(p,n/2),c||u){if(_.x=c?p.x:0,_.y=u?p.y:0,_.width=c?p.width:t.width,_.height=u?p.height:t.height,d){const[e,i,s,r]=t.__padding;c&&(_.x-=r,_.width+=i+r),u&&(_.y-=e,_.height+=s+e)}this.__updateNaturalSize()}else super.__updateBoxBounds();a&&(_.width+=.16*n);const y=ll(_,p)?_:p;dl(y,e.contentBounds)?t.__textBoxBounds=y:(e.contentBounds=y,e.renderChanged=!0,ul(t.__textBoxBounds={},[_,p]))}__updateRenderSpread(){let t=super.__updateRenderSpread();return t||(t=this.__layout.boxBounds===this.__layout.contentBounds?0:1),t}__updateRenderBounds(){hl(this.__layout.renderBounds,this.__.__textBoxBounds,this.__layout.renderSpread)}};La([Rn(lh)],pl.prototype,"__",void 0),La([ln(0)],pl.prototype,"width",void 0),La([ln(0)],pl.prototype,"height",void 0),La([rn(!1)],pl.prototype,"resizeFontSize",void 0),La([mn("#000000")],pl.prototype,"fill",void 0),La([_n("outside")],pl.prototype,"strokeAlign",void 0),La([Cn("all")],pl.prototype,"hitFill",void 0),La([ln("")],pl.prototype,"text",void 0),La([ln("L")],pl.prototype,"fontFamily",void 0),La([ln(12)],pl.prototype,"fontSize",void 0),La([ln("normal")],pl.prototype,"fontWeight",void 0),La([ln(!1)],pl.prototype,"italic",void 0),La([ln("none")],pl.prototype,"textCase",void 0),La([ln("none")],pl.prototype,"textDecoration",void 0),La([ln(0)],pl.prototype,"letterSpacing",void 0),La([ln({type:"percent",value:1.5})],pl.prototype,"lineHeight",void 0),La([ln(0)],pl.prototype,"paraIndent",void 0),La([ln(0)],pl.prototype,"paraSpacing",void 0),La([ln("left")],pl.prototype,"textAlign",void 0),La([ln("top")],pl.prototype,"verticalAlign",void 0),La([ln("normal")],pl.prototype,"textWrap",void 0),La([ln("show")],pl.prototype,"textOverflow",void 0),pl=La([In()],pl);let _l=class extends fh{get __tag(){return"Path"}constructor(t){super(t),this.__.__pathInputed=2}};La([Rn(oh)],_l.prototype,"__",void 0),La([_n("center")],_l.prototype,"strokeAlign",void 0),_l=La([In()],_l);let yl=class extends mh{get __tag(){return"Pen"}constructor(t){super(t)}setStyle(t){const e=this.pathElement=new _l(t);return this.pathStyle=t,this.__path=e.path||(e.path=[]),this.add(e),this}beginPath(){return this.__path.length=0,this.paint(),this}moveTo(t,e){return this}lineTo(t,e){return this}bezierCurveTo(t,e,i,s,r,n){return this}quadraticCurveTo(t,e,i,s){return this}closePath(){return this}rect(t,e,i,s){return this}roundRect(t,e,i,s,r){return this}ellipse(t,e,i,s,r,n,o,a){return this}arc(t,e,i,s,r,n){return this}arcTo(t,e,i,s,r){return this}drawEllipse(t,e,i,s,r,n,o,a){return this}drawArc(t,e,i,s,r,n){return this}drawPoints(t,e,i){return this}clearPath(){return this}paint(){this.pathElement.forceUpdate("path")}};function gl(){return(t,e)=>{Qr(t,e,{get(){return this.__path}})}}function fl(t,e,i,s){var r,n=arguments.length,o=n<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(t,e,i,s);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(n<3?r(o):n>3?r(e,i,o):r(e,i))||o);return n>3&&o&&Object.defineProperty(e,i,o),o}La([Rn(ah)],yl.prototype,"__",void 0),La([gl()],yl.prototype,"path",void 0),yl=La([An(As,["set","beginPath","path"]),In()],yl),"function"===typeof SuppressedError&&SuppressedError;let ml=class extends wh{get __tag(){return"App"}get isApp(){return!0}constructor(t,e){super(t,e)}init(t,e){if(super.init(t,e),t){const{ground:e,tree:i,sky:s,editor:r}=t;e&&(this.ground=this.addLeafer(e)),(i||r)&&(this.tree=this.addLeafer(i)),(s||r)&&(this.sky=this.addLeafer(s||{type:"draw",usePartRender:!1})),r&&(this.editor=F.editor(r),this.sky.add(this.editor))}}__setApp(){const{canvas:t}=this,{realCanvas:e,view:i}=this.config;e||i===this.canvas.view||!t.parentView?this.realCanvas=!0:t.unrealCanvas(),this.leafer=this,this.watcher.disable(),this.layouter.disable(),this.__eventIds.push(this.on_(ko.CHANGE,this.__onPropertyChange,this))}start(){super.start(),this.children.forEach((t=>t.start()))}stop(){this.children.forEach((t=>t.stop())),super.stop()}unlockLayout(){super.unlockLayout(),this.children.forEach((t=>t.unlockLayout()))}lockLayout(){super.lockLayout(),this.children.forEach((t=>t.lockLayout()))}forceRender(t){this.children.forEach((e=>e.forceRender(t)))}addLeafer(t){const e=new wh(t);return this.add(e),e}add(t,e){if(!t.view){if(this.realCanvas&&!this.canvas.bounds)return void setTimeout((()=>this.add(t,e)),10);t.init(this.__getChildConfig(t.userConfig),this)}super.add(t,e),void 0!==e&&(t.canvas.childIndex=e),this.__listenChildEvents(t)}__onPropertyChange(){ee.showHitView&&this.children.forEach((t=>t.forceUpdate("surface")))}__onCreated(){this.created=this.children.every((t=>t.created))}__onReady(){this.children.every((t=>t.ready))&&super.__onReady()}__onViewReady(){this.children.every((t=>t.viewReady))&&super.__onViewReady()}__onChildRenderEnd(t){this.renderer.addBlock(t.renderBounds),this.viewReady&&this.renderer.update()}__render(t,e){if(e.matrix){const{a:i,b:s,c:r,d:n,e:o,f:a}=e.matrix;t.setTransform(i,s,r,n,o,a)}this.children.forEach((e=>t.copyWorld(e.canvas)))}__onResize(t){this.children.forEach((e=>e.resize(t))),super.__onResize(t)}__checkUpdateLayout(){this.children.forEach((t=>t.__layout.update()))}__getChildConfig(t){let e=Object.assign({},this.config);return e.hittable=e.realCanvas=void 0,t&&_e.assign(e,t),this.autoLayout&&_e.copyAttrs(e,this,Se),e.view=this.realCanvas?void 0:this.view,e.fill=void 0,e}__listenChildEvents(t){t.once(So.END,(()=>this.__onReady())),t.once(To.START,(()=>this.__onCreated())),t.once(To.END,(()=>this.__onViewReady())),this.realCanvas&&this.__eventIds.push(t.on_(To.END,this.__onChildRenderEnd,this))}};ml=fl([In()],ml);const xl={},vl={isHoldSpaceKey(){return vl.isHold("Space")},isHold(t){return xl[t]},setDownCode(t){xl[t]||(xl[t]=!0)},setUpCode(t){xl[t]=!1}},wl={LEFT:1,RIGHT:2,MIDDLE:4,defaultLeft(t){t.buttons||(t.buttons=1)},left(t){return 1===t.buttons},right(t){return 2===t.buttons},middle(t){return 4===t.buttons}};class bl extends wo{get spaceKey(){return vl.isHoldSpaceKey()}get left(){return wl.left(this)}get right(){return wl.right(this)}get middle(){return wl.middle(this)}constructor(t){super(t.type),this.bubbles=!0,Object.assign(this,t)}getPage(){return this.current.getPagePoint(this)}getInner(t){return t||(t=this.current),t.getInnerPoint(this)}getLocal(t){return t||(t=this.current),t.getLocalPoint(this)}static changeName(t,e){ce.changeName(t,e)}}let kl=class extends bl{};kl.POINTER="pointer",kl.BEFORE_DOWN="pointer.before_down",kl.BEFORE_MOVE="pointer.before_move",kl.BEFORE_UP="pointer.before_up",kl.DOWN="pointer.down",kl.MOVE="pointer.move",kl.UP="pointer.up",kl.OVER="pointer.over",kl.OUT="pointer.out",kl.ENTER="pointer.enter",kl.LEAVE="pointer.leave",kl.TAP="tap",kl.DOUBLE_TAP="double_tap",kl.CLICK="click",kl.DOUBLE_CLICK="double_click",kl.LONG_PRESS="long_press",kl.LONG_TAP="long_tap",kl.MENU="pointer.menu",kl.MENU_TAP="pointer.menu_tap",kl=fl([Wn()],kl);const Cl={};let Bl=class extends kl{static setList(t){this.list=t instanceof Ta?t:new Ta(t)}static setData(t){this.data=t}static getValidMove(t,e,i){const{draggable:s,dragBounds:r,x:n,y:o}=t,a=t.getLocalPoint(i,null,!0);return a.x+=e.x-n,a.y+=e.y-o,r&&this.getMoveInDragBounds(t.__local,"parent"===r?t.parent.boxBounds:r,a,!0),"x"===s&&(a.y=0),"y"===s&&(a.x=0),a}static getMoveInDragBounds(t,e,i,s){const r=t.x+i.x,n=t.y+i.y,o=r+t.width,a=n+t.height,h=e.x+e.width,l=e.y+e.height;return s||(i=Object.assign({},i)),Yt.includes(t,e)?(r>e.x?i.x+=e.x-r:o<h&&(i.x+=h-o),n>e.y?i.y+=e.y-n:a<l&&(i.y+=l-a)):(r<e.x?i.x+=e.x-r:o>h&&(i.x+=h-o),n<e.y?i.y+=e.y-n:a>l&&(i.y+=l-a)),i}getPageMove(t){return this.assignMove(t),this.current.getPagePoint(Cl,null,!0)}getInnerMove(t,e){return t||(t=this.current),this.assignMove(e),t.getInnerPoint(Cl,null,!0)}getLocalMove(t,e){return t||(t=this.current),this.assignMove(e),t.getLocalPoint(Cl,null,!0)}getPageTotal(){return this.getPageMove(!0)}getInnerTotal(t){return this.getInnerMove(t,!0)}getLocalTotal(t){return this.getLocalMove(t,!0)}getPageBounds(){const t=this.getPageTotal(),e=this.getPage(),i={};return Yt.set(i,e.x-t.x,e.y-t.y,t.x,t.y),Yt.unsign(i),i}assignMove(t){Cl.x=t?this.totalX:this.moveX,Cl.y=t?this.totalY:this.moveY}};Bl.BEFORE_DRAG="drag.before_drag",Bl.START="drag.start",Bl.DRAG="drag",Bl.END="drag.end",Bl.OVER="drag.over",Bl.OUT="drag.out",Bl.ENTER="drag.enter",Bl.LEAVE="drag.leave",Bl=fl([Wn()],Bl);let Rl=class extends kl{static setList(t){Bl.setList(t)}static setData(t){Bl.setData(t)}};Rl.DROP="drop",Rl=fl([Wn()],Rl);let Sl=class extends Bl{};Sl.BEFORE_MOVE="move.before_move",Sl.START="move.start",Sl.MOVE="move",Sl.END="move.end",Sl=fl([Wn()],Sl);let El=class extends bl{};El.BEFORE_ROTATE="rotate.before_rotate",El.START="rotate.start",El.ROTATE="rotate",El.END="rotate.end",El=fl([Wn()],El);let Tl=class extends Bl{};Tl.SWIPE="swipe",Tl.LEFT="swipe.left",Tl.RIGHT="swipe.right",Tl.UP="swipe.up",Tl.DOWN="swipe.down",Tl=fl([Wn()],Tl);let Pl=class extends bl{};Pl.BEFORE_ZOOM="zoom.before_zoom",Pl.START="zoom.start",Pl.ZOOM="zoom",Pl.END="zoom.end",Pl=fl([Wn()],Pl);let Ll=class extends bl{};function Ol(t){t.isApp||t.__eventIds.push(t.on_(Sl.BEFORE_MOVE,(e=>{t.zoomLayer.move(t.getValidMove(e.moveX,e.moveY))})),t.on_(Pl.BEFORE_ZOOM,(e=>{const{zoomLayer:i}=t,s=t.getValidScale(e.scale);1!==s&&(gt.scaleOf(i,e,s),i.scale=i.__.scaleX*s)})))}function Ml(t){Ol(t),t.config.move.scroll="limit",t.config.zoom.min=1}Ll.DOWN="key.down",Ll.HOLD="key.hold",Ll.UP="key.up",Ll=fl([Wn()],Ll);const Dl=ee.get("LeaferTypeCreator"),Al={list:{},register(t,e){Il[t]?Dl.repeat(t):Il[t]=e},run(t,e){const i=Il[t];i?i(e):Dl.error("no",t)}},{list:Il,register:Wl}=Al;Wl("draw",(()=>{})),Wl("custom",(()=>{})),Wl("design",Ol),Wl("document",Ml);const jl=wh.prototype;jl.initType=function(t){Al.run(t,this)},jl.getValidMove=function(t,e){const{scroll:i,disabled:s}=this.app.config.move;if(i&&(Math.abs(t)>Math.abs(e)?e=0:t=0,"limit"===i)){const{x:i,y:s,width:r,height:n}=new Ht(this.__world).addPoint(this.zoomLayer),o=i+r-this.width,a=s+n-this.height;i>=0&&o<=0?t=0:t>0?i+t>0&&(t=-i):t<0&&o+t<0&&(t=-o),s>=0&&a<=0?e=0:e>0?s+e>0&&(e=-s):e<0&&a+e<0&&(e=-a)}return{x:s?0:t,y:s?0:e}},jl.getValidScale=function(t){const{scaleX:e}=this.zoomLayer.__,{min:i,max:s,disabled:r}=this.app.config.zoom,n=Math.abs(e*t);return n<i?t=i/e:n>s&&(t=s/e),r?1:t};class Fl{constructor(t){this.interaction=t}move(t){const{interaction:e}=this;if(!this.moveData){const{path:i}=e.selector.getByPoint(t,e.hitRadius);t.path=i,this.moveData=Object.assign(Object.assign({},t),{moveX:0,moveY:0}),e.cancelHover(),e.emit(Sl.START,this.moveData)}t.path=this.moveData.path,e.emit(Sl.BEFORE_MOVE,t),e.emit(Sl.MOVE,t),this.transformEndWait()}zoom(t){const{interaction:e}=this;if(!this.zoomData){const{path:i}=e.selector.getByPoint(t,e.hitRadius);t.path=i,this.zoomData=Object.assign(Object.assign({},t),{scale:1}),e.cancelHover(),e.emit(Pl.START,this.zoomData)}t.path=this.zoomData.path,e.emit(Pl.BEFORE_ZOOM,t),e.emit(Pl.ZOOM,t),this.transformEndWait()}rotate(t){const{interaction:e}=this;if(!this.rotateData){const{path:i}=e.selector.getByPoint(t,e.hitRadius);t.path=i,this.rotateData=Object.assign(Object.assign({},t),{rotation:0}),e.cancelHover(),e.emit(El.START,this.rotateData)}t.path=this.rotateData.path,e.emit(El.BEFORE_ROTATE,t),e.emit(El.ROTATE,t),this.transformEndWait()}transformEndWait(){clearTimeout(this.transformTimer),this.transformTimer=setTimeout((()=>{this.transformEnd()}),this.interaction.config.pointer.transformTime)}transformEnd(){this.moveEnd(),this.zoomEnd(),this.rotateEnd()}moveEnd(){this.moveData&&(this.interaction.emit(Sl.END,this.moveData),this.moveData=null)}zoomEnd(){this.zoomData&&(this.interaction.emit(Pl.END,this.zoomData),this.zoomData=null)}rotateEnd(){this.rotateData&&(this.interaction.emit(El.END,this.rotateData),this.rotateData=null)}destroy(){this.zoomData=this.moveData=this.rotateData=null}}const Yl={getMoveEventData(t,e,i){return Object.assign(Object.assign({},i),{x:t.x,y:t.y,moveX:e.x,moveY:e.y})},getRotateEventData(t,e,i){return Object.assign(Object.assign({},i),{x:t.x,y:t.y,rotation:e})},getZoomEventData(t,e,i){return Object.assign(Object.assign({},i),{x:t.x,y:t.y,scale:e})},getDragEventData(t,e,i){return Object.assign(Object.assign({},i),{x:i.x,y:i.y,moveX:i.x-e.x,moveY:i.y-e.y,totalX:i.x-t.x,totalY:i.y-t.y})},getDropEventData(t,e,i){return Object.assign(Object.assign({},t),{list:e,data:i})},getSwipeDirection(t){return t<-45&&t>-135?Tl.UP:t>45&&t<135?Tl.DOWN:t<=45&&t>=-45?Tl.RIGHT:Tl.LEFT},getSwipeEventData(t,e,i){return Object.assign(Object.assign({},i),{moveX:e.moveX,moveY:e.moveY,totalX:i.x-t.x,totalY:i.y-t.y,type:Nl.getSwipeDirection(gt.getAngle(t,i))})},getBase(t){const e=1===t.button?4:t.button;return{altKey:t.altKey,ctrlKey:t.ctrlKey,shiftKey:t.shiftKey,metaKey:t.metaKey,buttons:void 0===t.buttons?1:0===t.buttons?e:t.buttons,origin:t}},pathHasEventType(t,e){const{list:i}=t;for(let s=0,r=i.length;s<r;s++)if(i[s].hasEvent(e))return!0;return!1},filterPathByEventType(t,e){const i=new Ta,{list:s}=t;for(let r=0,n=s.length;r<n;r++)s[r].hasEvent(e)&&i.add(s[r]);return i}},Nl=Yl,zl=new Ta,{getDragEventData:Xl,getDropEventData:Hl,getSwipeEventData:Vl}=Yl;class Ul{constructor(t){this.interaction=t}setDragData(t){this.animateWait&&this.dragEndReal(),this.downData=this.interaction.downData,this.dragData=Xl(t,t,t),this.canAnimate=this.canDragOut=!0}getList(){const{proxy:t}=this.interaction.selector;return!this.dragging||t&&t.list.length?zl:Bl.list||this.dragableList||zl}checkDrag(t,e){const{interaction:i}=this;if(this.moving&&t.buttons<1)return this.canAnimate=!1,void i.pointerCancel();!this.moving&&e&&(this.moving=i.canMove(this.downData)||i.isHoldRightKey||i.isMobileDragEmpty)&&i.emit(Sl.START,this.dragData),this.moving||this.dragStart(t,e),this.drag(t)}dragStart(t,e){this.dragging||(this.dragging=e&&wl.left(t),this.dragging&&(this.interaction.emit(Bl.START,this.dragData),this.getDragableList(this.dragData.path),this.setDragStartPoints(this.realDragableList=this.getList())))}setDragStartPoints(t){this.dragStartPoints={},t.forEach((t=>this.dragStartPoints[t.innerId]={x:t.x,y:t.y}))}getDragableList(t){let e;for(let i=0,s=t.length;i<s;i++)if(e=t.list[i],(e.__.draggable||e.__.editable)&&e.__.hitSelf&&!e.__.locked){this.dragableList=new Ta(e);break}}drag(t){const{interaction:e,dragData:i,downData:s}=this,{path:r,throughPath:n}=s;this.dragData=Xl(s,i,t),n&&(this.dragData.throughPath=n),this.dragData.path=r,this.moving?(e.emit(Sl.BEFORE_MOVE,this.dragData),e.emit(Sl.MOVE,this.dragData)):this.dragging&&(this.dragReal(),e.emit(Bl.BEFORE_DRAG,this.dragData),e.emit(Bl.DRAG,this.dragData))}dragReal(){const{running:t}=this.interaction,e=this.realDragableList;if(e.length&&t){const{totalX:t,totalY:i}=this.dragData;e.forEach((e=>e.draggable&&e.move(Bl.getValidMove(e,this.dragStartPoints[e.innerId],{x:t,y:i}))))}}dragOverOrOut(t){const{interaction:e}=this,{dragOverPath:i}=this,{path:s}=t;this.dragOverPath=s,i?s.indexAt(0)!==i.indexAt(0)&&(e.emit(Bl.OUT,t,i),e.emit(Bl.OVER,t,s)):e.emit(Bl.OVER,t,s)}dragEnterOrLeave(t){const{interaction:e}=this,{dragEnterPath:i}=this,{path:s}=t;e.emit(Bl.LEAVE,t,i,s),e.emit(Bl.ENTER,t,s,i),this.dragEnterPath=s}dragEnd(t,e){if(!this.dragging&&!this.moving)return;const{moveX:i,moveY:s}=this.dragData;this.interaction.config.move.dragAnimate&&this.canAnimate&&this.moving&&(Math.abs(i)>1||Math.abs(s)>1)?(t=Object.assign({},t),e=.9*(e||("touch"===t.pointerType?2:1)),gt.move(t,i*e,s*e),this.drag(t),this.animate((()=>{this.dragEnd(t,1)}))):this.dragEndReal(t)}dragEndReal(t){const{interaction:e,downData:i,dragData:s}=this;t||(t=s);const{path:r,throughPath:n}=i,o=Xl(i,t,t);if(n&&(o.throughPath=n),o.path=r,this.moving&&(this.moving=!1,e.emit(Sl.END,o)),this.dragging){const r=this.getList();this.dragging=!1,e.emit(Bl.END,o),this.swipe(t,i,s,o),this.drop(t,r,this.dragEnterPath)}this.autoMoveCancel(),this.dragReset(),this.animate(null,"off")}animate(t,e){const i=t||this.animateWait;i&&this.interaction.target.nextRender(i,null,e),this.animateWait=t}swipe(t,e,i,s){const{interaction:r}=this;if(gt.getDistance(e,t)>r.config.pointer.swipeDistance){const t=Vl(e,i,s);this.interaction.emit(t.type,t)}}drop(t,e,i){const s=Hl(t,e,Bl.data);s.path=i,this.interaction.emit(Rl.DROP,s),this.interaction.emit(Bl.LEAVE,t,i)}dragReset(){Bl.list=Bl.data=this.dragableList=this.dragData=this.downData=this.dragOverPath=this.dragEnterPath=null}checkDragOut(t){const{interaction:e}=this;this.autoMoveCancel(),this.dragging&&!e.shrinkCanvasBounds.hitPoint(t)&&this.autoMoveOnDragOut(t)}autoMoveOnDragOut(t){const{interaction:e,downData:i,canDragOut:s}=this,{autoDistance:r,dragOut:n}=e.config.move;if(!n||!s||!r)return;const o=e.shrinkCanvasBounds,{x:a,y:h}=o,l=Yt.maxX(o),d=Yt.maxY(o),c=t.x<a?r:l<t.x?-r:0,u=t.y<h?r:d<t.y?-r:0;let p=0,_=0;this.autoMoveTimer=setInterval((()=>{p+=c,_+=u,gt.move(i,c,u),gt.move(this.dragData,c,u),e.move(Object.assign(Object.assign({},t),{moveX:c,moveY:u,totalX:p,totalY:_})),e.pointerMoveReal(t)}),10)}autoMoveCancel(){this.autoMoveTimer&&(clearInterval(this.autoMoveTimer),this.autoMoveTimer=0)}destroy(){this.dragReset()}}const Gl=ee.get("emit");function Kl(t,e,i,s){if(!i&&!e.path)return;let r;e.type=t,i?e=Object.assign(Object.assign({},e),{path:i}):i=e.path,e.target=i.indexAt(0);try{for(let n=i.length-1;n>-1;n--){if(r=i.list[n],Ql(r,t,e,!0,s))return;r.isApp&&ql(r,t,e,!0,s)}for(let n=0,o=i.length;n<o;n++)if(r=i.list[n],r.isApp&&ql(r,t,e,!1,s),Ql(r,t,e,!1,s))return}catch(n){Gl.error(n)}}const $l=["move","zoom","rotate","key"];function ql(t,e,i,s,r){if($l.some((t=>e.startsWith(t)))&&t.__.hitChildren&&!Zl(t,r)){let n;for(let o=0,a=t.children.length;o<a;o++)n=t.children[o],!i.path.has(n)&&n.__.hittable&&Ql(n,e,i,s,r)}}function Ql(t,e,i,s,r){if(t.destroyed)return!1;if(t.__.hitSelf&&!Zl(t,r)&&(Ya.updateEventStyle&&Ya.updateEventStyle(t,e),t.hasEvent(e,s))){i.phase=s?1:t===i.target?2:3;const r=ce.get(e,i);if(t.emitEvent(r,s),r.isStop)return!0}return!1}function Zl(t,e){return e&&e.has(t)}const Jl={getData(t){const e=t[0],i=t[1],s=gt.getCenter(e.from,i.from),r=gt.getCenter(e.to,i.to),n={x:r.x-s.x,y:r.y-s.y},o=gt.getDistance(e.from,i.from),a=gt.getDistance(e.to,i.to),h=a/o,l=gt.getRotation(e.from,i.from,e.to,i.to);return{move:n,scale:h,angle:l,center:r}}},td={wheel:{zoomSpeed:.5,moveSpeed:.5,rotateSpeed:.5,delta:{x:20,y:8},preventDefault:!0},pointer:{hitRadius:5,tapTime:120,longPressTime:800,transformTime:500,hover:!0,dragHover:!0,dragDistance:2,swipeDistance:20,preventDefaultMenu:!0},cursor:!0,keyEvent:!0},{pathHasEventType:ed,getMoveEventData:id,getZoomEventData:sd,getRotateEventData:rd}=Yl;class nd{get dragging(){return this.dragger.dragging}get moveMode(){return this.config.move.drag||this.isHoldSpaceKey||this.isHoldMiddleKey||this.isHoldRightKey&&this.dragger.moving||this.isDragEmpty}get isDragEmpty(){return this.config.move.dragEmpty&&this.isRootPath(this.hoverData)&&(!this.downData||this.isRootPath(this.downData))}get isMobileDragEmpty(){return this.config.move.dragEmpty&&!this.config.pointer.hover&&this.downData&&this.isTreePath(this.downData)}get isHoldMiddleKey(){return this.config.move.holdMiddleKey&&this.downData&&wl.middle(this.downData)}get isHoldRightKey(){return this.config.move.holdRightKey&&this.downData&&wl.right(this.downData)}get isHoldSpaceKey(){return this.config.move.holdSpaceKey&&vl.isHoldSpaceKey()}get hitRadius(){return this.config.pointer.hitRadius}constructor(t,e,i,s){this.config=td,this.tapCount=0,this.downKeyMap={},this.target=t,this.canvas=e,this.selector=i,this.defaultPath=new Ta(t),this.transformer=new Fl(this),this.dragger=new Ul(this),s&&(this.config=_e.default(s,this.config)),this.__listenEvents()}start(){this.running=!0}stop(){this.running=!1}receive(t){}pointerDown(t,e){t||(t=this.hoverData),t&&(wl.defaultLeft(t),this.updateDownData(t),this.checkPath(t,e),this.downTime=Date.now(),this.emit(kl.BEFORE_DOWN,t),this.emit(kl.DOWN,t),wl.left(t)&&(this.tapWait(),this.longPressWait(t)),this.waitMenuTap=wl.right(t),this.dragger.setDragData(t),this.isHoldRightKey||this.updateCursor(t))}pointerMove(t){if(t||(t=this.hoverData),!t)return;const{downData:e}=this;e&&wl.defaultLeft(t);const i=this.canvas.bounds.hitPoint(t);(i||e)&&(this.pointerMoveReal(t),e&&this.dragger.checkDragOut(t))}pointerMoveReal(t){const{dragHover:e,dragDistance:i}=this.config.pointer;if(this.emit(kl.BEFORE_MOVE,t,this.defaultPath),this.downData){const e=gt.getDistance(this.downData,t)>i;e&&(this.waitTap&&this.pointerWaitCancel(),this.waitMenuTap=!1),this.dragger.checkDrag(t,e)}this.dragger.moving||(this.updateHoverData(t),this.checkPath(t),this.emit(kl.MOVE,t),this.dragging&&!e||this.pointerHover(t),this.dragger.dragging&&(this.dragger.dragOverOrOut(t),this.dragger.dragEnterOrLeave(t))),this.updateCursor(this.downData||t)}pointerUp(t){const{downData:e}=this;if(t||(t=e),!e)return;wl.defaultLeft(t),this.findPath(t);const i=Object.assign(Object.assign({},t),{path:t.path.clone()});t.path.addList(e.path.list),this.checkPath(t),this.downData=null,this.emit(kl.BEFORE_UP,t),this.emit(kl.UP,t),this.touchLeave(t),t.isCancel||(this.tap(t),this.menuTap(t)),this.dragger.dragEnd(t),this.updateCursor(i)}pointerCancel(){const t=Object.assign({},this.dragger.dragData);t.isCancel=!0,this.pointerUp(t)}multiTouch(t,e){const{move:i,angle:s,scale:r,center:n}=Jl.getData(e);this.rotate(rd(n,s,t)),this.zoom(sd(n,r,t)),this.move(id(n,i,t))}menu(t){this.findPath(t),this.emit(kl.MENU,t)}menuTap(t){this.waitMenuTap&&this.emit(kl.MENU_TAP,t)}move(t){this.transformer.move(t)}zoom(t){this.transformer.zoom(t)}rotate(t){this.transformer.rotate(t)}transformEnd(){this.transformer.transformEnd()}keyDown(t){if(!this.config.keyEvent)return;const{code:e}=t;this.downKeyMap[e]||(this.downKeyMap[e]=!0,vl.setDownCode(e),this.emit(Ll.HOLD,t,this.defaultPath),this.moveMode&&(this.cancelHover(),this.updateCursor())),this.emit(Ll.DOWN,t,this.defaultPath)}keyUp(t){if(!this.config.keyEvent)return;const{code:e}=t;this.downKeyMap[e]=!1,vl.setUpCode(e),this.emit(Ll.UP,t,this.defaultPath),"grab"===this.cursor&&this.updateCursor()}pointerHover(t){this.config.pointer.hover&&(this.pointerOverOrOut(t),this.pointerEnterOrLeave(t))}pointerOverOrOut(t){const{path:e}=t,{overPath:i}=this;this.overPath=e,i?e.indexAt(0)!==i.indexAt(0)&&(this.emit(kl.OUT,t,i),this.emit(kl.OVER,t,e)):this.emit(kl.OVER,t,e)}pointerEnterOrLeave(t){let{path:e}=t;this.downData&&!this.moveMode&&(e=e.clone(),this.downData.path.forEach((t=>e.add(t))));const{enterPath:i}=this;this.enterPath=e,this.emit(kl.LEAVE,t,i,e),this.emit(kl.ENTER,t,e,i)}touchLeave(t){"touch"===t.pointerType&&this.enterPath&&(this.emit(kl.LEAVE,t),this.dragger.dragging&&this.emit(Rl.LEAVE,t))}tap(t){const{pointer:e}=this.config,i=this.longTap(t);if(!e.tapMore&&i)return;if(!this.waitTap)return;e.tapMore&&this.emitTap(t);const s=Date.now()-this.downTime,r=[kl.DOUBLE_TAP,kl.DOUBLE_CLICK].some((e=>ed(t.path,e)));s<e.tapTime+50&&r?(this.tapCount++,2===this.tapCount?(this.tapWaitCancel(),this.emitDoubleTap(t)):(clearTimeout(this.tapTimer),this.tapTimer=setTimeout((()=>{e.tapMore||(this.tapWaitCancel(),this.emitTap(t))}),e.tapTime))):e.tapMore||(this.tapWaitCancel(),this.emitTap(t))}findPath(t,e){const{hitRadius:i,through:s}=this.config.pointer,{bottomList:r}=this,n=this.selector.getByPoint(t,i,Object.assign({bottomList:r,name:t.type},e||{through:s}));return n.throughPath&&(t.throughPath=n.throughPath),t.path=n.path,n.path}isRootPath(t){return t&&t.path.list[0].isLeafer}isTreePath(t){const e=this.target.app;return!(!e||!e.isApp)&&(e.editor&&!t.path.has(e.editor)&&t.path.has(e.tree)&&!t.target.syncEventer)}checkPath(t,e){(e||this.canMove(t))&&(t.path=this.defaultPath)}canMove(t){return this.moveMode&&t&&t.path.list.every((t=>!t.isOutside))}isDrag(t){return this.dragger.getList().has(t)}isPress(t){return this.downData&&this.downData.path.has(t)}isHover(t){return this.enterPath&&this.enterPath.has(t)}isFocus(t){return this.focusData===t}cancelHover(){const{hoverData:t}=this;t&&(t.path=this.defaultPath,this.pointerHover(t))}updateDownData(t,e,i){const{downData:s}=this;!t&&s&&(t=s),t&&(this.findPath(t,e),i&&s&&t.path.addList(s.path.list),this.downData=t)}updateHoverData(t){t||(t=this.hoverData),t&&(this.findPath(t,{exclude:this.dragger.getList(),name:kl.MOVE}),this.hoverData=t)}updateCursor(t){if(!this.config.cursor||!this.config.pointer.hover)return;if(t||(this.updateHoverData(),t=this.downData||this.hoverData),this.dragger.moving)return this.setCursor("grabbing");if(this.canMove(t))return this.setCursor(this.downData?"grabbing":"grab");if(!t)return;let e,i;const{path:s}=t;for(let r=0,n=s.length;r<n;r++)if(e=s.list[r],i=e.syncEventer?e.syncEventer.cursor:e.cursor,i)break;this.setCursor(i)}setCursor(t){this.cursor=t}getLocal(t,e){const i=this.canvas.getClientBounds(e);return{x:t.clientX-i.x,y:t.clientY-i.y}}emitTap(t){this.emit(kl.TAP,t),this.emit(kl.CLICK,t)}emitDoubleTap(t){this.emit(kl.DOUBLE_TAP,t),this.emit(kl.DOUBLE_CLICK,t)}pointerWaitCancel(){this.tapWaitCancel(),this.longPressWaitCancel()}tapWait(){clearTimeout(this.tapTimer),this.waitTap=!0}tapWaitCancel(){clearTimeout(this.tapTimer),this.waitTap=!1,this.tapCount=0}longPressWait(t){clearTimeout(this.longPressTimer),this.longPressTimer=setTimeout((()=>{this.longPressed=!0,this.emit(kl.LONG_PRESS,t)}),this.config.pointer.longPressTime)}longTap(t){let e;return this.longPressed&&(this.emit(kl.LONG_TAP,t),(ed(t.path,kl.LONG_TAP)||ed(t.path,kl.LONG_PRESS))&&(e=!0)),this.longPressWaitCancel(),e}longPressWaitCancel(){clearTimeout(this.longPressTimer),this.longPressed=!1}__onResize(){this.shrinkCanvasBounds=new Ht(this.canvas.bounds),this.shrinkCanvasBounds.spread(-2)}__listenEvents(){const{target:t}=this;this.__eventIds=[t.on_(Bo.RESIZE,this.__onResize,this)],t.once(Po.READY,(()=>this.__onResize()))}__removeListenEvents(){this.target.off_(this.__eventIds),this.__eventIds.length=0}emit(t,e,i,s){this.running&&Kl(t,e,i,s)}destroy(){this.__eventIds.length&&(this.stop(),this.__removeListenEvents(),this.dragger.destroy(),this.transformer.destroy(),this.downData=this.overPath=this.enterPath=null)}}class od{static set(t,e){this.custom[t]=e}static get(t){return this.custom[t]}}od.custom={};class ad extends pe{constructor(){super(...arguments),this.maxTotal=1e3,this.pathList=new Ta,this.pixelList=new Ta}getPixelType(t,e){return this.__autoClear(),this.pixelList.add(t),F.hitCanvas(e)}getPathType(t){return this.__autoClear(),this.pathList.add(t),F.hitCanvas()}clearImageType(){this.__clearLeafList(this.pixelList)}clearPathType(){this.__clearLeafList(this.pathList)}__clearLeafList(t){t.length&&(t.forEach((t=>{t.__hitCanvas&&(t.__hitCanvas.destroy(),t.__hitCanvas=null)})),t.reset())}__autoClear(){this.pathList.length+this.pixelList.length>this.maxTotal&&this.clear()}clear(){this.clearPathType(),this.clearImageType()}}const{toInnerRadiusPointOf:hd,copy:ld,setRadius:dd}=gt,cd={},ud=xa.prototype;ud.__hitWorld=function(t){if(!this.__.hitSelf)return!1;this.__.hitRadius&&(ld(cd,t),t=cd,dd(t,this.__.hitRadius)),hd(t,this.__world,cd);const{width:e,height:i}=this.__world,s=e<10&&i<10;if(this.__.hitBox||s){if(Yt.hitRadiusPoint(this.__layout.boxBounds,cd))return!0;if(s)return!1}return!this.__layout.hitCanvasChanged&&this.__hitCanvas||(this.__updateHitCanvas(),this.__layout.boundsChanged||(this.__layout.hitCanvasChanged=!1)),this.__hit(cd)},ud.__hitFill=function(t){var e;return null===(e=this.__hitCanvas)||void 0===e?void 0:e.hitFill(t,this.__.windingRule)},ud.__hitStroke=function(t,e){var i;return null===(i=this.__hitCanvas)||void 0===i?void 0:i.hitStroke(t,e)},ud.__hitPixel=function(t){var e;return null===(e=this.__hitCanvas)||void 0===e?void 0:e.hitPixel(t,this.__layout.renderBounds,this.__hitCanvas.hitScale)},ud.__drawHitPath=function(t){t&&this.__drawRenderPath(t)};const pd=new bt,_d=fh.prototype;_d.__updateHitCanvas=function(){const t=this.__,{hitCanvasManager:e}=this.leafer,i=(t.__pixelFill||t.__isCanvas)&&"pixel"===t.hitFill,s=t.__pixelStroke&&"pixel"===t.hitStroke,r=i||s;this.__hitCanvas||(this.__hitCanvas=r?e.getPixelType(this,{contextSettings:{willReadFrequently:!0}}):e.getPathType(this));const n=this.__hitCanvas;if(r){const{renderBounds:e}=this.__layout,r=j.image.hitCanvasSize,o=n.hitScale=Vt.set(0,0,r,r).getFitMatrix(e,.5).a,{x:a,y:h,width:l,height:d}=Vt.set(e).scale(o);n.resize({width:l,height:d,pixelRatio:1}),n.clear(),Ur.patternLocked=!0,this.__renderShape(n,{matrix:pd.setWith(this.__world).scaleWith(1/o).invertWith().translate(-a,-h)},!i,!s),Ur.patternLocked=!1,n.resetTransform(),t.__isHitPixel=!0}else t.__isHitPixel&&(t.__isHitPixel=!1);this.__drawHitPath(n),n.setStrokeOptions(t)},_d.__hit=function(t){"miniapp"===j.name&&this.__drawHitPath(this.__hitCanvas);const e=this.__;if(e.__isHitPixel&&this.__hitPixel(t))return!0;const{hitFill:i}=e,s=(e.fill||e.__isCanvas)&&("path"===i||"pixel"===i&&!(e.__pixelFill||e.__isCanvas))||"all"===i;if(s&&this.__hitFill(t))return!0;const{hitStroke:r,__strokeWidth:n}=e,o=e.stroke&&("path"===r||"pixel"===r&&!e.__pixelStroke)||"all"===r;if(!s&&!o)return!1;const a=2*t.radiusX;let h=a;if(o)switch(e.strokeAlign){case"inside":if(h+=2*n,!s&&this.__hitFill(t)&&this.__hitStroke(t,h))return!0;h=a;break;case"center":h+=n;break;case"outside":if(h+=2*n,!s){if(!this.__hitFill(t)&&this.__hitStroke(t,h))return!0;h=a}break}return!!h&&this.__hitStroke(t,h)};const yd=new fh,gd=bh.prototype;gd.__updateHitCanvas=function(){this.stroke||this.cornerRadius||(this.fill||this.__.__isCanvas)&&"pixel"===this.hitFill||"all"===this.hitStroke?yd.__updateHitCanvas.call(this):this.__hitCanvas&&(this.__hitCanvas=null)},gd.__hitFill=function(t){return this.__hitCanvas?yd.__hitFill.call(this,t):Yt.hitRadiusPoint(this.__layout.boxBounds,t)};const fd=fh.prototype,md=mh.prototype;fd.find=function(t,e){return this.leafer?this.leafer.selector.getBy(t,this,!1,e):[]},fd.findOne=function(t,e){return this.leafer?this.leafer.selector.getBy(t,this,!0,e):null},md.pick=function(t,e){return this.__layout.update(),e||(e={}),this.leafer?this.leafer.selector.getByPoint(t,e.hitRadius||0,Object.assign(Object.assign({},e),{target:this})):null};const xd=Ee.prototype;xd.hitFill=function(t,e){return e?this.context.isPointInPath(t.x,t.y,e):this.context.isPointInPath(t.x,t.y)},xd.hitStroke=function(t,e){return this.strokeWidth=e,this.context.isPointInStroke(t.x,t.y)},xd.hitPixel=function(t,e,i=1){let{x:s,y:r,radiusX:n,radiusY:o}=t;e&&(s-=e.x,r-=e.y),Vt.set(s-n,r-o,2*n,2*o).scale(i).ceil();const{data:a}=this.context.getImageData(Vt.x,Vt.y,Vt.width||1,Vt.height||1);for(let h=0,l=a.length;h<l;h+=4)if(a[h+3]>0)return!0;return a[3]>0};const vd=ee.get("LeaferCanvas");class wd extends Ee{set zIndex(t){const{style:e}=this.view;e.zIndex=t,this.setAbsolute(this.view)}set childIndex(t){const{view:e,parentView:i}=this;if(e&&i){const s=i.children[t];s?(this.setAbsolute(s),i.insertBefore(e,s)):i.appendChild(s)}}init(){const{view:t}=this.config;t?this.__createViewFrom(t):this.__createView();const{style:e}=this.view;if(e.display||(e.display="block"),this.parentView=this.view.parentElement,this.parentView){const t=this.parentView.style;t.webkitUserSelect=t.userSelect="none"}j.syncDomFont&&!this.parentView&&(e.display="none",document.body.appendChild(this.view)),this.__createContext(),this.autoLayout||this.resize(this.config)}set backgroundColor(t){this.view.style.backgroundColor=t}get backgroundColor(){return this.view.style.backgroundColor}set hittable(t){this.view.style.pointerEvents=t?"auto":"none"}get hittable(){return"none"!==this.view.style.pointerEvents}__createView(){this.view=document.createElement("canvas")}__createViewFrom(t){let e="string"===typeof t?document.getElementById(t):t;if(e)if(e instanceof HTMLCanvasElement)this.view=e;else{let t=e;if(e===window||e===document){const e=document.createElement("div"),{style:i}=e;i.position="absolute",i.top=i.bottom=i.left=i.right="0px",document.body.appendChild(e),t=e}this.__createView();const i=this.view;t.hasChildNodes()&&(this.setAbsolute(i),t.style.position||(t.style.position="relative")),t.appendChild(i)}else vd.error(`no id: ${t}`),this.__createView()}setAbsolute(t){const{style:e}=t;e.position="absolute",e.top=e.left="0px"}updateViewSize(){const{width:t,height:e,pixelRatio:i}=this,{style:s}=this.view;s.width=t+"px",s.height=e+"px",this.view.width=Math.ceil(t*i),this.view.height=Math.ceil(e*i)}updateClientBounds(){this.clientBounds=this.view.getBoundingClientRect()}startAutoLayout(t,e){this.autoBounds=t,this.resizeListener=e;try{this.resizeObserver=new ResizeObserver((t=>{this.updateClientBounds();for(const e of t)this.checkAutoBounds(e.contentRect)}));const t=this.parentView;t?(this.resizeObserver.observe(t),this.checkAutoBounds(t.getBoundingClientRect())):(this.checkAutoBounds(this.view),vd.warn("no parent"))}catch(i){this.imitateResizeObserver()}}imitateResizeObserver(){this.autoLayout&&(this.parentView&&this.checkAutoBounds(this.parentView.getBoundingClientRect()),j.requestRender(this.imitateResizeObserver.bind(this)))}checkAutoBounds(t){const e=this.view,{x:i,y:s,width:r,height:n}=this.autoBounds.getBoundsFrom(t);if(r!==this.width||n!==this.height){const{style:t}=e,{pixelRatio:o}=this;t.marginLeft=i+"px",t.marginTop=s+"px";const a={width:r,height:n,pixelRatio:o},h={};_e.copyAttrs(h,this,Se),this.resize(a),void 0!==this.width&&this.resizeListener(new Bo(a,h))}}stopAutoLayout(){this.autoLayout=!1,this.resizeListener=null,this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null)}unrealCanvas(){if(!this.unreal&&this.parentView){const t=this.view;t&&t.remove(),this.view=this.parentView,this.unreal=!0}}destroy(){if(this.view){if(this.stopAutoLayout(),!this.unreal){const t=this.view;t.parentElement&&t.remove()}super.destroy()}}}Yr(CanvasRenderingContext2D.prototype),Yr(Path2D.prototype);const{mineType:bd,fileType:kd}=Nr;function Cd(t,e){j.origin={createCanvas(t,e){const i=document.createElement("canvas");return i.width=t,i.height=e,i},canvasToDataURL:(t,e,i)=>t.toDataURL(bd(e),i),canvasToBolb:(t,e,i)=>new Promise((s=>t.toBlob(s,bd(e),i))),canvasSaveAs:(t,e,i)=>{const s=t.toDataURL(bd(kd(e)),i);return j.origin.download(s,e)},download(t,e){return new Promise((i=>{let s=document.createElement("a");s.href=t,s.download=e,document.body.appendChild(s),s.click(),document.body.removeChild(s),i()}))},loadImage(t){return new Promise(((e,i)=>{const s=new Image,{crossOrigin:r}=j.image;r&&(s.setAttribute("crossOrigin",r),s.crossOrigin=r),s.onload=()=>{e(s)},s.onerror=t=>{i(t)},s.src=j.image.getRealURL(t)}))}},j.event={stopDefault(t){t.preventDefault()},stopNow(t){t.stopImmediatePropagation()},stop(t){t.stopPropagation()}},j.canvas=F.canvas(),j.conicGradientSupport=!!j.canvas.context.createConicGradient}Object.assign(F,{canvas:(t,e)=>new wd(t,e),image:t=>new qr(t)}),j.name="web",j.isMobile="ontouchstart"in window,j.requestRender=function(t){window.requestAnimationFrame(t)},j.devicePixelRatio=Math.max(1,devicePixelRatio);const{userAgent:Bd}=navigator;Bd.indexOf("Firefox")>-1?(j.conicGradientRotate90=!0,j.intWheelDeltaY=!0,j.syncDomFont=!0):Bd.indexOf("Safari")>-1&&-1===Bd.indexOf("Chrome")&&(j.fullImageShadow=!0),Bd.indexOf("Windows")>-1?(j.os="Windows",j.intWheelDeltaY=!0):Bd.indexOf("Mac")>-1?j.os="Mac":Bd.indexOf("Linux")>-1&&(j.os="Linux");class Rd{get childrenChanged(){return this.hasAdd||this.hasRemove||this.hasVisible}get updatedList(){if(this.hasRemove){const t=new Ta;return this.__updatedList.list.forEach((e=>{e.leafer&&t.add(e)})),t}return this.__updatedList}constructor(t,e){this.totalTimes=0,this.config={},this.__updatedList=new Ta,this.target=t,e&&(this.config=_e.default(e,this.config)),this.__listenEvents()}start(){this.disabled||(this.running=!0)}stop(){this.running=!1}disable(){this.stop(),this.__removeListenEvents(),this.disabled=!0}update(){this.changed=!0,this.running&&this.target.emit(To.REQUEST)}__onAttrChange(t){this.__updatedList.add(t.target),this.update()}__onChildEvent(t){t.type===bo.ADD?(this.hasAdd=!0,this.__pushChild(t.child)):(this.hasRemove=!0,this.__updatedList.add(t.parent)),this.update()}__pushChild(t){this.__updatedList.add(t),t.isBranch&&this.__loopChildren(t)}__loopChildren(t){const{children:e}=t;for(let i=0,s=e.length;i<s;i++)this.__pushChild(e[i])}__onRquestData(){this.target.emitEvent(new Ro(Ro.DATA,{updatedList:this.updatedList})),this.__updatedList=new Ta,this.totalTimes++,this.changed=!1,this.hasVisible=!1,this.hasRemove=!1,this.hasAdd=!1}__listenEvents(){const{target:t}=this;this.__eventIds=[t.on_(ko.CHANGE,this.__onAttrChange,this),t.on_([bo.ADD,bo.REMOVE],this.__onChildEvent,this),t.on_(Ro.REQUEST,this.__onRquestData,this)]}__removeListenEvents(){this.target.off_(this.__eventIds)}destroy(){this.target&&(this.stop(),this.__removeListenEvents(),this.target=null,this.__updatedList=null)}}const{updateAllMatrix:Sd,updateBounds:Ed,updateAllWorldOpacity:Td}=Gn,{pushAllChildBranch:Pd,pushAllParent:Ld}=so;function Od(t,e){let i;t.list.forEach((t=>{i=t.__layout,e.without(t)&&!i.proxyZoom&&(i.matrixChanged?(Sd(t,!0),e.add(t),t.isBranch&&Pd(t,e),Ld(t,e)):i.boundsChanged&&(e.add(t),t.isBranch&&(t.__tempNumber=0),Ld(t,e)))}))}function Md(t){let e,i,s;t.sort(!0),t.levels.forEach((r=>{e=t.levelMap[r];for(let t=0,n=e.length;t<n;t++){if(i=e[t],i.isBranch&&i.__tempNumber){s=i.children;for(let t=0,e=s.length;t<e;t++)s[t].isBranch||Ed(s[t])}Ed(i)}}))}function Dd(t){t.list.forEach((t=>{t.__layout.opacityChanged&&Td(t),t.__updateChange()}))}const{worldBounds:Ad}=eo,Id={x:0,y:0,width:1e5,height:1e5};class Wd{constructor(t){this.updatedBounds=new Ht,this.beforeBounds=new Ht,this.afterBounds=new Ht,t instanceof Array&&(t=new Ta(t)),this.updatedList=t}setBefore(){this.beforeBounds.setListWithFn(this.updatedList.list,Ad)}setAfter(){const{list:t}=this.updatedList;t.some((t=>t.noBounds))?this.afterBounds.set(Id):this.afterBounds.setListWithFn(t,Ad),this.updatedBounds.setList([this.beforeBounds,this.afterBounds])}merge(t){this.updatedList.addList(t.updatedList.list),this.beforeBounds.add(t.beforeBounds),this.afterBounds.add(t.afterBounds),this.updatedBounds.add(t.updatedBounds)}destroy(){this.updatedList=null}}const{updateAllMatrix:jd,updateAllChange:Fd}=Gn,Yd=ee.get("Layouter");class Nd{constructor(t,e){this.totalTimes=0,this.config={},this.__levelList=new Pa,this.target=t,e&&(this.config=_e.default(e,this.config)),this.__listenEvents()}start(){this.disabled||(this.running=!0)}stop(){this.running=!1}disable(){this.stop(),this.__removeListenEvents(),this.disabled=!0}layout(){if(!this.running)return;const{target:t}=this;this.times=0;try{t.emit(So.START),this.layoutOnce(),t.emitEvent(new So(So.END,this.layoutedBlocks,this.times))}catch(e){Yd.error(e)}this.layoutedBlocks=null}layoutAgain(){this.layouting?this.waitAgain=!0:this.layoutOnce()}layoutOnce(){return this.layouting?Yd.warn("layouting"):this.times>3?Yd.warn("layout max times"):(this.times++,this.totalTimes++,this.layouting=!0,this.target.emit(Ro.REQUEST),this.totalTimes>1?this.partLayout():this.fullLayout(),this.layouting=!1,void(this.waitAgain&&(this.waitAgain=!1,this.layoutOnce())))}partLayout(){var t;if(!(null===(t=this.__updatedList)||void 0===t?void 0:t.length))return;const e=ne.start("PartLayout"),{target:i,__updatedList:s}=this,{BEFORE:r,LAYOUT:n,AFTER:o}=So,a=this.getBlocks(s);a.forEach((t=>t.setBefore())),i.emitEvent(new So(r,a,this.times)),this.extraBlock=null,s.sort(),Od(s,this.__levelList),Md(this.__levelList),Dd(s),this.extraBlock&&a.push(this.extraBlock),a.forEach((t=>t.setAfter())),i.emitEvent(new So(n,a,this.times)),i.emitEvent(new So(o,a,this.times)),this.addBlocks(a),this.__levelList.reset(),this.__updatedList=null,ne.end(e)}fullLayout(){const t=ne.start("FullLayout"),{target:e}=this,{BEFORE:i,LAYOUT:s,AFTER:r}=So,n=this.getBlocks(new Ta(e));e.emitEvent(new So(i,n,this.times)),Nd.fullLayout(e),n.forEach((t=>{t.setAfter()})),e.emitEvent(new So(s,n,this.times)),e.emitEvent(new So(r,n,this.times)),this.addBlocks(n),ne.end(t)}static fullLayout(t){jd(t,!0),t.isBranch?so.updateBounds(t):Gn.updateBounds(t),Fd(t)}addExtra(t){if(!this.__updatedList.has(t)){const{updatedList:e,beforeBounds:i}=this.extraBlock||(this.extraBlock=new Wd([]));e.length?i.add(t.__world):i.set(t.__world),e.add(t)}}createBlock(t){return new Wd(t)}getBlocks(t){return[this.createBlock(t)]}addBlocks(t){this.layoutedBlocks?this.layoutedBlocks.push(...t):this.layoutedBlocks=t}__onReceiveWatchData(t){this.__updatedList=t.data.updatedList}__listenEvents(){const{target:t}=this;this.__eventIds=[t.on_(So.REQUEST,this.layout,this),t.on_(So.AGAIN,this.layoutAgain,this),t.on_(Ro.DATA,this.__onReceiveWatchData,this)]}__removeListenEvents(){this.target.off_(this.__eventIds)}destroy(){this.target&&(this.stop(),this.__removeListenEvents(),this.target=this.config=null)}}const zd=ee.get("Renderer");class Xd{get needFill(){return!(this.canvas.allowBackgroundColor||!this.config.fill)}constructor(t,e,i){this.FPS=60,this.totalTimes=0,this.times=0,this.config={usePartRender:!0,maxFPS:60},this.target=t,this.canvas=e,i&&(this.config=_e.default(i,this.config)),this.__listenEvents(),this.__requestRender()}start(){this.running=!0}stop(){this.running=!1}update(){this.changed=!0}requestLayout(){this.target.emit(So.REQUEST)}render(t){if(!this.running||!this.canvas.view)return void(this.changed=!0);const{target:e}=this;this.times=0,this.totalBounds=new Ht,zd.log(e.innerName,"---\x3e");try{this.emitRender(To.START),this.renderOnce(t),this.emitRender(To.END,this.totalBounds),Ur.clearRecycled()}catch(i){this.rendering=!1,zd.error(i)}zd.log("-------------|")}renderAgain(){this.rendering?this.waitAgain=!0:this.renderOnce()}renderOnce(t){if(this.rendering)return zd.warn("rendering");if(this.times>3)return zd.warn("render max times");if(this.times++,this.totalTimes++,this.rendering=!0,this.changed=!1,this.renderBounds=new Ht,this.renderOptions={},t)this.emitRender(To.BEFORE),t();else{if(this.requestLayout(),this.ignore)return void(this.ignore=this.rendering=!1);this.emitRender(To.BEFORE),this.config.usePartRender&&this.totalTimes>1?this.partRender():this.fullRender()}this.emitRender(To.RENDER,this.renderBounds,this.renderOptions),this.emitRender(To.AFTER,this.renderBounds,this.renderOptions),this.updateBlocks=null,this.rendering=!1,this.waitAgain&&(this.waitAgain=!1,this.renderOnce())}partRender(){const{canvas:t,updateBlocks:e}=this;if(!e)return zd.warn("PartRender: need update attr");this.mergeBlocks(),e.forEach((e=>{t.bounds.hit(e)&&!e.isEmpty()&&this.clipRender(e)}))}clipRender(t){const e=ne.start("PartRender"),{canvas:i}=this,s=t.getIntersect(i.bounds),r=t.includes(this.target.__world),n=new Ht(s);i.save(),r&&!ee.showRepaint?i.clear():(s.spread(10+1/this.canvas.pixelRatio).ceil(),i.clearWorld(s,!0),i.clipWorld(s,!0)),this.__render(s,r,n),i.restore(),ne.end(e)}fullRender(){const t=ne.start("FullRender"),{canvas:e}=this;e.save(),e.clear(),this.__render(e.bounds,!0),e.restore(),ne.end(t)}__render(t,e,i){const s=t.includes(this.target.__world)?{includes:e}:{bounds:t,includes:e};this.needFill&&this.canvas.fillWorld(t,this.config.fill),ee.showRepaint&&this.canvas.strokeWorld(t,"red"),this.target.__render(this.canvas,s),this.renderBounds=i||t,this.renderOptions=s,this.totalBounds.isEmpty()?this.totalBounds=this.renderBounds:this.totalBounds.add(this.renderBounds),ee.showHitView&&this.renderHitView(s),ee.showBoundsView&&this.renderBoundsView(s),this.canvas.updateRender()}renderHitView(t){}renderBoundsView(t){}addBlock(t){this.updateBlocks||(this.updateBlocks=[]),this.updateBlocks.push(t)}mergeBlocks(){const{updateBlocks:t}=this;if(t){const e=new Ht;e.setList(t),t.length=0,t.push(e)}}__requestRender(){const t=Date.now();j.requestRender((()=>{this.FPS=Math.min(60,Math.ceil(1e3/(Date.now()-t))),this.running&&(this.target.emit(Eo.FRAME),this.changed&&this.canvas.view&&this.render(),this.target.emit(To.NEXT)),this.target&&this.__requestRender()}))}__onResize(t){if(!this.canvas.unreal){if(t.bigger||!t.samePixelRatio){const{width:e,height:i}=t.old,s=new Ht(0,0,e,i);if(!s.includes(this.target.__world)||this.needFill||!t.samePixelRatio)return this.addBlock(this.canvas.bounds),void this.target.forceUpdate("surface")}this.addBlock(new Ht(0,0,1,1)),this.changed=!0}}__onLayoutEnd(t){t.data&&t.data.map((t=>{let e;t.updatedList&&t.updatedList.list.some((t=>(e=!t.__world.width||!t.__world.height,e&&(t.isLeafer||zd.tip(t.innerName,": empty"),e=!t.isBranch||t.isBranchLeaf),e))),this.addBlock(e?this.canvas.bounds:t.updatedBounds)}))}emitRender(t,e,i){this.target.emitEvent(new To(t,this.times,e,i))}__listenEvents(){const{target:t}=this;this.__eventIds=[t.on_(To.REQUEST,this.update,this),t.on_(So.END,this.__onLayoutEnd,this),t.on_(To.AGAIN,this.renderAgain,this),t.on_(Bo.RESIZE,this.__onResize,this)]}__removeListenEvents(){this.target.off_(this.__eventIds)}destroy(){this.target&&(this.stop(),this.__removeListenEvents(),this.target=this.canvas=this.config=null)}}const{hitRadiusPoint:Hd}=Yt;class Vd{constructor(t,e){this.target=t,this.selector=e}getByPoint(t,e,i){e||(e=0),i||(i={});const s=i.through||!1,r=i.ignoreHittable||!1,n=i.target||this.target;this.exclude=i.exclude||null,this.point={x:t.x,y:t.y,radiusX:e,radiusY:e},this.findList=new Ta(i.findList),i.findList||this.hitBranch(n);const{list:o}=this.findList,a=this.getBestMatchLeaf(o,i.bottomList,r),h=r?this.getPath(a):this.getHitablePath(a);return this.clear(),s?{path:h,target:a,throughPath:o.length?this.getThroughPath(o):h}:{path:h,target:a}}getBestMatchLeaf(t,e,i){if(t.length){let e;this.findList=new Ta;const{x:s,y:r}=this.point,n={x:s,y:r,radiusX:0,radiusY:0};for(let o=0,a=t.length;o<a;o++)if(e=t[o],(i||Gn.worldHittable(e))&&(this.hitChild(e,n),this.findList.length))return this.findList.list[0]}if(e)for(let s=0,r=e.length;s<r;s++)if(this.hitChild(e[s].target,this.point,e[s].proxy),this.findList.length)return this.findList.list[0];return t[0]}getPath(t){const e=new Ta;while(t)e.add(t),t=t.parent;return e.add(this.target),e}getHitablePath(t){const e=this.getPath(t&&t.hittable?t:null);let i,s=new Ta;for(let r=e.list.length-1;r>-1;r--){if(i=e.list[r],!i.__.hittable)break;if(s.addAt(i,0),!i.__.hitChildren)break}return s}getThroughPath(t){const e=new Ta,i=[];for(let o=t.length-1;o>-1;o--)i.push(this.getPath(t[o]));let s,r,n;for(let o=0,a=i.length;o<a;o++){s=i[o],r=i[o+1];for(let t=0,i=s.length;t<i;t++){if(n=s.list[t],r&&r.has(n))break;e.add(n)}}return e}hitBranch(t){this.eachFind(t.children,t.__onlyHitMask)}eachFind(t,e){let i,s;const{point:r}=this,n=t.length;for(let o=n-1;o>-1;o--)i=t[o],!i.__.visible||e&&!i.__.mask||(s=!!i.__.hitRadius||Hd(i.__world,r),i.isBranch?(s||i.__ignoreHitWorld)&&(this.eachFind(i.children,i.__onlyHitMask),i.isBranchLeaf&&!this.findList.length&&this.hitChild(i,r)):s&&this.hitChild(i,r))}hitChild(t,e,i){if((!this.exclude||!this.exclude.has(t))&&t.__hitWorld(e)){const{parent:s}=t;if(s&&s.__hasMask&&!t.__.mask&&!s.children.some((t=>t.__.mask&&t.__hitWorld(e))))return;this.findList.add(i||t)}}clear(){this.point=null,this.findList=null,this.exclude=null}destroy(){this.clear()}}const{Yes:Ud,NoAndSkip:Gd,YesAndSkip:Kd}=fe,$d={},qd={},Qd={};class Zd{constructor(t,e){this.config={},this.innerIdMap={},this.idMap={},this.methods={id:(t,e)=>t.id===e?(this.idMap[e]=t,1):0,innerId:(t,e)=>t.innerId===e?(this.innerIdMap[e]=t,1):0,className:(t,e)=>t.className===e?1:0,tag:(t,e)=>t.__tag===e?1:0,tags:(t,e)=>e[t.__tag]?1:0},this.target=t,e&&(this.config=_e.default(e,this.config)),this.picker=new Vd(t,this),this.__listenEvents()}getBy(t,e,i,s){switch(typeof t){case"number":const r=this.getByInnerId(t,e);return i?r:r?[r]:[];case"string":switch(t[0]){case"#":$d.id=t.substring(1),t=$d;break;case".":qd.className=t.substring(1),t=qd;break;default:Qd.tag=t,t=Qd}case"object":if(void 0!==t.id){const s=this.getById(t.id,e);return i?s:s?[s]:[]}if(t.tag){const{tag:s}=t,r=s instanceof Array;return this.getByMethod(r?this.methods.tags:this.methods.tag,e,i,r?_e.toMap(s):s)}return this.getByMethod(this.methods.className,e,i,t.className);case"function":return this.getByMethod(t,e,i,s)}}getByPoint(t,e,i){return"node"===j.name&&this.target.emit(So.CHECK_UPDATE),this.picker.getByPoint(t,e,i)}getByInnerId(t,e){const i=this.innerIdMap[t];return i||(this.eachFind(this.toChildren(e),this.methods.innerId,null,t),this.findLeaf)}getById(t,e){const i=this.idMap[t];return i&&Gn.hasParent(i,e||this.target)?i:(this.eachFind(this.toChildren(e),this.methods.id,null,t),this.findLeaf)}getByClassName(t,e){return this.getByMethod(this.methods.className,e,!1,t)}getByTag(t,e){return this.getByMethod(this.methods.tag,e,!1,t)}getByMethod(t,e,i,s){const r=i?null:[];return this.eachFind(this.toChildren(e),t,r,s),r||this.findLeaf}eachFind(t,e,i,s){let r,n;for(let o=0,a=t.length;o<a;o++){if(r=t[o],n=e(r,s),n===Ud||n===Kd){if(!i)return void(this.findLeaf=r);i.push(r)}r.isBranch&&n<Gd&&this.eachFind(r.children,e,i,s)}}toChildren(t){return this.findLeaf=null,[t||this.target]}__onRemoveChild(t){const{id:e,innerId:i}=t.child;this.idMap[e]&&delete this.idMap[e],this.innerIdMap[i]&&delete this.innerIdMap[i]}__checkIdChange(t){if("id"===t.attrName){const e=t.oldValue;this.idMap[e]&&delete this.idMap[e]}}__listenEvents(){this.__eventIds=[this.target.on_(bo.REMOVE,this.__onRemoveChild,this),this.target.on_(ko.CHANGE,this.__checkIdChange,this)]}__removeListenEvents(){this.target.off_(this.__eventIds),this.__eventIds.length=0}destroy(){this.__eventIds.length&&(this.__removeListenEvents(),this.picker.destroy(),this.findLeaf=null,this.innerIdMap={},this.idMap={})}}Object.assign(F,{watcher:(t,e)=>new Rd(t,e),layouter:(t,e)=>new Nd(t,e),renderer:(t,e,i)=>new Xd(t,e,i),selector:(t,e)=>new Zd(t,e)}),j.layout=Nd.fullLayout;const Jd={convert(t,e){const i=Yl.getBase(t),s=Object.assign(Object.assign({},i),{x:e.x,y:e.y,width:t.width,height:t.height,pointerType:t.pointerType,pressure:t.pressure});return"pen"===s.pointerType&&(s.tangentialPressure=t.tangentialPressure,s.tiltX=t.tiltX,s.tiltY=t.tiltY,s.twist=t.twist),s},convertMouse(t,e){const i=Yl.getBase(t);return Object.assign(Object.assign({},i),{x:e.x,y:e.y,width:1,height:1,pointerType:"mouse",pressure:.5})},convertTouch(t,e){const i=Jd.getTouch(t),s=Yl.getBase(t);return Object.assign(Object.assign({},s),{x:e.x,y:e.y,width:1,height:1,pointerType:"touch",pressure:i.force})},getTouch(t){return t.targetTouches[0]||t.changedTouches[0]}},tc={getMove(t,e){let{moveSpeed:i}=e,{deltaX:s,deltaY:r}=t;return t.shiftKey&&!s&&(s=r,r=0),s>50&&(s=Math.max(50,s/3)),r>50&&(r=Math.max(50,r/3)),{x:-s*i*2,y:-r*i*2}},getScale(t,e){let i,s=1,{zoomMode:r,zoomSpeed:n}=e;const o=t.deltaY||t.deltaX;if(r?(i="mouse"===r||!t.deltaX&&(j.intWheelDeltaY?Math.abs(o)>17:Math.ceil(o)!==o),(t.shiftKey||t.metaKey||t.ctrlKey)&&(i=!0)):i=!t.shiftKey&&(t.metaKey||t.ctrlKey),i){n=V.within(n,0,1);const i=t.deltaY?e.delta.y:e.delta.x;s=1-o/(4*i)*n,s<.5&&(s=.5),s>=1.5&&(s=1.5)}return s}},ec={convert(t){const e=Yl.getBase(t),i=Object.assign(Object.assign({},e),{code:t.code,key:t.key});return i}},{getMoveEventData:ic,getZoomEventData:sc,getRotateEventData:rc}=Yl;class nc extends nd{__listenEvents(){super.__listenEvents();const t=this.view=this.canvas.view;this.viewEvents={pointerdown:this.onPointerDown,mousedown:this.onMouseDown,touchstart:this.onTouchStart,contextmenu:this.onContextMenu,wheel:this.onWheel,gesturestart:this.onGesturestart,gesturechange:this.onGesturechange,gestureend:this.onGestureend},this.windowEvents={pointermove:this.onPointerMove,pointerup:this.onPointerUp,pointercancel:this.onPointerCancel,mousemove:this.onMouseMove,mouseup:this.onMouseUp,touchmove:this.onTouchMove,touchend:this.onTouchEnd,touchcancel:this.onTouchCancel,keydown:this.onKeyDown,keyup:this.onKeyUp,scroll:this.onScroll};const{viewEvents:e,windowEvents:i}=this;for(let s in e)e[s]=e[s].bind(this),t.addEventListener(s,e[s]);for(let s in i)i[s]=i[s].bind(this),window.addEventListener(s,i[s])}__removeListenEvents(){super.__removeListenEvents();const{viewEvents:t,windowEvents:e}=this;for(let i in t)this.view.removeEventListener(i,t[i]),this.viewEvents={};for(let i in e)window.removeEventListener(i,e[i]),this.windowEvents={}}getTouches(t){const e=[];for(let i=0,s=t.length;i<s;i++)e.push(t[i]);return e}preventDefaultPointer(t){const{pointer:e}=this.config;e.preventDefault&&t.preventDefault()}preventDefaultWheel(t){const{wheel:e}=this.config;e.preventDefault&&t.preventDefault()}preventWindowPointer(t){return!this.downData&&t.target!==this.view}onKeyDown(t){this.keyDown(ec.convert(t))}onKeyUp(t){this.keyUp(ec.convert(t))}onContextMenu(t){this.config.pointer.preventDefaultMenu&&t.preventDefault(),this.menu(Jd.convert(t,this.getLocal(t)))}onScroll(){this.canvas.updateClientBounds()}onPointerDown(t){this.preventDefaultPointer(t),this.usePointer||(this.usePointer=!0),this.useMultiTouch||this.pointerDown(Jd.convert(t,this.getLocal(t)))}onPointerMove(t){this.usePointer||(this.usePointer=!0),this.useMultiTouch||this.preventWindowPointer(t)||this.pointerMove(Jd.convert(t,this.getLocal(t,!0)))}onPointerUp(t){this.downData&&this.preventDefaultPointer(t),this.useMultiTouch||this.preventWindowPointer(t)||this.pointerUp(Jd.convert(t,this.getLocal(t)))}onPointerCancel(){this.useMultiTouch||this.pointerCancel()}onMouseDown(t){this.preventDefaultPointer(t),this.useTouch||this.usePointer||this.pointerDown(Jd.convertMouse(t,this.getLocal(t)))}onMouseMove(t){this.useTouch||this.usePointer||this.preventWindowPointer(t)||this.pointerMove(Jd.convertMouse(t,this.getLocal(t,!0)))}onMouseUp(t){this.downData&&this.preventDefaultPointer(t),this.useTouch||this.usePointer||this.preventWindowPointer(t)||this.pointerUp(Jd.convertMouse(t,this.getLocal(t)))}onMouseCancel(){this.useTouch||this.usePointer||this.pointerCancel()}onTouchStart(t){if(t.preventDefault(),this.multiTouchStart(t),this.usePointer)return;this.touchTimer&&(window.clearTimeout(this.touchTimer),this.touchTimer=0),this.useTouch=!0;const e=Jd.getTouch(t);this.pointerDown(Jd.convertTouch(t,this.getLocal(e,!0)))}onTouchMove(t){if(this.multiTouchMove(t),this.usePointer||this.preventWindowPointer(t))return;const e=Jd.getTouch(t);this.pointerMove(Jd.convertTouch(t,this.getLocal(e)))}onTouchEnd(t){if(this.multiTouchEnd(),this.usePointer||this.preventWindowPointer(t))return;this.touchTimer&&clearTimeout(this.touchTimer),this.touchTimer=setTimeout((()=>{this.useTouch=!1}),500);const e=Jd.getTouch(t);this.pointerUp(Jd.convertTouch(t,this.getLocal(e)))}onTouchCancel(){this.usePointer||this.pointerCancel()}multiTouchStart(t){this.useMultiTouch=t.touches.length>=2,this.touches=this.useMultiTouch?this.getTouches(t.touches):void 0,this.useMultiTouch&&this.pointerCancel()}multiTouchMove(t){if(this.useMultiTouch&&t.touches.length>1){const e=this.getTouches(t.touches),i=this.getKeepTouchList(this.touches,e);i.length>1&&(this.multiTouch(Yl.getBase(t),i),this.touches=e)}}multiTouchEnd(){this.touches=null,this.useMultiTouch=!1,this.transformEnd()}getKeepTouchList(t,e){let i;const s=[];return t.forEach((t=>{i=e.find((e=>e.identifier===t.identifier)),i&&s.push({from:this.getLocal(t),to:this.getLocal(i)})})),s}getLocalTouchs(t){return t.map((t=>this.getLocal(t)))}onWheel(t){this.preventDefaultWheel(t);const{wheel:e}=this.config;if(e.disabled)return;const i=e.getScale?e.getScale(t,e):tc.getScale(t,e),s=this.getLocal(t),r=Yl.getBase(t);1!==i?this.zoom(sc(s,i,r)):this.move(ic(s,e.getMove?e.getMove(t,e):tc.getMove(t,e),r))}onGesturestart(t){this.useMultiTouch||(this.preventDefaultWheel(t),this.lastGestureScale=1,this.lastGestureRotation=0)}onGesturechange(t){if(this.useMultiTouch)return;this.preventDefaultWheel(t);const e=this.getLocal(t),i=Yl.getBase(t),s=t.scale/this.lastGestureScale,r=t.rotation-this.lastGestureRotation;let{rotateSpeed:n}=this.config.wheel;n=V.within(n,0,1),this.zoom(sc(e,s*s,i)),this.rotate(rc(e,r/Math.PI*180*(n/4+.1),i)),this.lastGestureScale=t.scale,this.lastGestureRotation=t.rotation}onGestureend(t){this.useMultiTouch||(this.preventDefaultWheel(t),this.transformEnd())}setCursor(t){super.setCursor(t);const e=[];this.eachCursor(t,e),"object"===typeof e[e.length-1]&&e.push("default"),this.canvas.view.style.cursor=e.map((t=>"object"===typeof t?`url(${t.url}) ${t.x||0} ${t.y||0}`:t)).join(",")}eachCursor(t,e,i=0){if(i++,t instanceof Array)t.forEach((t=>this.eachCursor(t,e,i)));else{const s="string"===typeof t&&od.get(t);s&&i<2?this.eachCursor(s,e,i):e.push(t)}}destroy(){this.view&&(super.destroy(),this.view=null,this.touches=null)}}function oc(t,e){let i;const{rows:s,decorationY:r,decorationHeight:n}=t.__.__textDrawData;for(let o=0,a=s.length;o<a;o++)i=s[o],i.text?e.fillText(i.text,i.x,i.y):i.data&&i.data.forEach((t=>{e.fillText(t.char,t.x,i.y)})),r&&e.fillRect(i.x,i.y+r,i.width,n)}function ac(t,e,i){i.fillStyle=t,e.__.__font?oc(e,i):e.__.windingRule?i.fill(e.__.windingRule):i.fill()}function hc(t,e,i){let s;const{windingRule:r,__font:n}=e.__;for(let o=0,a=t.length;o<a;o++)s=t[o],s.image&&Ia.checkImage(e,i,s,!n)||s.style&&(i.fillStyle=s.style,s.transform?(i.save(),i.transform(s.transform),s.blendMode&&(i.blendMode=s.blendMode),n?oc(e,i):r?i.fill(r):i.fill(),i.restore()):s.blendMode?(i.saveBlendMode(s.blendMode),n?oc(e,i):r?i.fill(r):i.fill(),i.restoreBlendMode()):n?oc(e,i):r?i.fill(r):i.fill())}function lc(t,e,i){const{strokeAlign:s}=e.__,r="string"!==typeof t;switch(s){case"center":i.setStroke(r?void 0:t,e.__.strokeWidth,e.__),r?uc(t,!0,e,i):cc(e,i);break;case"inside":dc("inside",t,r,e,i);break;case"outside":dc("outside",t,r,e,i);break}}function dc(t,e,i,s,r){const{__strokeWidth:n,__font:o}=s.__,a=r.getSameCanvas(!0,!0);a.setStroke(i?void 0:e,2*n,s.__),a.font=o,i?uc(e,!0,s,a):cc(s,a),a.blendMode="outside"===t?"destination-out":"destination-in",oc(s,a),a.blendMode="normal",s.__worldFlipped?r.copyWorldByReset(a,s.__nowWorld):r.copyWorldToInner(a,s.__nowWorld,s.__layout.renderBounds),a.recycle(s.__nowWorld)}function cc(t,e){let i;const{rows:s,decorationY:r,decorationHeight:n}=t.__.__textDrawData;for(let o=0,a=s.length;o<a;o++)i=s[o],i.text?e.strokeText(i.text,i.x,i.y):i.data&&i.data.forEach((t=>{e.strokeText(t.char,t.x,i.y)})),r&&e.strokeRect(i.x,i.y+r,i.width,n)}function uc(t,e,i,s){let r;for(let n=0,o=t.length;n<o;n++)r=t[n],r.image&&Ia.checkImage(i,s,r,!1)||r.style&&(s.strokeStyle=r.style,r.blendMode?(s.saveBlendMode(r.blendMode),e?cc(i,s):s.stroke(),s.restoreBlendMode()):e?cc(i,s):s.stroke())}function pc(t,e,i){const s=e.__,{__strokeWidth:r,strokeAlign:n,__font:o}=s;if(r)if(o)lc(t,e,i);else switch(n){case"center":i.setStroke(t,r,s),i.stroke();break;case"inside":i.save(),i.setStroke(t,2*r,s),s.windingRule?i.clip(s.windingRule):i.clip(),i.stroke(),i.restore();break;case"outside":const n=i.getSameCanvas(!0,!0);n.setStroke(t,2*r,s),e.__drawRenderPath(n),n.stroke(),s.windingRule?n.clip(s.windingRule):n.clip(),n.clearWorld(e.__layout.renderBounds),e.__worldFlipped?i.copyWorldByReset(n,e.__nowWorld):i.copyWorldToInner(n,e.__nowWorld,e.__layout.renderBounds),n.recycle(e.__nowWorld);break}}function _c(t,e,i){const s=e.__,{__strokeWidth:r,strokeAlign:n,__font:o}=s;if(r)if(o)lc(t,e,i);else switch(n){case"center":i.setStroke(void 0,r,s),uc(t,!1,e,i);break;case"inside":i.save(),i.setStroke(void 0,2*r,s),s.windingRule?i.clip(s.windingRule):i.clip(),uc(t,!1,e,i),i.restore();break;case"outside":const{renderBounds:n}=e.__layout,o=i.getSameCanvas(!0,!0);e.__drawRenderPath(o),o.setStroke(void 0,2*r,s),uc(t,!1,e,o),s.windingRule?o.clip(s.windingRule):o.clip(),o.clearWorld(n),e.__worldFlipped?i.copyWorldByReset(o,e.__nowWorld):i.copyWorldToInner(o,e.__nowWorld,n),o.recycle(e.__nowWorld);break}}const{getSpread:yc,getOuterOf:gc,getByMove:fc,getIntersectData:mc}=Yt;function xc(t,e,i){const s=e.getSameCanvas(),r=t.__nowWorld;let n,o,a,h,{scaleX:l,scaleY:d}=r;if(l<0&&(l=-l),d<0&&(d=-d),e.bounds.includes(r))h=s,n=a=r;else{const{renderShapeSpread:s}=t.__layout,c=mc(s?yc(e.bounds,l===d?s*l:[s*d,s*l]):e.bounds,r);o=e.bounds.getFitMatrix(c);let{a:u,d:p}=o;if(o.a<1&&(h=e.getSameCanvas(),t.__renderShape(h,i),l*=u,d*=p),a=gc(r,o),n=fc(a,-o.e,-o.f),i.matrix){const{matrix:t}=i;o.multiply(t),u*=t.scaleX,p*=t.scaleY}i=Object.assign(Object.assign({},i),{matrix:o.withScale(u,p)})}return t.__renderShape(s,i),{canvas:s,matrix:o,bounds:n,worldCanvas:h,shapeBounds:a,scaleX:l,scaleY:d}}let vc;function wc(t,e){const i=e.__,s=[];let r,n=i.__input[t];n instanceof Array||(n=[n]),vc=Ia.recycleImage(t,i);for(let o,a=0,h=n.length;a<h;a++)o=bc(t,n[a],e),o&&s.push(o);i["_"+t]=s.length?s:void 0,s.length&&s[0].image&&(r=s[0].image.hasOpacityPixel),"fill"===t?i.__pixelFill=r:i.__pixelStroke=r}function bc(t,e,i){if("object"!==typeof e||!1===e.visible||0===e.opacity)return;const{boxBounds:s}=i.__layout;switch(e.type){case"solid":let{type:r,blendMode:n,color:o,opacity:a}=e;return{type:r,blendMode:n,style:Ma.string(o,a)};case"image":return Ia.image(i,t,e,s,!vc||!vc[e.url]);case"linear":return Wa.linearGradient(e,s);case"radial":return Wa.radialGradient(e,s);case"angular":return Wa.conicGradient(e,s);default:return void 0!==e.r?{type:"solid",style:Ma.string(e)}:void 0}}const kc={compute:wc,fill:ac,fills:hc,fillText:oc,stroke:pc,strokes:_c,strokeText:lc,drawTextStroke:cc,shape:xc};let Cc={};const{get:Bc,rotateOfOuter:Rc,translate:Sc,scaleOfOuter:Ec,scale:Tc,rotate:Pc}=nt;function Lc(t,e,i,s,r,n,o){const a=Bc();Sc(a,e.x+i,e.y+s),Tc(a,r,n),o&&Rc(a,{x:e.x+e.width/2,y:e.y+e.height/2},o),t.transform=a}function Oc(t,e,i,s,r,n,o){const a=Bc();Sc(a,e.x+i,e.y+s),r&&Tc(a,r,n),o&&Pc(a,o),t.transform=a}function Mc(t,e,i,s,r,n,o,a,h,l){const d=Bc();if(h)if("center"===l)Rc(d,{x:i/2,y:s/2},h);else switch(Pc(d,h),h){case 90:Sc(d,s,0);break;case 180:Sc(d,i,s);break;case 270:Sc(d,0,i);break}Cc.x=e.x+r,Cc.y=e.y+n,Sc(d,Cc.x,Cc.y),o&&Ec(d,Cc,o,a),t.transform=d}const{get:Dc,translate:Ac}=nt,Ic=new Ht,Wc={};function jc(t,e,i,s){const{blendMode:r}=i;r&&(t.blendMode=r),t.data=Fc(i,s,e)}function Fc(t,e,i){let{width:s,height:r}=i;t.padding&&(e=Ic.set(e).shrink(t.padding));const{opacity:n,mode:o,align:a,offset:h,scale:l,size:d,rotation:c,repeat:u}=t,p=e.width===s&&e.height===r,_={mode:o},y="center"!==a&&(c||0)%180===90,g=y?r:s,f=y?s:r;let m,x,v=0,w=0;if(o&&"cover"!==o&&"fit"!==o)d?(m=("number"===typeof d?d:d.width)/s,x=("number"===typeof d?d:d.height)/r):l&&(m="number"===typeof l?l:l.x,x="number"===typeof l?l:l.y);else if(!p||c){const t=e.width/g,i=e.height/f;m=x="fit"===o?Math.min(t,i):Math.max(t,i),v+=(e.width-s*m)/2,w+=(e.height-r*x)/2}if(a){const t={x:v,y:w,width:g,height:f};m&&(t.width*=m,t.height*=x),Jt.toPoint(a,t,e,Wc,!0),v+=Wc.x,w+=Wc.y}switch(h&&(v+=h.x,w+=h.y),o){case"strench":p||(s=e.width,r=e.height);break;case"normal":case"clip":(v||w||m||c)&&Oc(_,e,v,w,m,x,c);break;case"repeat":(!p||m||c)&&Mc(_,e,s,r,v,w,m,x,c,a),u||(_.repeat="repeat");break;case"fit":case"cover":default:m&&Lc(_,e,v,w,m,x,c)}return _.transform||(e.x||e.y)&&(_.transform=Dc(),Ac(_.transform,e.x,e.y)),m&&"strench"!==o&&(_.scaleX=m,_.scaleY=x),_.width=s,_.height=r,n&&(_.opacity=n),u&&(_.repeat="string"===typeof u?"x"===u?"repeat-x":"repeat-y":"repeat"),_}let Yc,Nc=new Ht;const{isSame:zc}=Yt;function Xc(t,e,i,s,r){let n,o;const a=Ur.get(i);return Yc&&i===Yc.paint&&zc(s,Yc.boxBounds)?n=Yc.leafPaint:(n={type:i.type,image:a},Yc=a.use>1?{leafPaint:n,paint:i,boxBounds:Nc.set(s)}:null),(r||a.loading)&&(o={image:a,attrName:e,attrValue:i}),a.ready?(Hc(t,e,i,a,n,s),r&&(Vc(t,o),Uc(t,o))):a.error?r&&Gc(t,o,a.error):($c(t,!0),r&&Vc(t,o),n.loadId=a.load((()=>{$c(t,!1),t.destroyed||(Hc(t,e,i,a,n,s)&&(a.hasOpacityPixel&&(t.__layout.hitCanvasChanged=!0),t.forceUpdate("surface")),Uc(t,o)),n.loadId=null}),(e=>{$c(t,!1),Gc(t,o,e),n.loadId=null}))),n}function Hc(t,e,i,s,r,n){if("fill"===e&&!t.__.__naturalWidth){const e=t.__;if(e.__naturalWidth=s.width/e.pixelRatio,e.__naturalHeight=s.height/e.pixelRatio,e.__autoSide)return t.forceUpdate("width"),t.__proxyData&&(t.setProxyAttr("width",e.width),t.setProxyAttr("height",e.height)),!1}return r.data||jc(r,s,i,n),!0}function Vc(t,e){Kc(t,Co.LOAD,e)}function Uc(t,e){Kc(t,Co.LOADED,e)}function Gc(t,e,i){e.error=i,t.forceUpdate("surface"),Kc(t,Co.ERROR,e)}function Kc(t,e,i){t.hasEvent(e)&&t.emitEvent(new Co(e,i))}function $c(t,e){const{leafer:i}=t;i&&i.viewReady&&(i.renderer.ignore=e)}const{get:qc,scale:Qc,copy:Zc}=nt,{ceil:Jc,abs:tu}=Math;function eu(t,e,i){let{scaleX:s,scaleY:r}=Ur.patternLocked?t.__world:t.__nowWorld;const n=s+"-"+r;if(e.patternId===n||t.destroyed)return!1;{s=tu(s),r=tu(r);const{image:t,data:o}=e;let a,h,{width:l,height:d,scaleX:c,scaleY:u,opacity:p,transform:_,repeat:y}=o;c&&(h=qc(),Zc(h,_),Qc(h,1/c,1/u),s*=c,r*=u),s*=i,r*=i,l*=s,d*=r;const g=l*d;if(!y&&g>j.image.maxCacheSize)return!1;let f=j.image.maxPatternSize;if(!t.isSVG){const e=t.width*t.height;f>e&&(f=e)}g>f&&(a=Math.sqrt(g/f)),a&&(s/=a,r/=a,l/=a,d/=a),c&&(s/=c,r/=u),(_||1!==s||1!==r)&&(h||(h=qc(),_&&Zc(h,_)),Qc(h,1/s,1/r));const m=t.getCanvas(Jc(l)||1,Jc(d)||1,p),x=t.getPattern(m,y||j.origin.noRepeat||"no-repeat",h,e);return e.style=x,e.patternId=n,!0}}function iu(t,e,i,s){function r(t){return t instanceof i?t:new i((function(e){e(t)}))}return new(i||(i=Promise))((function(i,n){function o(t){try{h(s.next(t))}catch(e){n(e)}}function a(t){try{h(s["throw"](t))}catch(e){n(e)}}function h(t){t.done?i(t.value):r(t.value).then(o,a)}h((s=s.apply(t,e||[])).next())}))}"function"===typeof SuppressedError&&SuppressedError;const{abs:su}=Math;function ru(t,e,i,s){const{scaleX:r,scaleY:n}=Ur.patternLocked?t.__world:t.__nowWorld;if(i.data&&i.patternId!==r+"-"+n){const{data:o}=i;if(s)if(o.repeat)s=!1;else{let{width:t,height:i}=o;t*=su(r)*e.pixelRatio,i*=su(n)*e.pixelRatio,o.scaleX&&(t*=o.scaleX,i*=o.scaleY),s=t*i>j.image.maxCacheSize||Fa.running}return s?(e.save(),e.clip(),i.blendMode&&(e.blendMode=i.blendMode),o.opacity&&(e.opacity*=o.opacity),o.transform&&e.transform(o.transform),e.drawImage(i.image.view,0,0,o.width,o.height),e.restore(),!0):(!i.style||Fa.running?eu(t,i,e.pixelRatio):i.patternTask||(i.patternTask=Ur.patternTasker.add((()=>iu(this,void 0,void 0,(function*(){i.patternTask=null,e.bounds.hit(t.__nowWorld)&&eu(t,i,e.pixelRatio),t.forceUpdate("surface")}))),300)),!1)}return!1}function nu(t,e){const i=e["_"+t];if(i instanceof Array){let s,r,n,o;for(let a=0,h=i.length;a<h;a++)s=i[a].image,o=s&&s.url,o&&(r||(r={}),r[o]=!0,Ur.recycle(s),s.loading&&(n||(n=e.__input&&e.__input[t]||[],n instanceof Array||(n=[n])),s.unload(i[a].loadId,!n.some((t=>t.url===o)))));return r}return null}const ou={image:Xc,checkImage:ru,createPattern:eu,recycleImage:nu,createData:jc,getPatternData:Fc,fillOrFitMode:Lc,clipMode:Oc,repeatMode:Mc},{toPoint:au}=qt,hu={},lu={};function du(t,e){let{from:i,to:s,type:r,blendMode:n,opacity:o}=t;au(i||"top",e,hu),au(s||"bottom",e,lu);const a=j.canvas.createLinearGradient(hu.x,hu.y,lu.x,lu.y);cu(a,t.stops,o);const h={type:r,style:a};return n&&(h.blendMode=n),h}function cu(t,e,i){let s;for(let r=0,n=e.length;r<n;r++)s=e[r],"string"===typeof s?t.addColorStop(r/(n-1),Ma.string(s,i)):t.addColorStop(s.offset,Ma.string(s.color,i))}const{getAngle:uu,getDistance:pu}=gt,{get:_u,rotateOfOuter:yu,scaleOfOuter:gu}=nt,{toPoint:fu}=qt,mu={},xu={};function vu(t,e){let{from:i,to:s,type:r,opacity:n,blendMode:o,stretch:a}=t;fu(i||"center",e,mu),fu(s||"bottom",e,xu);const h=j.canvas.createRadialGradient(mu.x,mu.y,0,mu.x,mu.y,pu(mu,xu));cu(h,t.stops,n);const l={type:r,style:h},d=wu(e,mu,xu,a,!0);return d&&(l.transform=d),o&&(l.blendMode=o),l}function wu(t,e,i,s,r){let n;const{width:o,height:a}=t;if(o!==a||s){const t=uu(e,i);n=_u(),r?(gu(n,e,o/a*(s||1),1),yu(n,e,t+90)):(gu(n,e,1,o/a*(s||1)),yu(n,e,t))}return n}const{getDistance:bu}=gt,{toPoint:ku}=qt,Cu={},Bu={};function Ru(t,e){let{from:i,to:s,type:r,opacity:n,blendMode:o,stretch:a}=t;ku(i||"center",e,Cu),ku(s||"bottom",e,Bu);const h=j.conicGradientSupport?j.canvas.createConicGradient(0,Cu.x,Cu.y):j.canvas.createRadialGradient(Cu.x,Cu.y,0,Cu.x,Cu.y,bu(Cu,Bu));cu(h,t.stops,n);const l={type:r,style:h},d=wu(e,Cu,Bu,a||1,j.conicGradientRotate90);return d&&(l.transform=d),o&&(l.blendMode=o),l}const Su={linearGradient:du,radialGradient:vu,conicGradient:Ru,getTransform:wu},{copy:Eu,toOffsetOutBounds:Tu}=Yt,Pu={},Lu={};function Ou(t,e,i){let s,r;const{__nowWorld:n,__layout:o}=t,{shadow:a}=t.__,{worldCanvas:h,bounds:l,shapeBounds:d,scaleX:c,scaleY:u}=i,p=e.getSameCanvas(),_=a.length-1;Tu(l,Lu),a.forEach(((a,y)=>{p.setWorldShadow(Lu.offsetX+a.x*c,Lu.offsetY+a.y*u,a.blur*c,a.color),r=a.spread?1+2*a.spread/(o.boxBounds.width+2*(o.strokeBoxSpread||0)):0,Mu(p,Lu,r,i),s=l,a.box&&(p.restore(),p.save(),h&&(p.copyWorld(p,l,n,"copy"),s=n),h?p.copyWorld(h,n,n,"destination-out"):p.copyWorld(i.canvas,d,l,"destination-out")),t.__worldFlipped?e.copyWorldByReset(p,s,n,a.blendMode):e.copyWorldToInner(p,s,o.renderBounds,a.blendMode),_&&y<_&&p.clearWorld(s,!0)})),p.recycle(s)}function Mu(t,e,i,s){const{bounds:r,shapeBounds:n}=s;if(j.fullImageShadow){if(Eu(Pu,t.bounds),Pu.x+=e.x-n.x,Pu.y+=e.y-n.y,i){const{matrix:t}=s;Pu.x-=(r.x+(t?t.e:0)+r.width/2)*(i-1),Pu.y-=(r.y+(t?t.f:0)+r.height/2)*(i-1),Pu.width*=i,Pu.height*=i}t.copyWorld(s.canvas,t.bounds,Pu)}else i&&(Eu(Pu,e),Pu.x-=e.width/2*(i-1),Pu.y-=e.height/2*(i-1),Pu.width*=i,Pu.height*=i),t.copyWorld(s.canvas,n,i?Pu:e)}const{toOffsetOutBounds:Du}=Yt,Au={};function Iu(t,e,i){let s,r;const{__nowWorld:n,__layout:o}=t,{innerShadow:a}=t.__,{worldCanvas:h,bounds:l,shapeBounds:d,scaleX:c,scaleY:u}=i,p=e.getSameCanvas(),_=a.length-1;Du(l,Au),a.forEach(((a,y)=>{p.save(),p.setWorldShadow(Au.offsetX+a.x*c,Au.offsetY+a.y*u,a.blur*c),r=a.spread?1-2*a.spread/(o.boxBounds.width+2*(o.strokeBoxSpread||0)):0,Mu(p,Au,r,i),p.restore(),h?(p.copyWorld(p,l,n,"copy"),p.copyWorld(h,n,n,"source-out"),s=n):(p.copyWorld(i.canvas,d,l,"source-out"),s=l),p.fillWorld(s,a.color,"source-in"),t.__worldFlipped?e.copyWorldByReset(p,s,n,a.blendMode):e.copyWorldToInner(p,s,o.renderBounds,a.blendMode),_&&y<_&&p.clearWorld(s,!0)})),p.recycle(s)}function Wu(t,e,i){const{blur:s}=t.__;i.setWorldBlur(s*t.__nowWorld.a),i.copyWorldToInner(e,t.__nowWorld,t.__layout.renderBounds),i.filter="none"}function ju(t,e,i){}const Fu={shadow:Ou,innerShadow:Iu,blur:Wu,backgroundBlur:ju},{excludeRenderBounds:Yu}=eo;function Nu(t,e,i,s,r,n){switch(e){case"alpha":Xu(t,i,s,r);break;case"opacity-path":Hu(t,i,s,n);break;case"path":i.restore()}}function zu(t){return t.getSameCanvas(!1,!0)}function Xu(t,e,i,s){const r=t.__nowWorld;i.resetTransform(),i.opacity=1,i.useMask(s,r),s.recycle(r),Hu(t,e,i,1)}function Hu(t,e,i,s){const r=t.__nowWorld;e.resetTransform(),e.opacity=s,e.copyWorld(i,r),i.recycle(r)}mh.prototype.__renderMask=function(t,e){let i,s,r,n,o;const{children:a}=this;for(let h=0,l=a.length;h<l;h++)i=a[h],i.__.mask&&(o&&(Nu(this,o,t,r,s,n),s=r=null),"path"===i.__.mask?(i.opacity<1?(o="opacity-path",n=i.opacity,r||(r=zu(t))):(o="path",t.save()),i.__clip(r||t,e)):(o="alpha",s||(s=zu(t)),r||(r=zu(t)),i.__render(s,e)),"clipping"!==i.__.mask)||Yu(i,e)||i.__render(r||t,e);Nu(this,o,t,r,s,n)};const Vu="¥￥＄€£￡¢￠",Uu="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz",Gu="《（「〈『〖【〔｛┌＜‘“＝"+Vu,Ku="》）」〉』〗】〕｝┐＞’”！？，、。：；‰",$u="≮≯≈≠＝…",qu="—／～｜┆·",Qu="{[(<'\""+Gu,Zu=">)]}%!?,.:;'\""+Ku,Ju=Zu+"_#~&*+\\=|"+$u,tp="- "+qu,ep=[[19968,40959],[13312,19903],[131072,173791],[173824,177983],[177984,178207],[178208,183983],[183984,191471],[196608,201551],[201552,205743],[11904,12031],[12032,12255],[12272,12287],[12288,12351],[12736,12783],[12800,13055],[13056,13311],[63744,64255],[65072,65103],[127488,127743],[194560,195103]],ip=new RegExp(ep.map((([t,e])=>`[\\u${t.toString(16)}-\\u${e.toString(16)}]`)).join("|"));function sp(t){const e={};return t.split("").forEach((t=>e[t]=!0)),e}const rp=sp(Uu),np=sp(Qu),op=sp(Zu),ap=sp(Ju),hp=sp(tp);var lp;(function(t){t[t["Letter"]=0]="Letter",t[t["Single"]=1]="Single",t[t["Before"]=2]="Before",t[t["After"]=3]="After",t[t["Symbol"]=4]="Symbol",t[t["Break"]=5]="Break"})(lp||(lp={}));const{Letter:dp,Single:cp,Before:up,After:pp,Symbol:_p,Break:yp}=lp;function gp(t){return rp[t]?dp:hp[t]?yp:np[t]?up:op[t]?pp:ap[t]?_p:ip.test(t)?cp:dp}const fp={trimRight(t){const{words:e}=t;let i,s=0,r=e.length;for(let n=r-1;n>-1;n--){if(i=e[n].data[0]," "!==i.char)break;s++,t.width-=i.width}s&&e.splice(r-s,s)}};function mp(t,e,i){switch(e){case"title":return i?t.toUpperCase():t;case"upper":return t.toUpperCase();case"lower":return t.toLowerCase();default:return t}}const{trimRight:xp}=fp,{Letter:vp,Single:wp,Before:bp,After:kp,Symbol:Cp,Break:Bp}=lp;let Rp,Sp,Ep,Tp,Pp,Lp,Op,Mp,Dp,Ap,Ip,Wp,jp,Fp,Yp,Np,zp=[];function Xp(t,e,i){Yp=t,zp=t.rows,Np=t.bounds;const{__letterSpacing:s,paraIndent:r,textCase:n}=i,{canvas:o}=j,{width:a,height:h}=Np,l=a||h||s||"none"!==n;if(l){const t="none"!==i.textWrap,h="break"===i.textWrap;Fp=!0,Ip=null,Mp=Op=Dp=Ep=Tp=0,Rp={data:[]},Sp={words:[]};for(let i=0,l=e.length;i<l;i++)Lp=e[i],"\n"===Lp?(Ep&&Vp(),Sp.paraEnd=!0,Up(),Fp=!0):(Ap=gp(Lp),Ap===vp&&"none"!==n&&(Lp=mp(Lp,n,!Ep)),Op=o.measureText(Lp).width,s&&(s<0&&(Dp=Op),Op+=s),Wp=Ap===wp&&(Ip===wp||Ip===vp)||Ip===wp&&Ap!==kp,jp=(Ap===bp||Ap===wp)&&(Ip===Cp||Ip===kp),Pp=Fp&&r?a-r:a,t&&a&&Tp+Ep+Op>Pp&&(h?(Ep&&Vp(),Tp&&Up()):(jp||(jp=Ap===vp&&Ip==kp),Wp||jp||Ap===Bp||Ap===bp||Ap===wp||Ep+Op>Pp?(Ep&&Vp(),Tp&&Up()):Tp&&Up()))," "===Lp&&!0!==Fp&&Tp+Ep===0||(Ap===Bp?(" "===Lp&&Ep&&Vp(),Hp(Lp,Op),Vp()):Wp||jp?(Ep&&Vp(),Hp(Lp,Op)):Hp(Lp,Op)),Ip=Ap);Ep&&Vp(),Tp&&Up(),zp.length>0&&(zp[zp.length-1].paraEnd=!0)}else e.split("\n").forEach((t=>{Yp.paraNumber++,zp.push({x:r||0,text:t,width:o.measureText(t).width,paraStart:!0})}))}function Hp(t,e){Dp&&!Mp&&(Mp=Dp),Rp.data.push({char:t,width:e}),Ep+=e}function Vp(){Tp+=Ep,Rp.width=Ep,Sp.words.push(Rp),Rp={data:[]},Ep=0}function Up(){Fp&&(Yp.paraNumber++,Sp.paraStart=!0,Fp=!1),Dp&&(Sp.startCharSize=Mp,Sp.endCharSize=Dp,Mp=0),Sp.width=Tp,Np.width&&xp(Sp),zp.push(Sp),Sp={words:[]},Tp=0}const Gp=0,Kp=1,$p=2;function qp(t,e,i,s){const{rows:r}=t,{textAlign:n,paraIndent:o,letterSpacing:a}=e;let h,l,d,c,u;r.forEach((t=>{t.words&&(d=o&&t.paraStart?o:0,l=i&&"justify"===n&&t.words.length>1?(i-t.width-d)/(t.words.length-1):0,c=a||t.isOverflow?Gp:l>.01?Kp:$p,t.isOverflow&&!a&&(t.textMode=!0),c===$p?(t.x+=d,Qp(t)):(t.x+=d,h=t.x,t.data=[],t.words.forEach((e=>{c===Kp?(u={char:"",x:h},h=Zp(e.data,h,u),(t.isOverflow||" "!==u.char)&&t.data.push(u)):h=Jp(e.data,h,t.data,t.isOverflow),!t.paraEnd&&l&&(h+=l,t.width+=l)}))),t.words=null)}))}function Qp(t){t.text="",t.words.forEach((e=>{e.data.forEach((e=>{t.text+=e.char}))}))}function Zp(t,e,i){return t.forEach((t=>{i.char+=t.char,e+=t.width})),e}function Jp(t,e,i,s){return t.forEach((t=>{(s||" "!==t.char)&&(t.x=e,i.push(t)),e+=t.width})),e}function t_(t,e){const{rows:i,bounds:s}=t,{__lineHeight:r,__baseLine:n,__letterSpacing:o,__clipText:a,textAlign:h,verticalAlign:l,paraSpacing:d}=e;let c,u,p,{x:_,y:y,width:g,height:f}=s,m=r*i.length+(d?d*(t.paraNumber-1):0),x=n;if(a&&m>f)m=Math.max(f,r),t.overflow=i.length;else switch(l){case"middle":y+=(f-m)/2;break;case"bottom":y+=f-m}x+=y;for(let v=0,w=i.length;v<w;v++){if(c=i[v],c.x=_,c.width<g||c.width>g&&!a)switch(h){case"center":c.x+=(g-c.width)/2;break;case"right":c.x+=g-c.width}c.paraStart&&d&&v>0&&(x+=d),c.y=x,x+=r,t.overflow>v&&x>m&&(c.isOverflow=!0,t.overflow=v+1),u=c.x,p=c.width,o<0&&(c.width<0?(p=-c.width+e.fontSize+o,u-=p,p+=e.fontSize):p-=o),u<s.x&&(s.x=u),p>s.width&&(s.width=p),a&&g&&g<p&&(c.isOverflow=!0,t.overflow||(t.overflow=i.length))}s.y=y,s.height=m}function e_(t,e,i,s){if(!s)return;const{rows:r,overflow:n}=t;let{textOverflow:o}=e;if(r.splice(n),o&&"show"!==o){let t,a;"hide"===o?o="":"ellipsis"===o&&(o="...");const h=o?j.canvas.measureText(o).width:0,l=i+s-h,d="none"===e.textWrap?r:[r[n-1]];d.forEach((e=>{if(e.isOverflow&&e.data){let i=e.data.length-1;for(let s=i;s>-1;s--){if(t=e.data[s],a=t.x+t.width,s===i&&a<l)break;if(a<l&&" "!==t.char){e.data.splice(s+1),e.width-=t.width;break}e.width-=t.width}e.width+=h,e.data.push({char:o,x:a}),e.textMode&&i_(e)}}))}}function i_(t){t.text="",t.data.forEach((e=>{t.text+=e.char})),t.data=null}function s_(t,e){const{fontSize:i}=e;switch(t.decorationHeight=i/11,e.textDecoration){case"under":t.decorationY=.15*i;break;case"delete":t.decorationY=.35*-i}}const{top:r_,right:n_,bottom:o_,left:a_}=Gt;function h_(t,e){"string"!==typeof t&&(t=String(t));let i=0,s=0,r=e.__getInput("width")||0,n=e.__getInput("height")||0;const{textDecoration:o,__font:a,__padding:h}=e;h&&(r&&(i=h[a_],r-=h[n_]+h[a_]),n&&(s=h[r_],n-=h[r_]+h[o_]));const l={bounds:{x:i,y:s,width:r,height:n},rows:[],paraNumber:0,font:j.canvas.font=a};return Xp(l,t,e),h&&l_(h,l,e,r,n),t_(l,e),qp(l,e,r),l.overflow&&e_(l,e,i,r),"none"!==o&&s_(l,e),l}function l_(t,e,i,s,r){if(!s)switch(i.textAlign){case"left":d_(e,"x",t[a_]);break;case"right":d_(e,"x",-t[n_])}if(!r)switch(i.verticalAlign){case"top":d_(e,"y",t[r_]);break;case"bottom":d_(e,"y",-t[o_])}}function d_(t,e,i){const{bounds:s,rows:r}=t;s[e]+=i;for(let n=0;n<r.length;n++)r[n][e]+=i}const c_={getDrawData:h_};function u_(t,e){if("string"===typeof t)return t;let i=void 0===t.a?1:t.a;e&&(i*=e);const s=t.r+","+t.g+","+t.b;return 1===i?"rgb("+s+")":"rgba("+s+","+i+")"}const p_={string:u_},{setPoint:__,addPoint:y_,toBounds:g_}=kt;function f_(t){const{width:e,height:i}=t.view,{data:s}=t.context.getImageData(0,0,e,i);let r,n,o,a=0;for(let l=0;l<s.length;l+=4)0!==s[l+3]&&(r=a%e,n=(a-r)/e,o?y_(o,r,n):__(o={},r,n)),a++;const h=new Ht;return g_(o,h),h.scale(1/t.pixelRatio).ceil()}const m_={export(t,e,i){this.running=!0;const s=Nr.fileType(e);return i=Nr.getExportOptions(i),v_((r=>new Promise((n=>{const o=t=>{r(t),n(),this.running=!1},{toURL:a}=j,{download:h}=j.origin;if("json"===e)return o({data:t.toJSON(i.json)});if("json"===s)return h(a(JSON.stringify(t.toJSON(i.json)),"text"),e),o({data:!0});if("svg"===e)return o({data:t.toSVG()});if("svg"===s)return h(a(t.toSVG(),"svg"),e),o({data:!0});const{leafer:l}=t;l?(w_(t),l.waitViewCompleted((()=>iu(this,void 0,void 0,(function*(){let s,r,n=1,a=1;const{worldTransform:h,isLeafer:d,isFrame:c}=t,{slice:u,trim:p,onCanvas:_}=i;let y=i.scale||1,g=i.pixelRatio||1;const f=void 0===i.smooth?l.config.smooth:i.smooth,m=i.contextSettings||l.config.contextSettings;t.isApp&&(y*=g,g=t.app.pixelRatio);const x=i.screenshot||t.isApp,v=d&&x&&void 0===i.fill?t.fill:i.fill,w=Nr.isOpaqueImage(e)||v,b=new bt;if(x)s=!0===x?d?l.canvas.bounds:t.worldRenderBounds:x;else{let e=i.relative||(d?"inner":"local");switch(n=h.scaleX,a=h.scaleY,e){case"inner":b.set(h);break;case"local":b.set(h).divide(t.localTransform),n/=t.scaleX,a/=t.scaleY;break;case"world":n=1,a=1;break;case"page":e=t.leafer;default:b.set(h).divide(t.getTransform(e));const i=e.worldTransform;n/=n/i.scaleX,a/=a/i.scaleY}s=t.getBounds("render",e)}const{x:k,y:C,width:B,height:R}=new Ht(s).scale(y);let S=F.canvas({width:Math.round(B),height:Math.round(R),pixelRatio:g,smooth:f,contextSettings:m});const E={matrix:b.scale(1/y).invert().translate(-k,-C).withScale(1/n*y,1/a*y)};if(u&&(t=l,E.bounds=S.bounds),S.save(),c&&void 0!==v){const e=t.get("fill");t.fill="",t.__render(S,E),t.fill=e}else t.__render(S,E);if(S.restore(),p){r=f_(S);const t=S,{width:e,height:i}=r,s={x:0,y:0,width:e,height:i,pixelRatio:g};S=F.canvas(s),S.copyWorld(t,r,s)}w&&S.fillWorld(S.bounds,v||"#FFFFFF","destination-over"),_&&_(S);const T="canvas"===e?S:yield S.export(e,i);o({data:T,width:S.pixelWidth,height:S.pixelHeight,renderBounds:s,trimBounds:r})}))))):o({data:!1})}))))}};let x_;function v_(t){return x_||(x_=new Vr),new Promise((e=>{x_.add((()=>iu(this,void 0,void 0,(function*(){return yield t(e)}))),{parallel:!1})}))}function w_(t){t.__.__needComputePaint&&t.__.__computePaint(),t.isBranch&&t.children.forEach((t=>w_(t)))}const b_=Ee.prototype,k_=ee.get("@leafer-ui/export");function C_(t){return C_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},C_(t)}function B_(t,e){if("object"!=C_(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var s=i.call(t,e||"default");if("object"!=C_(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function R_(t){var e=B_(t,"string");return"symbol"==C_(e)?e:e+""}function S_(t,e,i){return(e=R_(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}b_.export=function(t,e){const{quality:i,blob:s}=Nr.getExportOptions(e);return t.includes(".")?this.saveAs(t,i):s?this.toBlob(t,i):this.toDataURL(t,i)},b_.toBlob=function(t,e){return new Promise((i=>{j.origin.canvasToBolb(this.view,t,e).then((t=>{i(t)})).catch((t=>{k_.error(t),i(null)}))}))},b_.toDataURL=function(t,e){return j.origin.canvasToDataURL(this.view,t,e)},b_.saveAs=function(t,e){return new Promise((i=>{j.origin.canvasSaveAs(this.view,t,e).then((()=>{i(!0)})).catch((t=>{k_.error(t),i(!1)}))}))},Object.assign(Oa,c_),Object.assign(Ma,p_),Object.assign(Aa,kc),Object.assign(Ia,ou),Object.assign(Wa,Su),Object.assign(ja,Fu),Object.assign(Fa,m_),Object.assign(F,{interaction:(t,e,i,s)=>new nc(t,e,i,s),hitCanvas:(t,e)=>new wd(t,e),hitCanvasManager:()=>new ad}),Cd();class E_{constructor(t){S_(this,"staticSpriteMaps",{}),S_(this,"staticSprites",[]),S_(this,"dynamicSprites",[]);const{camera:e}=t;this._core=new wh;const i=new al({x:e.x,y:e.y,width:e.width,height:e.height,pixelRatio:devicePixelRatio});this._core.add(i),this._canvas=i,this._camera=e}addStaticSprites(t){this.staticSpriteMaps[`${t.x}-${t.y}`]=t,this.staticSprites.push(t)}addDynamicSprites(t){this.dynamicSprites.push(t)}run(){this._canvas.context.clearRect(0,0,this._canvas.width,this._canvas.height),this._canvas.context.setTransform(devicePixelRatio,0,0,devicePixelRatio,0,0);for(let t=0;t<this.dynamicSprites.length;t++){const e=this.dynamicSprites[t];e.isDestroy?this.dynamicSprites.splice(t,1):(this._camera.isInView(e)||e.y>-200)&&e.draw(this._canvas.context,this._camera)}for(let t=0;t<this.staticSprites.length;t++){const e=this.staticSprites[t];e.isDestroy?(this.staticSprites.splice(t,1),delete this.staticSpriteMaps[`${e.x}-${e.y}`]):this._camera.isInView(e)&&e.draw(this._canvas.context,this._camera)}this._canvas.paint()}getCore(){return this._core}}class T_{constructor(t){const{width:e,height:i,x:s,y:r}=t;this.x=s,this.y=r,this.width=e,this.height=i}isInView(t){const{x:e,y:i,width:s,height:r}=t;return e+s>=this.x&&e<=this.x+this.width&&i+r>=this.y&&i<=this.y+this.height}}const P_=32,L_=.4,O_=6*P_;class M_{constructor(t){S_(this,"isDestroy",!1);const{x:e,y:i,width:s,height:r}=t;this.x=e,this.y=i,this.width=s,this.height=r}destroy(){this.isDestroy=!0}}class D_ extends M_{constructor({x:t,y:e}){super({x:t,y:e,width:P_,height:P_})}draw(t,e){t.drawImage(S[0],this.x-e.x,this.y,this.width,this.height)}}const A_=6;class I_ extends M_{constructor({x:t,y:e}){super({x:t,y:e,width:P_,height:P_}),this.frame=0,this.collectY=null,this.collectStep=0,this.resources={default:[L[0],L[1],L[2],L[3],L[4],L[5]],empty:[L[6]]},this.type="default"}hit(){"empty"!==this.type&&(this.type="empty",this.frame=0,this.collectY=this.y-A_)}draw(t,e){const i=this.resources[this.type][~~this.frame];this.frame=this.frame>=this.resources[this.type].length-1?0:this.frame+.1,this.collectY&&(this.collectY++,this.collectStep++,this.collectStep>A_&&(this.collectStep=0,this.collectY=null)),t.drawImage(i,this.x-e.x,this.collectY||this.y,this.width,this.height)}}class W_{constructor(t){S_(this,"isActive",!1),S_(this,"isDestroy",!1);const{x:e,y:i,vx:s=0,vy:r=0,width:n,height:o}=t;this.x=e,this.y=i,this.vx=s,this.vy=r,this.width=n,this.height=o}active(){this.isActive=!0}unActive(){this.isActive=!1}destroy(){this.unActive(),this.isDestroy=!0}}const j_=6;class F_ extends W_{constructor({x:t,y:e}){super({x:t,y:e,width:P_,height:P_}),this.frame=0,this.collectY=null,this.collectStep=0,this.resources={default:[O[0],O[1],O[2],O[3]]},this.type="default"}appear(){this.isActive||(this.collectY=this.y-j_)}draw(t,e){const i=this.resources[this.type][~~this.frame];this.frame=this.frame>=this.resources[this.type].length-1?0:this.frame+.1,this.collectY&&(this.y=this.collectY,this.collectY--,this.collectStep++,this.collectStep>this.height-j_&&(this.collectStep=0,this.collectY=null,this.active())),t.drawImage(i,this.x-e.x,this.y,this.width,this.height)}}const Y_=6;class N_ extends W_{constructor({x:t,y:e}){super({x:t,y:e,width:P_,height:P_}),this.collectY=null,this.collectStep=0}appear(){this.isActive||(this.collectY=this.y-Y_)}draw(t,e){this.collectY&&(this.y=this.collectY,this.collectY--,this.collectStep++,this.collectStep>this.height-Y_&&(this.collectStep=0,this.collectY=null,this.vx=-1,this.active())),this.x+=this.vx,this.y+=this.vy,t.drawImage(D[0],this.x-e.x,this.y,this.width,this.height)}}class z_ extends W_{constructor({x:t,y:e}){super({x:t,y:e,width:P_,height:P_}),this.frame=0,this.collectY=null,this.collectStep=0,this.vx=-this.width/P_,this.vy=0,this.resources={default:[A[0],A[1]],dieByBullet:[A[2],A[3]],dieByTrample:[A[4]]},this.type="default",this.active()}dieByTrample(){this.unActive(),this.type="dieByTrample",this.vx=0,this.vy=0,this.frame=0,setTimeout((()=>{this.destroy()}),200)}dieByBullet(){this.unActive(),this.type="dieByBullet",this.vx=0,this.vy=0,this.frame=0;const t=()=>{void 0===this.beginX&&(this.beginX=this.x,this.beginY=this.y,this.animatedX=0),this.animatedX+=1,this.animatedY=.2*this.animatedX*this.animatedX-5*this.animatedX,this.x=this.beginX+this.animatedX,this.y=this.beginY+this.animatedY,this.y>this.beginY+300?this.destroy():requestAnimationFrame(t)};t()}draw(t,e){const i=this.resources[this.type][~~this.frame];this.frame=~~(this.frame+.03)>this.resources[this.type].length-1?0:this.frame+.03,this.x+=this.vx,this.y+=this.vy,t.drawImage(i,this.x-e.x,this.y,this.width,this.height)}}const X_=6;class H_ extends M_{constructor({x:t,y:e}){super({x:t,y:e,width:P_,height:P_}),this.collectY=null,this.collectStep=0}hit(){this.collectY=this.y-X_}draw(t,e){this.collectY&&(this.collectY++,this.collectStep++,this.collectStep>X_&&(this.collectStep=0,this.collectY=null)),t.drawImage(T[0],this.x-e.x,this.collectY||this.y,this.width,this.height)}}class V_ extends M_{constructor({x:t,y:e}){super({x:t,y:e,width:P_,height:P_})}draw(t,e){this.height=e.height-P_,t.drawImage(I[0],this.x-e.x-P_/2,this.y,P_,P_),t.drawImage(I[1],this.x-e.x,this.y-P_/2,P_,P_);for(let i=0;i<this.height-P_;i++)t.drawImage(I[2],this.x-e.x,this.y-P_/2+P_*(i+1),P_,P_)}}class U_ extends M_{constructor({x:t,y:e}){super({x:t,y:e,width:P_,height:P_}),this.frame=0}draw(t,e){const i=M[~~this.frame];this.frame=this.frame>=M.length-1?0:this.frame+.1,t.drawImage(i,this.x-e.x,this.y,this.width,this.height)}}class G_ extends M_{constructor({x:t,y:e}){super({x:t,y:e,width:P_,height:P_})}draw(t,e){t.drawImage(E[0],this.x-e.x,this.y,this.width,this.height)}}function K_(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}class $_{constructor(){}serialization(t,e){const i={title:e,data:[]};return t.dynamicSprites.forEach((t=>{i.data.push({type:K_(t.constructor.name),x:t.x,y:t.y})})),t.staticSprites.forEach((t=>{i.data.push({type:K_(t.constructor.name),x:t.x,y:t.y})})),i}deserialization(t){const{data:e}=t,i=[],s=[];return e.forEach((t=>{switch(t.type){case"sprite-land":i.push(new D_({x:t.x,y:t.y}));break;case"sprite-ask":i.push(new I_({x:t.x,y:t.y}));break;case"sprite-stone":i.push(new H_({x:t.x,y:t.y}));break;case"sprite-rock":i.push(new G_({x:t.x,y:t.y}));break;case"sprite-win":i.push(new V_({x:t.x,y:t.y}));break;case"sprite-gold":i.push(new U_({x:t.x,y:t.y}));break;case"sprite-flower":s.push(new F_({x:t.x,y:t.y}));break;case"sprite-grow-mushroom":s.push(new N_({x:t.x,y:t.y}));break;case"sprite-bad-mushroom":s.push(new z_({x:t.x,y:t.y}));break}})),{statics:i,dynamics:s}}import(){}export(){}}class q_{constructor(t){const{camera:e}=t,{width:i,height:s,src:r}=b[0];this._camera=e,this.init({sceneWidth:e.width,sceneHeight:e.height,imageWidth:i,imageHeight:s,imageUrl:r})}init(t){const{sceneWidth:e,sceneHeight:i,imageWidth:s,imageHeight:r,imageUrl:n}=t,o=s/r;this._core=new wh;const a=new mh({x:0,y:0,width:e,height:i}),h=o*i;a.add(new bh({x:0,y:0,width:h,height:i,fill:{type:"image",url:n,mode:"fit"}})),this.breakPoint=h-1,a.add(new bh({x:this.breakPoint,y:0,width:h,height:i,fill:{type:"image",url:n,mode:"fit"}})),this._core.add(a)}getCore(){return this._core}run(){const t=this.getCore().children[0];t.set({x:-this._camera.x<=-this.breakPoint?0:-this._camera.x})}}class Q_{constructor(t){S_(this,"children",[]),S_(this,"totalScore",0);const{camera:e}=t;this._core=new wh;const i=new mh({x:0,y:0,width:e.width,height:e.height});this.totalScoreText=new pl({x:0,y:0,width:e.width-20,text:"分数：0",fill:"rgb(255,255,255)",fontSize:20,fontWeight:"black",textAlign:"right",fontFamily:"ui-monospace, SFMono-Regular, SF Mono, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace"}),i.add(this.totalScoreText),this._core.add(i),this._group=i,this._camera=e}add(t,e,i){let s;i instanceof U_?s=500:i instanceof z_?s=400:i instanceof N_||i instanceof F_?s=2e3:i instanceof H_&&(s=200);const r=new pl({_x:t,_y:e,x:t,y:e,text:s,fill:"rgb(255,255,255)",fontWeight:"black",fontFamily:"ui-monospace, SFMono-Regular, SF Mono, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace"});this._group.add(r),this.children.push(r),this.totalScore+=s,this.totalScoreText.text="分数："+this.totalScore}getCore(){return this._core}run(){for(let t=0;t<this.children.length;t++){const e=this.children[t];e.set({x:e._x-this._camera.x,y:e.y-1}),e._y-e.y>20&&(this.children.splice(t,1),this._group.remove(e),t--)}}}class Z_{constructor(){S_(this,"frame",0),S_(this,"actionType","static"),this.resources={static:[k[0]],jumpLeft:[k[1]],jumpRight:[k[2]],left:[k[3],k[4],k[5]],right:[k[6],k[7],k[8]],die:[k[9]]}}getInfo(t){const{actionType:e}=t;e!==this.actionType&&(this.frame=0),this.actionType=e;const i=this.resources[e][~~this.frame];return this.frame=this.frame>=this.resources[e].length-1?0:this.frame+.1,{resource:i}}}class J_{constructor(){S_(this,"frame",0),S_(this,"actionType","static"),this.resources={static:[C[0]],jumpLeft:[C[1]],jumpRight:[C[2]],left:[C[3],C[4],C[5]],right:[C[6],C[7],C[8]]}}getInfo(t){const{actionType:e}=t;e!==this.actionType&&(this.frame=0),this.actionType=e;const i=this.resources[e][~~this.frame];return this.frame=this.frame>=this.resources[e].length-1?0:this.frame+.1,{resource:i}}}class ty{constructor(){S_(this,"frame",0),S_(this,"actionType","static"),this.resources={static:[B[0]],jumpLeft:[B[1]],jumpRight:[B[2]],left:[B[3],B[4],B[5]],right:[B[6],B[7],B[8]],attackLeft:[B[9]],attackRight:[B[10]]}}getInfo(t){const{actionType:e}=t;e!==this.actionType&&(this.frame=0),this.actionType=e;const i=this.resources[e][~~this.frame];return this.frame=this.frame>=this.resources[e].length-1?0:this.frame+.1,{resource:i}}}class ey extends W_{constructor(t){const{x:e,y:i,vx:s=4,vy:r=4}=t;super({x:e,y:i,width:P_/2,height:P_/2,vx:s,vy:r}),this.frame=0,this.resources=[R[0],R[1],R[2],R[3]],this.active(),this.step=0}draw(t,e){const i=this.resources[~~this.frame];this.frame=this.frame>=this.resources.length-1?0:this.frame+.1,this.x+=this.vx,this.y+=this.vy,this.step+=1,this.step>=60&&this.destroy(),t.drawImage(i,this.x-e.x,this.y,this.width,this.height)}}function iy(t,e,i,s){return s?"die":i?t<0?"attackLeft":"attackRight":0===t&&0===e?i?"attackRight":"static":0!==e&&t>=0?"jumpRight":0!==e&&t<0?"jumpLeft":0===e&&t<0?"left":"right"}class sy extends W_{constructor({x:t,y:e}){super({x:t,y:e,width:P_,height:P_}),this.isAttack=!1,this.isInvincibility=!1,this.invincibilityNum=0,this.isDie=!1,this.isWin=!1,this.growType="base",this.mario=new Z_,this.active()}grow(){"base"===this.growType&&(this.growType="big",this.y-=P_,this.height=2*P_,this.mario=new J_)}bullet(){"base"===this.growType&&(this.y-=P_,this.height=2*P_),this.growType="bullet",this.mario=new ty}attack(){if("bullet"===this.growType)return this.isAttack=!0,new ey({x:this.vx>=0?this.x+this.width:this.x,y:this.y,vx:this.vx>=0?8:-8})}die(){this.isInvincibility||("base"!==this.growType?(this.growType="base",this.mario=new Z_,this.height=P_,this.y+=P_,this.isInvincibility=!0,setTimeout((()=>{this.isInvincibility=!1}),2e3)):(this.isDie=!0,this.unActive(),this.vy=-1,this.vx=0))}win(){this.isWin=!0}unAttack(){this.isAttack=!1}draw(t,e){const{vx:i,vy:s}=this,r=iy(i,s,this.isAttack,this.isDie),{resource:n}=this.mario.getInfo({actionType:r});this.x+=i,this.y+=s,this.isInvincibility&&(Math.sin(this.invincibilityNum)>=1?this.invincibilityNum-=.8:(Math.sin(this.invincibilityNum),this.invincibilityNum+=.8),Math.sin(this.invincibilityNum)>=0)||t.drawImage(n,this.x-e.x,this.y,this.width,this.height)}}class ry{constructor(){S_(this,"xDirection",void 0),S_(this,"yDirection",void 0),S_(this,"pressBlank",!1),S_(this,"handleKeydown",(t=>{switch(t.keyCode){case 38:this.yDirection="top";break;case 37:this.xDirection="left";break;case 39:this.xDirection="right";break;case 32:this.pressBlank=!0;break}})),S_(this,"handleKeyup",(t=>{switch(t.keyCode){case 38:this.yDirection=void 0;break;case 37:case 39:this.xDirection=void 0;break;case 32:this.pressBlank=!1;break}})),document.addEventListener("keydown",this.handleKeydown),document.addEventListener("keyup",this.handleKeyup)}}const ny=(t,e)=>t.vy>0&&t.y+t.height<=e.y&&t.x+t.width!==e.x&&t.x!==e.x+e.width,oy=(t,e)=>t.vy<0&&t.y>=e.y+e.height&&t.x+t.width!==e.x&&t.x!==e.x+e.width,ay=(t,e)=>t.vx>0&&t.x+t.width<=e.x&&t.y+t.height!==e.y&&t.y!==e.y+e.height,hy=(t,e)=>t.vx<0&&t.x>=e.x+e.width&&t.y+t.height!==e.y&&t.y!==e.y+e.height;function ly(t,e){const i=t.x+t.vx,s=t.y+t.vy,r=t.width,n=t.height,o=e.x+(e.vx||0),a=e.y+(e.vy||0),h=e.width,l=e.height,d=i<o+h&&i+r>o&&s<a+l&&s+n>a;return d}function dy(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var cy=dy,uy="object"==typeof global&&global&&global.Object===Object&&global,py=uy,_y="object"==typeof self&&self&&self.Object===Object&&self,yy=py||_y||Function("return this")(),gy=yy,fy=function(){return gy.Date.now()},my=fy,xy=/\s/;function vy(t){var e=t.length;while(e--&&xy.test(t.charAt(e)));return e}var wy=vy,by=/^\s+/;function ky(t){return t?t.slice(0,wy(t)+1).replace(by,""):t}var Cy=ky,By=gy.Symbol,Ry=By,Sy=Object.prototype,Ey=Sy.hasOwnProperty,Ty=Sy.toString,Py=Ry?Ry.toStringTag:void 0;function Ly(t){var e=Ey.call(t,Py),i=t[Py];try{t[Py]=void 0;var s=!0}catch(n){}var r=Ty.call(t);return s&&(e?t[Py]=i:delete t[Py]),r}var Oy=Ly,My=Object.prototype,Dy=My.toString;function Ay(t){return Dy.call(t)}var Iy=Ay,Wy="[object Null]",jy="[object Undefined]",Fy=Ry?Ry.toStringTag:void 0;function Yy(t){return null==t?void 0===t?jy:Wy:Fy&&Fy in Object(t)?Oy(t):Iy(t)}var Ny=Yy;function zy(t){return null!=t&&"object"==typeof t}var Xy=zy,Hy="[object Symbol]";function Vy(t){return"symbol"==typeof t||Xy(t)&&Ny(t)==Hy}var Uy=Vy,Gy=NaN,Ky=/^[-+]0x[0-9a-f]+$/i,$y=/^0b[01]+$/i,qy=/^0o[0-7]+$/i,Qy=parseInt;function Zy(t){if("number"==typeof t)return t;if(Uy(t))return Gy;if(cy(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=cy(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Cy(t);var i=$y.test(t);return i||qy.test(t)?Qy(t.slice(2),i?2:8):Ky.test(t)?Gy:+t}var Jy=Zy,tg="Expected a function",eg=Math.max,ig=Math.min;function sg(t,e,i){var s,r,n,o,a,h,l=0,d=!1,c=!1,u=!0;if("function"!=typeof t)throw new TypeError(tg);function p(e){var i=s,n=r;return s=r=void 0,l=e,o=t.apply(n,i),o}function _(t){return l=t,a=setTimeout(f,e),d?p(t):o}function y(t){var i=t-h,s=t-l,r=e-i;return c?ig(r,n-s):r}function g(t){var i=t-h,s=t-l;return void 0===h||i>=e||i<0||c&&s>=n}function f(){var t=my();if(g(t))return m(t);a=setTimeout(f,y(t))}function m(t){return a=void 0,u&&s?p(t):(s=r=void 0,o)}function x(){void 0!==a&&clearTimeout(a),l=0,s=h=r=a=void 0}function v(){return void 0===a?o:m(my())}function w(){var t=my(),i=g(t);if(s=arguments,r=this,h=t,i){if(void 0===a)return _(h);if(c)return clearTimeout(a),a=setTimeout(f,e),p(h)}return void 0===a&&(a=setTimeout(f,e)),o}return e=Jy(e)||0,cy(i)&&(d=!!i.leading,c="maxWait"in i,n=c?eg(Jy(i.maxWait)||0,e):n,u="trailing"in i?!!i.trailing:u),w.cancel=x,w.flush=v,w}var rg=sg,ng="Expected a function";function og(t,e,i){var s=!0,r=!0;if("function"!=typeof t)throw new TypeError(ng);return cy(i)&&(s="leading"in i?!!i.leading:s,r="trailing"in i?!!i.trailing:r),rg(t,e,{leading:s,maxWait:e,trailing:r})}var ag=og;class hg{constructor({G:t}){S_(this,"jumping",[]),this.G=t}getJumpSprite(t){return this.jumping.find((e=>e.sprite===t))}add(t,e=9){const i=this.getJumpSprite(t);if(i)return void(i.a>.5*this.G&&(i.a-=.015));const s={v0:e,a:this.G,jumping:!0,sprite:t};this.jumping.push(s)}remove(t){for(let e=0;e<this.jumping.length;e++)if(this.jumping[e].sprite===t){this.jumping.splice(e,1);break}}}class lg extends M_{constructor(t){const e=P_/2,i=P_/2;let s,r;0===t.index?(s=t.x,r=t.y):1===t.index?(s=t.x+e,r=t.y):2===t.index?(s=t.x,r=t.y+i):(s=t.x+e,r=t.y+i),super({x:s,y:r,width:e,height:i}),this.index=t.index,this.animatedX=0,this.animatedY=0,this.beginX=s,this.beginY=r}draw(t,e){if(0===this.index||2===this.index){const i=0===this.index?5:3;this.animatedX+=2,this.animatedY=.1*this.animatedX*this.animatedX-i*this.animatedX,t.drawImage(P[0],this.beginX-this.animatedX-e.x,this.beginY+this.animatedY,this.width,this.height)}if(1===this.index||3===this.index){const i=1===this.index?5:3;this.animatedX+=2,this.animatedY=.1*this.animatedX*this.animatedX-i*this.animatedX,t.drawImage(P[0],this.beginX+this.animatedX-e.x,this.beginY+this.animatedY,this.width,this.height)}}}const dg=ag(((t,e)=>{const i=e.attack();i&&t.addDynamicSprites(i)}),200);class cg{constructor(){this.keyboard=new ry,this.jumping=new hg({G:L_})}run(t){const{scene:e,camera:i,onScore:s}=t;this.onScore=s;const{staticSpriteMaps:r,dynamicSprites:n}=e;for(let o=0;o<n.length;o++){const t=n[o];if(!i.isInView({x:t.x,y:t.y,width:t.width,height:t.height})&&t.y<-200){t instanceof ey&&t.destroy();continue}if(!t.isActive||t.isDestroy)continue;t instanceof sy&&(this.handleKeyBoardControlMario(t,e),t.y+t.height>=i.y+i.height&&(t.isDie=!0));const s=this.jumping.getJumpSprite(t);s&&!s.jumping&&0===s.sprite.vy?this.jumping.remove(t):s&&s.jumping?(s.v0-=s.a,s.sprite.vy=Math.min(1,-s.v0),1===s.sprite.vy&&(s.jumping=!1)):t instanceof ey||(t.vy=Math.min(10,t.vy+L_));for(let e=0;e<n.length;e++){const s=n[e];i.isInView({x:s.x,y:s.y,width:s.width,height:s.height})&&s!==t&&!s.isDestroy&&(ly(t,s)&&this.handleDySpriteCollectDySprite(t,s))}const a=(~~(t.x/P_)-1)*P_,h=0,l=(Math.ceil(t.width/P_)+2)*P_,d=i.height,c=[],u=[],p=[],_=[];for(let i=0;i<l+1;i+=P_)for(let s=0;s<d+1;s+=P_){const n=r[`${a+i}-${h+s}`];if(n&&!n.isDestroy&&ly(t,n)){if(t instanceof sy&&n instanceof V_)return void t.win();if(n instanceof U_){t instanceof sy&&(n.destroy(),this.onScore(n.x,n.y,n));continue}if(oy(t,n))if(c.push(n),n instanceof H_&&t instanceof sy&&"base"!==t.growType){n.destroy(),this.onScore(n.x,n.y,n);for(let t=0;t<4;t++)e.addDynamicSprites(new lg({x:n.x,y:n.y,index:t}))}else t instanceof sy&&(n instanceof I_||n instanceof H_)&&n.hit();ny(t,n)&&u.push(n),hy(t,n)&&_.push(n),ay(t,n)&&p.push(n)}}c.length&&this.handleDySpriteCollectStSpriteBottom(t,c[0],s),u.length&&this.handleDySpriteCollectStSpriteTop(t,u[0]),_.length&&this.handleDySpriteCollectStSpriteRight(t,_[0]),p.length&&this.handleDySpriteCollectStSpriteLeft(t,p[0])}}handleDySpriteCollectDySprite(t,e){t instanceof sy&&(e instanceof F_||e instanceof N_?this.handleGetProps(t,e):e instanceof z_&&e.isActive&&(ny(t,e)?(this.jumping.remove(t),this.jumping.add(t,4),e.dieByTrample(),this.onScore(e.x,e.y,e)):t.die())),t instanceof ey&&e instanceof z_&&e.isActive&&(t.destroy(),e.dieByBullet(),this.onScore(e.x,e.y,e))}handleGetProps(t,e){e.isActive?(e.destroy(),this.onScore(e.x,e.y,e),e instanceof N_?t.grow():e instanceof F_&&t.bullet()):!e.isActive&&oy(t,e)&&e.appear()}handleDySpriteCollectStSpriteBottom(t,e,i){t.y=e.y+e.height,t instanceof ey?t.vy=-t.vy:i&&i.jumping&&(i.jumping=!1,requestAnimationFrame((()=>{t.vy=1})))}handleDySpriteCollectStSpriteTop(t,e){t.y=e.y-t.height,t.vy=t instanceof ey?-t.vy:0}handleDySpriteCollectStSpriteLeft(t,e){t.x=e.x-t.width,t.vx=t instanceof N_||t instanceof z_||t instanceof ey?-t.vx:0}handleDySpriteCollectStSpriteRight(t,e){t.x=e.x+e.width,t.vx=t instanceof N_||t instanceof z_||t instanceof ey?-t.vx:0}handleKeyBoardControlMario(t,e){"left"===this.keyboard.xDirection?(t.vx=Math.max(-4,t.vx-.15),t.vx+t.x<0&&(t.x=0)):"right"===this.keyboard.xDirection?t.vx=Math.min(4,t.vx+.15):t.vx=0,"top"===this.keyboard.yDirection&&this.jumping.add(t),this.keyboard.pressBlank?dg(e,t):t.unAttack()}}class ug{constructor(t){const{view:e,mapData:i,readonly:s}=t;j.image.crossOrigin=null;const r=new ml({view:e}),n=new T_({x:0,y:0,width:e.offsetWidth,height:e.offsetHeight}),o=new q_({camera:n}),a=new Q_({camera:n}),h=new E_({camera:n}),l=new sy({x:0,y:0});r.add(o.getCore());const d=new $_;if(i){const t=d.deserialization(i);t.dynamics.forEach((t=>{s&&(t.vx=0,t.vy=0),h.addDynamicSprites(t)})),t.statics.forEach((t=>{h.addStaticSprites(t)}))}!s&&h.addDynamicSprites(l),r.add(h.getCore()),!s&&r.add(a.getCore()),this._app=r,this.scene=h,this._background=o,this._score=a,this.camera=n,this._mario=l,this.readonly=s,this._physicsEngine=new cg}run(t,e){if(!this.isDestroy){if(!this.readonly&&this._mario.isDie)return t(this._score.totalScore),!1;if(!this.readonly&&this._mario.isWin)return e(this._score.totalScore),!1;!this.readonly&&this._physicsEngine.run({camera:this.camera,scene:this.scene,onScore:(...t)=>{this._score.add(...t)}}),this.scene.run(),this._background.run(),!this.readonly&&this._score.run(),this.readonly||(this.camera.x=this._mario.x<O_?0:this._mario.x-O_),requestAnimationFrame(this.run.bind(this,t,e))}}destroy(){this.isDestroy=!0,this._app.destroy()}}const pg=(0,s.eW)(" 请选择要添加的元素 "),_g=["onClick"],yg=["src"],gg=["onClick"],fg=["src"];var mg={emits:["check","mul-check","finish"],setup(t,{emit:e}){const i=[{imgs:["imgs/building/land/land.jpg"],handler(t,e,i){t.addStaticSprites(new D_({x:e,y:i}))}},{imgs:["imgs/building/ask/frame-4.jpg","imgs/props/grow-mushroom/frame-1.jpg"],handler(t,e,i){t.addStaticSprites(new I_({x:e,y:i})),t.addDynamicSprites(new N_({x:e,y:i}))}},{imgs:["imgs/building/ask/frame-4.jpg","imgs/props/flow/frame-1.jpg"],handler(t,e,i){t.addStaticSprites(new I_({x:e,y:i})),t.addDynamicSprites(new F_({x:e,y:i}))}},{imgs:["imgs/building/stone/stone.jpg"],handler(t,e,i){t.addStaticSprites(new H_({x:e,y:i}))}},{imgs:["imgs/building/rock/rock.jpg"],handler(t,e,i){t.addStaticSprites(new G_({x:e,y:i}))}},{imgs:["imgs/bad/mushroom/frame-1.jpg"],handler(t,e,i){const s=new z_({x:e,y:i});s.vx=0,t.addDynamicSprites(s)}}];return(0,s.sV)((()=>{e("check",i[0])})),(t,n)=>((0,s.uX)(),(0,s.CE)("div",null,[(0,s.Lk)("div",{class:(0,r.C4)(t.$style.Title)},[pg,(0,s.Lk)("button",{onClick:n[0]||(n[0]=t=>e("finish"))},"编辑完成，生成地图")],2),(0,s.Lk)("div",{class:(0,r.C4)(t.$style.List)},[((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)(i,((i,n)=>(0,s.Lk)("div",{key:n,onClick:t=>e("check",i)},[(0,s.Lk)("div",{class:(0,r.C4)(t.$style.Item)},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.imgs,(t=>((0,s.uX)(),(0,s.CE)("img",{src:t,key:t},null,8,yg)))),128))],2)],8,_g))),64))],2),(0,s.Lk)("div",{class:(0,r.C4)(t.$style.List)},[((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)(i,((i,n)=>(0,s.Lk)("div",{key:n,onClick:t=>e("mul-check",i)},[(0,s.Lk)("div",{class:(0,r.C4)(t.$style.Item)},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.imgs,(t=>((0,s.uX)(),(0,s.CE)("img",{src:t,key:t},null,8,fg)))),128)),(0,s.Lk)("div",{class:(0,r.C4)(t.$style.Text)},"多",2)],2)],8,gg))),64))],2)]))}},xg={Title:"add-sprite_Title_h1r1X",List:"add-sprite_List_l9Lg2",Item:"add-sprite_Item_nQEMD",Text:"add-sprite_Text_M4h8W"},vg=i(727);const wg={};wg["$style"]=xg;const bg=(0,vg.A)(mg,[["__cssModules",wg]]);var kg=bg;const Cg=(0,s.eW)(" 总得分："),Bg=(0,s.eW)(" 历史最高："),Rg=["onClick","onMouseenter"];var Sg={props:{isEdit:{type:Boolean,default:!1},mapData:{type:Object,default:null}},emits:["add-map"],setup(t,{emit:e}){const i=t,o=new $_,a=672,h=480,l=(0,n.KR)(),d=(0,n.KR)(!1),c=(0,n.KR)(!1),u=(0,n.KR)(0),p=(0,n.KR)(0),_=(0,n.KR)(),y=(0,n.KR)(),g=(0,n.KR)(),f=(0,n.KR)(!1),m=(0,n.EW)((()=>{const t=[];for(let e=0;e<h;e+=P_)for(let i=0;i<a;i+=P_)t.push({x:i,y:e});return t}));function x(){R.camera.x=Math.max(0,R.camera.x-5*P_)}function v(){R.camera.x+=5*P_}function w({x:t,y:e}){if((f.value&&f.value.x===t&&f.value.y)===e)return"rgba(0, 0, 0, 0.5)";if(f.value&&y.value){const i=Math.min(f.value.x,y.value.x),s=Math.min(f.value.y,y.value.y),r=Math.max(f.value.x,y.value.x),n=Math.max(f.value.y,y.value.y);if(t>=i&&t<=r&&e>=s&&e<=n)return"rgba(0, 0, 0, 0.5)"}}function b(){const t=o.serialization(R.scene);let i=0;t.data.forEach((t=>{i=Math.max(t.x,i)})),t.data.push({x:i,y:2*P_,type:"sprite-win"}),document.body.style.cursor=null,e("add-map",t)}function k(t){g.value=void 0,f.value=!1,_.value=t.handler,document.body.style.cursor=`url(${t.imgs[0]}), pointer`}function C(t){g.value=t,_.value=void 0,document.body.style.cursor=`url(${t.imgs[0]}), pointer`}function B(t){const{x:e,y:i}=t;if(_.value&&_.value(R.scene,R.camera.x+e,i),g.value)if(f.value){const t=Math.min(f.value.x,e),s=Math.min(f.value.y,i),r=Math.max(f.value.x,e),n=Math.max(f.value.y,i);for(let e=t;e<=r;e+=P_)for(let t=s;t<=n;t+=P_)g.value.handler(R.scene,R.camera.x+e,t);f.value=void 0}else f.value={x:e,y:i}}let R;function S(){d.value=!1,c.value=!1,R&&R.destroy(),R=new ug({view:l.value,readonly:i.isEdit,mapData:i.mapData}),R.run((t=>{d.value=!0,c.value=!1,p.value=t,u.value=Math.max(t,u.value)}),(t=>{d.value=!1,c.value=!0,p.value=t,u.value=Math.max(t,u.value)}))}return(0,s.sV)((()=>{S()})),(0,s.hi)((()=>{R&&R.destroy(),document.body.style.cursor=null})),(t,e)=>((0,s.uX)(),(0,s.CE)("div",null,[(0,s.Lk)("div",{class:(0,r.C4)(t.$style.Container),style:(0,r.Tr)({width:a+"px",height:h+"px"})},[i.isEdit?((0,s.uX)(),(0,s.CE)("div",{key:0,class:(0,r.C4)(t.$style.MoveLeft),onClick:x}," ‹ ",2)):(0,s.Q3)("",!0),(0,s.Lk)("div",{ref:(t,e)=>{e["viewRef"]=t,l.value=t},style:{width:"100%",height:"100%"}},null,512),d.value||c.value?((0,s.uX)(),(0,s.CE)("div",{key:1,class:(0,r.C4)(t.$style.End)},[(0,s.Lk)("div",null,[(0,s.Lk)("div",null,[(0,s.Lk)("div",{class:(0,r.C4)(t.$style.EndTitle)},(0,r.v_)(c.value?"恭喜您过关啦!":"游戏结束"),3),(0,s.Lk)("div",{class:(0,r.C4)(t.$style.Score)},[Cg,(0,s.Lk)("b",null,(0,r.v_)(p.value),1)],2),(0,s.Lk)("div",{class:(0,r.C4)(t.$style.Score)},[Bg,(0,s.Lk)("b",null,(0,r.v_)(u.value),1)],2)]),(0,s.Lk)("button",{style:{"margin-top":"20px"},onClick:S}," 再玩一次 ")])],2)):(0,s.Q3)("",!0),i.isEdit?((0,s.uX)(),(0,s.CE)("div",{key:2,class:(0,r.C4)(t.$style.GridEditor)},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,n.R1)(m),((t,e)=>((0,s.uX)(),(0,s.CE)("div",{key:e,style:(0,r.Tr)({width:(0,n.R1)(P_)+"px",height:(0,n.R1)(P_)+"px",background:w(t)}),onClick:e=>B(t),onMouseenter:e=>y.value=t},null,44,Rg)))),128))],2)):(0,s.Q3)("",!0),i.isEdit?((0,s.uX)(),(0,s.CE)("div",{key:3,class:(0,r.C4)(t.$style.MoveRight),onClick:v}," › ",2)):(0,s.Q3)("",!0)],6),i.isEdit?((0,s.uX)(),(0,s.Wv)(kg,{key:0,onCheck:k,onMulCheck:C,onFinish:b})):(0,s.Q3)("",!0)]))}},Eg={Container:"mario_Container_TbvVA",MoveLeft:"mario_MoveLeft_OPvUy",MoveRight:"mario_MoveRight_qZQ8f",End:"mario_End_nUh95",GridEditor:"mario_GridEditor_Te7PO",EndTitle:"mario_EndTitle_gFNNq",Score:"mario_Score_xOzyJ"};const Tg={};Tg["$style"]=Eg;const Pg=(0,vg.A)(Sg,[["__cssModules",Tg]]);var Lg=Pg;const Og=(0,s.eW)(" 自定义地图 "),Mg=["onClick"];var Dg={props:{active:{type:String,required:!0},maps:{type:Array,required:!0}},setup(t){const e=t;return(t,i)=>((0,s.uX)(),(0,s.CE)("div",{class:(0,r.C4)(t.$style.Container)},[(0,s.Lk)("div",{class:(0,r.C4)([t.$style.Item,""===e.active?t.$style.ItemActive:null]),onClick:i[0]||(i[0]=e=>t.$emit("add"))},[(0,s.Lk)("div",{class:(0,r.C4)(t.$style.Add)},"+",2),Og],2),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.maps,((i,n)=>((0,s.uX)(),(0,s.CE)("div",{class:(0,r.C4)([t.$style.Item,i.title===e.active?t.$style.ItemActive:null]),key:n,onClick:e=>t.$emit("check",i.title)},(0,r.v_)(i.title),11,Mg)))),128))],2))}},Ag={Container:"menu_Container_K1VA8",Item:"menu_Item_nOPQ7",ItemActive:"menu_ItemActive_pVQHY",Add:"menu_Add_zt1uR"};const Ig={};Ig["$style"]=Ag;const Wg=(0,vg.A)(Dg,[["__cssModules",Ig]]);var jg=Wg;const Fg={data:[{type:"sprite-grow-mushroom",x:288,y:288},{type:"sprite-bad-mushroom",x:800,y:352},{type:"sprite-bad-mushroom",x:832,y:352},{type:"sprite-bad-mushroom",x:864,y:352},{type:"sprite-bad-mushroom",x:1408,y:352},{type:"sprite-bad-mushroom",x:1248,y:352},{type:"sprite-flower",x:1600,y:288},{type:"sprite-bad-mushroom",x:2272,y:96},{type:"sprite-bad-mushroom",x:2272,y:128},{type:"sprite-bad-mushroom",x:2272,y:160},{type:"sprite-bad-mushroom",x:2304,y:96},{type:"sprite-bad-mushroom",x:2304,y:128},{type:"sprite-bad-mushroom",x:2304,y:160},{type:"sprite-bad-mushroom",x:2336,y:96},{type:"sprite-bad-mushroom",x:2336,y:128},{type:"sprite-bad-mushroom",x:2336,y:160},{type:"sprite-land",x:0,y:416},{type:"sprite-land",x:0,y:448},{type:"sprite-land",x:32,y:416},{type:"sprite-land",x:32,y:448},{type:"sprite-land",x:64,y:416},{type:"sprite-land",x:64,y:448},{type:"sprite-land",x:96,y:416},{type:"sprite-land",x:96,y:448},{type:"sprite-land",x:128,y:416},{type:"sprite-land",x:128,y:448},{type:"sprite-land",x:160,y:416},{type:"sprite-land",x:160,y:448},{type:"sprite-land",x:192,y:416},{type:"sprite-land",x:192,y:448},{type:"sprite-land",x:224,y:416},{type:"sprite-land",x:224,y:448},{type:"sprite-land",x:256,y:416},{type:"sprite-land",x:256,y:448},{type:"sprite-land",x:288,y:416},{type:"sprite-land",x:288,y:448},{type:"sprite-land",x:320,y:416},{type:"sprite-land",x:320,y:448},{type:"sprite-land",x:352,y:416},{type:"sprite-land",x:352,y:448},{type:"sprite-land",x:384,y:416},{type:"sprite-land",x:384,y:448},{type:"sprite-land",x:416,y:416},{type:"sprite-land",x:416,y:448},{type:"sprite-land",x:448,y:416},{type:"sprite-land",x:448,y:448},{type:"sprite-stone",x:192,y:288},{type:"sprite-stone",x:224,y:288},{type:"sprite-stone",x:256,y:288},{type:"sprite-ask",x:288,y:288},{type:"sprite-stone",x:320,y:288},{type:"sprite-stone",x:352,y:288},{type:"sprite-land",x:576,y:416},{type:"sprite-land",x:576,y:448},{type:"sprite-land",x:608,y:416},{type:"sprite-land",x:608,y:448},{type:"sprite-land",x:640,y:416},{type:"sprite-land",x:640,y:448},{type:"sprite-land",x:672,y:416},{type:"sprite-land",x:672,y:448},{type:"sprite-land",x:704,y:416},{type:"sprite-land",x:704,y:448},{type:"sprite-land",x:736,y:416},{type:"sprite-land",x:736,y:448},{type:"sprite-land",x:768,y:416},{type:"sprite-land",x:768,y:448},{type:"sprite-land",x:800,y:416},{type:"sprite-land",x:800,y:448},{type:"sprite-land",x:832,y:416},{type:"sprite-land",x:832,y:448},{type:"sprite-land",x:864,y:416},{type:"sprite-land",x:864,y:448},{type:"sprite-land",x:896,y:416},{type:"sprite-land",x:896,y:448},{type:"sprite-land",x:928,y:416},{type:"sprite-land",x:928,y:448},{type:"sprite-land",x:960,y:416},{type:"sprite-land",x:960,y:448},{type:"sprite-land",x:992,y:416},{type:"sprite-land",x:992,y:448},{type:"sprite-rock",x:736,y:320},{type:"sprite-rock",x:736,y:352},{type:"sprite-rock",x:736,y:384},{type:"sprite-rock",x:928,y:320},{type:"sprite-rock",x:928,y:352},{type:"sprite-rock",x:928,y:384},{type:"sprite-stone",x:672,y:288},{type:"sprite-stone",x:768,y:256},{type:"sprite-stone",x:832,y:224},{type:"sprite-stone",x:864,y:256},{type:"sprite-stone",x:896,y:224},{type:"sprite-stone",x:1056,y:416},{type:"sprite-stone",x:1088,y:416},{type:"sprite-stone",x:1184,y:416},{type:"sprite-stone",x:1216,y:416},{type:"sprite-stone",x:1248,y:416},{type:"sprite-stone",x:1312,y:416},{type:"sprite-stone",x:1344,y:416},{type:"sprite-stone",x:1376,y:416},{type:"sprite-stone",x:1408,y:416},{type:"sprite-land",x:1472,y:416},{type:"sprite-land",x:1472,y:448},{type:"sprite-land",x:1504,y:416},{type:"sprite-land",x:1504,y:448},{type:"sprite-land",x:1536,y:416},{type:"sprite-land",x:1536,y:448},{type:"sprite-land",x:1568,y:416},{type:"sprite-land",x:1568,y:448},{type:"sprite-land",x:1600,y:416},{type:"sprite-land",x:1600,y:448},{type:"sprite-land",x:1632,y:416},{type:"sprite-land",x:1632,y:448},{type:"sprite-land",x:1664,y:416},{type:"sprite-land",x:1664,y:448},{type:"sprite-land",x:1696,y:416},{type:"sprite-land",x:1696,y:448},{type:"sprite-ask",x:1600,y:288},{type:"sprite-stone",x:1568,y:288},{type:"sprite-stone",x:1632,y:288},{type:"sprite-land",x:1792,y:352},{type:"sprite-land",x:1856,y:288},{type:"sprite-land",x:1920,y:224},{type:"sprite-land",x:1952,y:224},{type:"sprite-land",x:2016,y:160},{type:"sprite-land",x:2048,y:160},{type:"sprite-rock",x:2144,y:192},{type:"sprite-rock",x:2144,y:224},{type:"sprite-rock",x:2176,y:192},{type:"sprite-rock",x:2176,y:224},{type:"sprite-rock",x:2208,y:192},{type:"sprite-rock",x:2208,y:224},{type:"sprite-rock",x:2240,y:192},{type:"sprite-rock",x:2240,y:224},{type:"sprite-rock",x:2272,y:192},{type:"sprite-rock",x:2272,y:224},{type:"sprite-rock",x:2304,y:192},{type:"sprite-rock",x:2304,y:224},{type:"sprite-rock",x:2336,y:192},{type:"sprite-rock",x:2336,y:224},{type:"sprite-rock",x:2368,y:192},{type:"sprite-rock",x:2368,y:224},{type:"sprite-rock",x:2400,y:192},{type:"sprite-rock",x:2400,y:224},{type:"sprite-land",x:2400,y:96},{type:"sprite-land",x:2400,y:128},{type:"sprite-land",x:2400,y:160},{type:"sprite-land",x:2464,y:416},{type:"sprite-land",x:2464,y:448},{type:"sprite-land",x:2528,y:416},{type:"sprite-land",x:2528,y:448},{type:"sprite-land",x:2560,y:416},{type:"sprite-land",x:2560,y:448},{type:"sprite-land",x:2624,y:416},{type:"sprite-land",x:2624,y:448},{type:"sprite-land",x:2656,y:416},{type:"sprite-land",x:2656,y:448},{type:"sprite-land",x:2688,y:416},{type:"sprite-land",x:2688,y:448},{type:"sprite-land",x:2752,y:416},{type:"sprite-land",x:2752,y:448},{type:"sprite-land",x:2784,y:416},{type:"sprite-land",x:2784,y:448},{type:"sprite-land",x:2816,y:416},{type:"sprite-land",x:2816,y:448},{type:"sprite-land",x:2848,y:416},{type:"sprite-land",x:2848,y:448},{type:"sprite-land",x:2912,y:416},{type:"sprite-land",x:2912,y:448},{type:"sprite-land",x:2944,y:416},{type:"sprite-land",x:2944,y:448},{type:"sprite-land",x:2976,y:416},{type:"sprite-land",x:2976,y:448},{type:"sprite-land",x:3008,y:416},{type:"sprite-land",x:3008,y:448},{type:"sprite-land",x:3040,y:416},{type:"sprite-land",x:3040,y:448},{type:"sprite-land",x:3072,y:416},{type:"sprite-land",x:3072,y:448},{type:"sprite-land",x:3104,y:416},{type:"sprite-land",x:3104,y:448},{type:"sprite-land",x:3136,y:416},{type:"sprite-land",x:3136,y:448},{type:"sprite-land",x:3168,y:416},{type:"sprite-land",x:3168,y:448},{type:"sprite-land",x:3200,y:416},{type:"sprite-land",x:3200,y:448},{type:"sprite-land",x:3232,y:416},{type:"sprite-land",x:3232,y:448},{type:"sprite-land",x:3264,y:416},{type:"sprite-land",x:3264,y:448},{type:"sprite-land",x:3296,y:416},{type:"sprite-land",x:3296,y:448},{type:"sprite-land",x:3328,y:416},{type:"sprite-land",x:3328,y:448},{type:"sprite-rock",x:3008,y:384},{type:"sprite-rock",x:3040,y:352},{type:"sprite-rock",x:3040,y:384},{type:"sprite-rock",x:3072,y:320},{type:"sprite-rock",x:3072,y:352},{type:"sprite-rock",x:3072,y:384},{type:"sprite-rock",x:3104,y:288},{type:"sprite-rock",x:3104,y:320},{type:"sprite-rock",x:3104,y:352},{type:"sprite-rock",x:3136,y:256},{type:"sprite-rock",x:3136,y:288},{type:"sprite-rock",x:3136,y:320},{type:"sprite-rock",x:3136,y:352},{type:"sprite-rock",x:3136,y:384},{type:"sprite-rock",x:3168,y:224},{type:"sprite-rock",x:3168,y:256},{type:"sprite-rock",x:3168,y:288},{type:"sprite-rock",x:3168,y:320},{type:"sprite-rock",x:3168,y:352},{type:"sprite-rock",x:3168,y:384},{type:"sprite-rock",x:3200,y:192},{type:"sprite-rock",x:3200,y:224},{type:"sprite-rock",x:3200,y:256},{type:"sprite-rock",x:3200,y:288},{type:"sprite-rock",x:3200,y:320},{type:"sprite-rock",x:3200,y:352},{type:"sprite-rock",x:3200,y:384},{type:"sprite-rock",x:3232,y:160},{type:"sprite-rock",x:3232,y:192},{type:"sprite-rock",x:3232,y:224},{type:"sprite-rock",x:3232,y:256},{type:"sprite-rock",x:3232,y:288},{type:"sprite-rock",x:3232,y:320},{type:"sprite-rock",x:3232,y:352},{type:"sprite-rock",x:3232,y:384},{type:"sprite-rock",x:3264,y:128},{type:"sprite-rock",x:3264,y:160},{type:"sprite-rock",x:3264,y:192},{type:"sprite-rock",x:3264,y:224},{type:"sprite-rock",x:3264,y:256},{type:"sprite-rock",x:3264,y:288},{type:"sprite-rock",x:3264,y:320},{type:"sprite-rock",x:3264,y:352},{type:"sprite-rock",x:3264,y:384},{type:"sprite-rock",x:3296,y:96},{type:"sprite-rock",x:3296,y:128},{type:"sprite-rock",x:3296,y:160},{type:"sprite-rock",x:3296,y:192},{type:"sprite-rock",x:3296,y:224},{type:"sprite-rock",x:3296,y:256},{type:"sprite-rock",x:3296,y:288},{type:"sprite-rock",x:3296,y:320},{type:"sprite-rock",x:3296,y:352},{type:"sprite-rock",x:3296,y:384},{type:"sprite-rock",x:3104,y:384},{type:"sprite-land",x:3360,y:416},{type:"sprite-land",x:3360,y:448},{type:"sprite-land",x:3392,y:416},{type:"sprite-land",x:3392,y:448},{type:"sprite-land",x:3424,y:416},{type:"sprite-land",x:3424,y:448},{type:"sprite-land",x:3456,y:416},{type:"sprite-land",x:3456,y:448},{type:"sprite-land",x:3488,y:416},{type:"sprite-land",x:3488,y:448},{type:"sprite-land",x:3520,y:416},{type:"sprite-land",x:3520,y:448},{type:"sprite-land",x:3552,y:416},{type:"sprite-land",x:3552,y:448},{type:"sprite-land",x:3584,y:416},{type:"sprite-land",x:3584,y:448},{type:"sprite-land",x:3616,y:416},{type:"sprite-land",x:3616,y:448},{type:"sprite-win",x:3616,y:32}]},Yg=(0,s.Lk)("a",{href:"https://github.com/hhzzcc"},"Github",-1),Ng=[Yg],zg={key:1};var Xg={setup(t){const e=(0,n.KR)(!0),i=(0,n.KR)(!0),o=[{title:"官方地图 - 第一关",mapData:Fg}],a=(0,n.KR)(o[0].title);function h(t){const e="新地图-"+o.length;o.push({title:e,mapData:t}),a.value=e}const l=(0,n.EW)((()=>!a.value));return(0,s.sV)((async()=>{await W(),e.value=!1})),(t,d)=>((0,s.uX)(),(0,s.CE)("div",{class:(0,r.C4)(t.$style.Container)},[(0,s.Lk)("div",{class:(0,r.C4)(t.$style.MenuContainer)},[(0,s.bF)(jg,{class:(0,r.C4)(t.$style.Menu),style:(0,r.Tr)({width:i.value?"240px":"0"}),active:a.value,maps:o,onCheck:d[0]||(d[0]=t=>a.value=t),onAdd:d[1]||(d[1]=()=>a.value="")},null,8,["class","style","active"]),(0,s.Lk)("div",{onClick:d[2]||(d[2]=t=>i.value=!i.value),class:(0,r.C4)(t.$style.Btn)},[(0,s.Lk)("div",null,(0,r.v_)(i.value?"‹":"›"),1)],2)],2),(0,s.Lk)("div",{class:(0,r.C4)(t.$style.Content)},[(0,s.Lk)("div",{class:(0,r.C4)(t.$style.Header)},Ng,2),(0,s.Lk)("div",{class:(0,r.C4)(t.$style.Game)},[e.value?((0,s.uX)(),(0,s.CE)("div",{key:0,class:(0,r.C4)(t.$style.Loading)},"资源加载中...",2)):((0,s.uX)(),(0,s.CE)("div",zg,[(0,n.R1)(l)?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",{key:0,class:(0,r.C4)(t.$style.Tip)}," 方向键控制人物，空格发射子弹 ",2)),(0,s.bF)(Lg,{isEdit:(0,n.R1)(l),mapData:(0,n.R1)(l)?null:o.find((t=>t.title===a.value)).mapData,key:a.value,onAddMap:h},null,8,["isEdit","mapData"])]))],2)],2)],2))}},Hg={Container:"Home_Container_TvPjS",MenuContainer:"Home_MenuContainer_Jpi4d",Menu:"Home_Menu_RXuZa",Btn:"Home_Btn_oOsOI",Content:"Home_Content_JBjb0",Header:"Home_Header_YYyV4",Game:"Home_Game_OzZ_G",Loading:"Home_Loading_rTSCN",Tip:"Home_Tip_rMaU0"};const Vg={};Vg["$style"]=Hg;const Ug=(0,vg.A)(Xg,[["__cssModules",Vg]]);var Gg=Ug}}]);
//# sourceMappingURL=Home.f2a16f52.js.map